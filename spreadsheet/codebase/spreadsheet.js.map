{"version":3,"file":"spreadsheet.js","sources":["../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../node_modules/@xbs/muon/dist/muon.js","../sources/mathematics/methods.js","../sources/views/date.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/helpers/array.js","../sources/operations/formats.js","../sources/mathematics/parser.js","../sources/operations/types.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/operations/data.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/views/series.js","../sources/views/bar.js","../sources/sheets.js","../sources/operations/resize.js","../sources/operations/zoom.js","../sources/views/zoom.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/helpers/conditional.js","../sources/operations/conditional_formats.js","../sources/operations/show_cells.js","../sources/table.js","../sources/hotkeys.js","../sources/editor.js","../sources/dialogs/common.js","../sources/mathematics/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/operations/undo.js","../sources/operations/views.js","../sources/chart.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/mathematics/ranges.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/operations/print.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/add_row_col.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/hide_row_col.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/mathematics/sheets.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/show_formulas.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/api/show_formulas.js","../sources/api/print.js","../sources/api/zoom.js","../sources/menu.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"currency-symbol\":\"Ð¡urrency\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"conditional-common\": \"Common\",\n\t\t\"conditional-text\": \"Text\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t\"range-scope\": \"Scope\",\n\t\t\"range-global\": \"Book\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-empty-option\": \"Empty option\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t\"error-link\": \"The link is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"sheets\":\"Sheets:\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t\"external-ui\":\"External UI\",\n\t\t\"print-borders\": \"Show print borders\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t\"default-size\":\"Reset to default\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"chart-edit\":\"Edit chart\",\n\n\t\t\"chart-common\":\"Common\",\n\t\t\"chart-series\":\"Series\",\n\t\t\"chart-extras\":\"Extras\",\n\n\t\t\"export-view\":\"Download\",\n\t\t\"export-view-pdf\":\"PDF document\",\n\t\t\"export-view-png\":\"PNG image\",\n\t\t\"export-view-excel\":\"Excel file\",\n\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\t\t\"scatter-chart\":\"Scatter\",\n\n\t\t\"chart-scale\":\"Scale\",\n\t\t\"chart-x-axis\":\"X axis\",\n\t\t\"chart-y-axis\":\"Y axis\",\n\t\t\"chart-lines\":\"Lines\",\n\t\t\"chart-scale-color\":\"Scale color\",\n\t\t\"chart-xAxis-title\":\"Title\",\n\t\t\"chart-yAxis-title\":\"Title\",\n\t\t\"chart-col-xAxis\":\"Use left column as xAxis\",\n\t\t\"chart-col-yAxis\":\"Use left column as yAxis\",\n\t\t\"chart-row-xAxis\":\"Use top row as xAxis\",\n\t\t\"chart-row-yAxis\":\"Use top row as yAxis\",\n\t\t\"chart-xAxis-range\":\"Range\",\n\t\t\"chart-yAxis-origin\":\"Origin\",\n\t\t\"chart-yAxis-start\":\"Start\",\n\t\t\"chart-yAxis-end\":\"End\",\n\t\t\"chart-yAxis-step\":\"Step\",\n\t\t\"chart-yAxis-note\":\"* Set all the following parameters to see the effect\",\n\n\t\t\"chart-legend\":\"Legend\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-legend-range\":\"Legend range\",\n\t\t\"chart-legend-align\":\"Align\",\n\t\t\"chart-legend-left\":\"Left\",\n\t\t\"chart-legend-right\":\"Right\",\n\t\t\"chart-legend-center\":\"Center\",\n\t\t\"chart-legend-valign\":\"Vertical align\",\n\t\t\"chart-legend-top\":\"Top\",\n\t\t\"chart-legend-middle\":\"Middle\",\n\t\t\"chart-legend-bottom\":\"Bottom\",\n\n\t\t\"chart-item\":\"Data\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"horizontal-chart\":\"Horizontal\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-series-color\":\"Color\",\n\t\t\"add-line\":\"Add line\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-tooltip\":\"Tooltips\",\n\t\t\"chart-label\":\"Labels\",\n\n\t\t\"chart-data-from\":\"Data series from\",\n\t\t\"chart-columns\":\"columns\",\n\t\t\"chart-rows\":\"rows\",\n\n\t\t\"chart-markers\":\"Markers\",\n\t\t\"chart-markers-square\":\"Square\",\n\t\t\"chart-markers-triangle\":\"Triangle\",\n\t\t\"chart-markers-diamond\":\"Diamond\",\n\t\t\"chart-markers-round\":\"Round\",\n\n\t\t\"chart-pie-3d\":\"3D\",\n\n\t\t\"chart-radar-circle\":\"Circled lines\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"underline\": \"Underline\",\n\t\t\"strike\": \"Strike\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"show-formulas\": \"Hide/show formulas\",\n\t\t\"print-borders\": \"Hide/show print borders\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\",\n\t\t\"increase-indent\" : \"Increase indent\",\n\t\t\"decrease-indent\": \"Decrease indent\",\n\t\t\"scale\": \"Scale\",\n\t\t\"show-sheet\": \"Show sheet\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"hide-sheet\": \"Hide sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"common\": \"common\",\n\t\t\"text\": \"text\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"show-formulas\": \"Hide/show formulas\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"print-borders\": \"Hide/show print borders\",\n\t\t\"add-comment\":\"Comment\",\n\t\t\"cut\": \"Cut\",\n\t\t\"copy\": \"Copy\",\n\t\t\"paste\": \"Paste\",\n\t\t\"special-paste\": \"Special paste\",\n\t\t\"paste-values\": \"Values\",\n\t\t\"paste-formulas\": \"Formulas\",\n\t\t\"paste-styles\": \"Styles\",\n\t\t\"paste-conditions\": \"Conditional formats\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"#ERROR!\",\n\t\t\"math-ref-error\":\"#REF!\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\",\n\t\t\"currencies\": [\n\t\t\t\"{obj} â¬\",\n\t\t\t\"Â¥{obj}\",\n\t\t\t\"R$ {obj}\",\n\t\t\t\"{obj} rub.\"\n\t\t]\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconst skin = webix.skin.$name;\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css, name: config.name, width: 68,\n\t\t\t\t\t\t\tvalue: (skin == \"contrast\" || skin == \"dark\") ? \"#ffffff\" : \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"richselect\", css:\"webix_ssheet_border_type\", value:\"thin\", suggest:{\n\t\t\t\t\t\t\t\tfitMaster:false,\n\t\t\t\t\t\t\t\twidth:130,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\ttemplate:\"<div class='webix_ssheet_border webix_ssheet_border_#id#'></div>\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[\n\t\t\t\t\t\t\t\t\t{ id:\"thin\" },\n\t\t\t\t\t\t\t\t\t{ id:\"medium\" },\n\t\t\t\t\t\t\t\t\t{ id:\"thick\" },\n\t\t\t\t\t\t\t\t\t{ id:\"dashed\" }, \n\t\t\t\t\t\t\t\t\t{ id:\"dotted\" },\n\t\t\t\t\t\t\t\t\t{ id:\"double\" }\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tconst value = this.getValue();\n\t\tconst master = webix.$$(this.config.master);\n\t\tmaster.setValue(value, \"user\");\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t\tif(value[2])\n\t\t\tthis.getTypeView().setValue(value[2]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\", this.getTypeView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetTypeView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[1];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value, config){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tconst old = this.config.value;\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\", [this.getValue(), old, config]);\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\theight: 196,\n\t\twidth: 244,\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t},\n\t$init:function(){\n\t\tthis.attachEvent(\"onSelect\", function(value){\n\t\t\tthis.getParentView().setMasterValue({ value }, false, \"user\");\n\t\t});\n\t}\n}, webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\"\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tconst color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvalue = value || \"\";\n\t\tthis.getColorNode().style.backgroundColor = value;\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},t(r,e)};var r=function(){return r=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},r.apply(this,arguments)};!function(r){function e(){return null!==r&&r.apply(this,arguments)||this}(function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,r)}(Array);var e,n={1:\"#ERROR\",2:\"#ERROR\",3:\"#REF!\",4:\"#SPILL!\"};function o(t,r,e){return e+64*r+64*t*4096}function i(t){return[t<2147483648?t>>18:t/262144&16777215,t>>6&4095,63&t]}function a(t){return t<2147483648?t>>18:t/262144&16777215}function u(t){return t>>6&4095}function f(t){return 63&t}function s(t,r,e){for(var n=i(t),o=n[0],a=n[1],u=i(r),f=u[0]-o,s=u[1]-a,h=0;h<=f;h++)for(var c=0;c<=s;c++)e(t+64*c+4096*h*64)}function h(t,r,e,n){for(var o=0,i=0;i<e;i++)for(var a=0;a<r;a++)n(t+64*a+4096*i*64,o),o++}function c(t,r){for(var e,n,o,a,u,s,h,c,l=t.code,g=t.source,d=\"\",_=l.length,y=0;y<_;y+=3){switch(l[y]){case 5:var M=void 0;9===l[y+6]&&(M=r.pageName(f(l[y+7]))),d+=v(M||t.source.substr(l[y+1],l[y+2]))+\"!\";break;case 7:a=(e=i(l[y+4]))[0],s=e[1],c=e[2],r.z!==c&&5!==l[y-3]&&(d+=v(r.pageName(c))+\"!\"),d+=p(a,s,l[y+5]);break;case 4:d+=g.substr(l[y+1],l[y+2]).toUpperCase();break;case 8:a=(n=i(l[y+4]))[0],s=n[1],c=n[2],u=(o=i(l[y+7]))[0],h=o[1],r.z!==c&&5!==l[y-3]&&(d+=v(r.pageName(c))+\"!\"),d+=p(a,s,l[y+5]),d+=\":\",d+=p(u,h,l[y+8]);break;case 9:break;case 2:d+=\"{{\"+g.substr(l[y+1],l[y+2])+\"}}\";break;case 3:d+=\"#REF!\";break;case 1:d+='\"'+g.substr(l[y+1],l[y+2])+'\"';break;case 13:d+=\"{\";var b=l[y+1],m=l[y+2];y+=3;for(var w=0;w<m;w++){for(var E=0;E<b;E++){E>0&&(d+=\",\");var C=l[y];1===C?d+='\"'+g.substr(l[y+1],l[y+2])+'\"':11===C&&(d+=g.substr(l[y+1],l[y+2])),y+=3}w<m-1&&(d+=\";\")}y-=3,d+=\"}\";break;default:d+=g.substr(l[y+1],l[y+2])}}return d}function p(t,r,e){var n=\"\";2&e&&(n+=\"$\");var o=\"\";for(r+=1;r>0;){var i=r%26;0===i&&(i=26),o=String.fromCharCode(64+i)+o,r=(r-i)/26}return n+=o,1&e&&(n+=\"$\"),n+=t+1}function v(t){return-1!==t.indexOf(\" \")?\"'\"+t+\"'\":t}function l(t){return t<=122}function g(t){return t<=122?t>=65||35===t||36===t||46===t:t>191}function d(t){return t>=97}function _(t){var r=t.charCodeAt(0);return r>=48&&r<=57}function y(t,r){var e;do{r++,e=t.charCodeAt(r)}while(e>=48&&e<=57);return r}function M(t,r){var e;do{e=t[++r]}while('\"'!==e);return r}function b(t){return\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t}function m(t,r){var e;do{e=t[++r]}while(b(e));return r}function w(t,r){if(\"<\"===t[r]){var e=t[r+1];\">\"!==e&&\"=\"!==e||r++}else\">\"===t[r]&&\"=\"===t[r+1]&&r++;return r+1}function E(t,r,n){for(var o=t.length,i=!0,a=r,u=!1,f=!1,s=!1,h=0;a<o;a++){var c=t[a];if(\"'\"!==c){if(!u){s=!0;var p=c.charCodeAt(0);if(g(p)){l(p)?d(p)&&(f=!0):i=!1,1==h&&h++;continue}if(_(c)){0==h&&h++;continue}break}}else{if(s)break;if(u){a++;break}u=!0}}var v=t[a],y=r,M=a-r;return u&&((M-=1+(\"'\"===t[a-1]?1:0))<0&&(M=0),y++,n=5),0===n&&(\":\"===v&&i?1!==h?n=3:(n=8,f&&(e=!0)):\"!\"===v?n=\"#\"===t[y]?3:5:\"(\"===v?(function(t,r,e){var n=t.substr(r,e);return n.toUpperCase()!==n}(t,y,M)&&(e=!0),n=4):\"}\"===v&&\"}\"===t[a-1]?n=2:1===h&&i?(n=7,f&&(e=!0)):n=6),[y,M,a,n]}function C(t,r,e){for(var n=0,i=0,a=1,u=1,f=0,s=!1,h=r.length-1;h>=0;h--){var c=r[h].charCodeAt(0);36!==c?c<58?(i+=(c-48)*a,a*=10):(s||(a=1,n=i,i=0,s=!0,u+=1),i+=(c-(c>96?96:64))*a,a*=26):f+=u}i>4095?t.push(3,0,0):t.push(9,o(n-1,i-1,e),f)}function I(t,r){var n,o,i=[];e=!1;for(var u,f=-1,s=-1,h=0,p=0;p<t.length;p++){var v=t[p];if(s>-1)if(\"}\"==v){var l=i[s+2]+=1,g=i[s+1]=h/l;g-Math.round(g)!=0&&i.push(3,0,0),s=-1}else if('\"'===v){var d=M(t,p);p++,i.push(1,p,d-p),h++,p=d}else if(\"-\"===v){var I=y(t,p+1);i.push(11,p,I-p),h++,p=I-1}else if(_(v)){var T=y(t,p);i.push(11,p,T-p),h++,p=T-1}else\" \"===v||\"\\t\"===v||\",\"===v||(\";\"===v?i[s+2]+=1:i.push(3,0,0));else if('\"'!=v){if(!(f>-1))if(\"{\"!=v)if(\"'\"==v||((u=v.charCodeAt(0))<=122?u>=65||35===u||36===u:u>191)){var D=void 0,A=E(t,p,0),N=(B=A[0],Y=A[1],A[2]),S=A[3],x=i.length;if(7!==S&&8!==S||5!==i[i.length-3])D=r.z,i.push(S,B,Y);else{var O=\"'\"===t[B-2]?1:0,R=i[x-2],L=i[x-1];void 0===(D=r.page(t.substr(R,L)))&&(i.push(3,0,0),D=0),i.push(S,B-L-2*O-1,Y+L+2*O+1)}if(p=N-1,6===S)r.name(i,t,r);else if(8===S){var P=i.length;if(C(i,t.substr(B,Y),D),B=(n=E(t,p+2,0))[0],Y=n[1],N=n[2],5===(S=n[3])&&(B=(o=E(t,N+1,0))[0],Y=o[1],N=o[2],S=o[3]),7!==S){i[P-3]=7;continue}C(i,t.substr(B,Y),D);var k=i[P+1],F=i[P+4];(k>F||a(k)>a(F))&&(i[P+1]=F,i[P+4]=k),i[P-1]+=Y+1,p=N-1}else 7===S?C(i,t.substr(B,Y),D):3!==S&&5!==S||p++}else if(b(v)){var U=m(t,p);i.push(12,p,U-p),p=U-1}else if(_(v)){var V=y(t,p);i.push(11,p,V-p),p=V-1}else{var X=w(t,p);i.push(10,p,X-p),p=X-1}else{if(\"{\"==t[p+1]){var H=E(t,p+2,2),B=H[0],Y=H[1],j=H[2];i.push(2,B,Y),p=j+2-1;continue}s=i.length,h=0,i.push(13,0,0)}}else f>-1?(i.push(1,f+1,p-f-1),f=-1):f=p}var G={code:i,source:t,exec:null,broken:0,triggers:null};return e&&(G.source=c(G,r)),G}function T(t){return\"            \".substr(0,10-t.length)}var D=[\">\",\"<\",\"=\",\"+\"];function A(t,r){var e=function(t,r){for(var e=t.code,n=t.source,o=\"\",i=0,a=[],u=e.length,f=0;f<u;f+=3){switch(e[f]){case 4:o+='ctx.m[\"'+n.substr(e[f+1],e[f+2]).toUpperCase()+'\"]';break;case 1:o+='\"'+n.substr(e[f+1],e[f+2])+'\"';break;case 2:o+='ctx.p(\"'+n.substr(e[f+1],e[f+2])+'\")';break;case 6:case 7:var s=void 0,h=void 0;if(10===e[f-3]?s=f-3:12===e[f-3]&&10===e[f-6]&&(s=f-6),10===e[f+6]?h=f+6:12===e[f+6]&&10===e[f+9]&&(h=f+9),s||h){var c=s?n[e[s+1]]:null,p=h?n[e[h+1]]:null;if(\"&\"==c||\"&\"==p){o+=\"(ctx.v(\"+e[f+4]+') === null ? \"\" : ctx.v('+e[f+4]+\"))\";break}if(-1!=D.indexOf(c)||-1!=D.indexOf(p)){o+=\"(ctx.v(\"+e[f+4]+\") === null ? 0 : ctx.v(\"+e[f+4]+\"))\";break}}o+=\"ctx.v(\"+e[f+4]+\")\";break;case 8:o+=\"ctx.r(\"+e[f+4]+\", \"+e[f+7]+\")\";break;case 10:if(1===e[f+2])\"&\"===(v=n[e[f+1]])?o+='+\"\"+':r&&\"+\"==v?o+=\"*1+1*\":\"=\"===v?o+=\"==\":\";\"===v?o+=\",\":\"{\"===v?o+=\"[\":\"}\"===v?o+=\"]\":\"%\"===v?e[f+3]&&10!==e[f+3]?o+=r?\"/0+\":v:o+=(\"/\"==a[i]?\"*\":\"/\")+\"100\":(\"(\"==v?(i++,a.push(\"+\")):\")\"==v&&(i--,a.pop()),o+=v),\"+\"!=v&&\"-\"!=v&&\"*\"!=v&&\"/\"!=v&&\"&\"!=v||(a[i]=v);else if(2===e[f+2]){var v;o+=\"<>\"===(v=n.substr(e[f+1],e[f+2]))?\"!=\":v}else o+=n.substr(e[f+1],e[f+2]);break;case 11:o+=n.substr(e[f+1],e[f+2]);break;case 3:return\"\";case 9:case 5:case 12:break;case 13:o+=\"ctx.a([\";for(var l=e[f+1],g=e[f+2],d=(f+=3)+l*g*3,_=!1;f<d;f+=3){_&&(o+=\",\");var y=e[f];if(11===y)o+=n.substr(e[f+1],e[f+2]);else if(1===y)o+='\"'+n.substr(e[f+1],e[f+2])+'\"';else if(3===y)return t.broken=3,\"\";_=!0}f-=3,o+=\"],\"+l+\", \"+g+\")\"}}return o}(t,r);if(!e)return t.broken=3,void(t.exec=null);try{t.exec=new Function(\"ctx\",\"return \"+e)}catch(r){t.broken=1,t.exec=null}}var N=\"#DIV/0!\",S=\"#VALUE!\",x=\"#NUM!\",O=\"#N/A\";function R(t){var r=new Date(t.getFullYear(),0,0),e=t.valueOf()-r.valueOf()+60*(r.getTimezoneOffset()-t.getTimezoneOffset())*1e3;return Math.floor(e/864e5)}function L(t){var r=new Date(Math.round(86400*(t-25569)*1e3));return new Date(r.getTime()+6e4*r.getTimezoneOffset())}function P(t){return 25569+(t.getTime()-6e4*t.getTimezoneOffset())/864e5}function k(t){return!(!t&&0!==t||(t*=1,isNaN(t)))&&t}function F(t){if(1===t.length){var r=t[0];return\"object\"==typeof r?r:[r]}for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e}function U(t){return!t&&0!==t}function V(t){return\"string\"==typeof t?\"TRUE\"===t:!!t}function X(t){var r=\"string\"==typeof t?new Date(t):L(t);if(r.getTime())return r;throw t+\" is invalid date\"}function H(t){var r=k(t);if(\"number\"!=typeof r)throw t+\" is not a number\";return r}function B(t,r,e,n,o){var i=k(t);i<0&&8==o&&(r=null);var a,u=r?k(r):null;if(\"number\"!=typeof i||\"boolean\"==typeof u)throw S;if(i<e&&(i=e),i>n&&(i=n),u<-1)throw x;u&&(u=Math.floor(+u));var f=t<0&&16===o?\"FF\":\"\";if(a=n<2147483648?(i>>>0&n-e).toString(o):(i>>>0).toString(o),u&&a.length>u)throw x;return(f+a).padStart(u,\"0\").toUpperCase()}function Y(t,r){var e=+Et(t),n=+Ct(t),o=+Et(r),i=+Ct(r);return lt(e*o-n*i,e*i+n*o)}function j(t,r){var e=+Et(t),n=+Ct(t);return lt(e+ +Et(r),n+ +Ct(r))}function G(t){return t>0?Math.floor(t):Math.ceil(t)}function z(t){return t<0?Math.floor(t):Math.ceil(t)}function $(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=F(t),o=0;o<n.length;o++){var i=k(n[o]);\"number\"==typeof i&&(e+=i)}return e}function q(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=0,o=F(t),i=0;i<o.length;i++){var a=k(o[i]);\"number\"==typeof a&&(e+=a,n++)}return n?e/n:0}function W(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=F(t),n=0,o=0,i=0;i<e.length;i++){var a=e[i],u=k(e[i]);\"number\"==typeof u?(n+=u,o++):(!0===a&&n++,(a||!1===a)&&o++)}return o?n/o:0}function K(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=F(t),o=0;o<n.length;o++){var i=k(n[o]);\"number\"==typeof i&&e++}return e}function Q(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=F(t),o=0;o<n.length;o++)n[o]&&1*n[o]!=0&&e++;return e}function J(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=-1/0,n=F(t),o=0;o<n.length;o++){var i=k(n[o]);\"number\"==typeof i&&i>e&&(e=i)}return e===-1/0?0:e}function Z(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=1/0,n=F(t),o=0;o<n.length;o++){var i=k(n[o]);\"number\"==typeof i&&i<e&&(e=i)}return e===1/0?0:e}function tt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=!1,n=1,o=F(t),i=0;i<o.length;i++){var a=k(o[i]);\"number\"==typeof a&&(e=!0,n*=a)}return e?n:null}function rt(t,r,e){for(var n=F(t),o=r?0:-1,i=e?W.apply(void 0,t):q.apply(void 0,t),a=0,u=0;u<n.length;u++){var f=n[u],s=k(n[u]);if(\"number\"!=typeof s){if(!e||\"boolean\"!=typeof f&&!f)continue;s=!0===f?1:0}o++,a+=Math.pow(s-i,2)}return o?a/o:0}function et(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return rt(t,!1,!1)}function nt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return rt(t,!1,!0)}function ot(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return rt(t,!0,!1)}function it(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return rt(t,!0,!0)}function at(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(et.apply(void 0,t))}function ut(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(ot.apply(void 0,t))}function ft(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.pow(e,n)}var st={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};var ht=[];function ct(t){var r=k(t);if(\"number\"==typeof r&&r>-1){var e=Math.floor(r);return 0===e||1===e?1:(ht[e]>0||(ht[e]=ct(e-1)*e),ht[e])}}function pt(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ct(e)/(ct(n)*ct(e-n))}var vt=[\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"];function lt(t,r,e){void 0===e&&(e=\"i\");var n=k(t),o=k(r);if(\"number\"!=typeof n&&\"number\"!=typeof o)throw x;var i=\"\",a=\"\";return t&&(i=t.toString()),r&&1!==r?a=r+e:1===r&&(a=e),r>0?(i?i+\"+\":\"\")+a:i+a}function gt(t,r){return void 0===r&&(r=null),B(t,r,-512,511,2)}function dt(t,r){return void 0===r&&(r=null),B(t,r,-274877906944,274877906943,16)}function _t(t,r){return void 0===r&&(r=null),B(t,r,-536870912,536870911,8)}var yt=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17];function Mt(t){for(var r,e=t<0,n=0,o=0,i=2/(2+(t=Math.abs(t))),a=4*i-2,u=yt.length-1;u>0;u--)r=a*n-o+yt[u],o=n,n=r;var f=i*Math.exp(-t*t+.5*(yt[0]+a*n)-o);return e?f-1:1-f}function bt(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e)return\"number\"==typeof n?Mt(n)-Mt(e):Mt(e);throw S}var mt=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var wt=Math.pow(2,39);function Et(t){if(\"string\"!=typeof t)throw S;if([\"i\",\"+i\",\"1i\",\"+1i\",\"-i\",\"-1i\",\"j\",\"+j\",\"1j\",\"+1j\",\"-j\",\"-1j\"].indexOf(t)>=0)return 0;var r=t.indexOf(\"+\"),e=t.indexOf(\"-\");0===r&&(r=t.indexOf(\"+\",1)),0===e&&(e=t.indexOf(\"-\",1));var n=t.substring(t.length-1,t.length),o=\"i\"===n||\"j\"===n;if(r>=0||e>=0){if(!o)throw x;if(r>=0){if(isNaN(+t.substring(0,r))||isNaN(+t.substring(r+1,t.length-1)))throw x;return Number(t.substring(0,r))}if(isNaN(+t.substring(0,e))||isNaN(+t.substring(e+1,t.length-1)))throw x;return Number(t.substring(0,e))}if(o){if(isNaN(+t.substring(0,t.length-1)))throw x;return 0}if(isNaN(+t))throw x;return+t}function Ct(t){if(\"string\"!=typeof t)throw S;if([\"i\",\"j\"].indexOf(t)>=0)return 1;var r=(t=t.replace(\"+i\",\"+1i\").replace(\"-i\",\"-1i\").replace(\"+j\",\"+1j\").replace(\"-j\",\"-1j\")).indexOf(\"+\"),e=t.indexOf(\"-\");0===r&&(r=t.indexOf(\"+\",1)),0===e&&(e=t.indexOf(\"-\",1));var n=t.substring(t.length-1,t.length),o=\"i\"===n||\"j\"===n;if(r>=0||e>=0){if(!o)throw x;if(r>=0){if(isNaN(+t.substring(0,r))||isNaN(+t.substring(r+1,t.length-1)))throw x;return Number(t.substring(r+1,t.length-1))}if(isNaN(+t.substring(0,e))||isNaN(+t.substring(e+1,t.length-1)))throw x;return-Number(t.substring(e+1,t.length-1))}if(o){var i=+t.substring(0,t.length-1);if(isNaN(i))throw x;return i}if(isNaN(+t))throw x;return 0}function It(t){var r=+Et(t),e=+Ct(t);return lt(Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e))}function Tt(t){var r=+Et(t),e=+Ct(t);return lt(Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2)}function Dt(t,r){var e=+Et(t),n=+Ct(t),o=+Et(r),i=+Ct(r),a=Math.pow(o,2)+Math.pow(i,2);return lt((e*o+n*i)/a,(n*o-e*i)/a)}function At(t){var r=+Et(t),e=+Ct(t);return lt(Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e))}function Nt(t){var r=+Et(t),e=+Ct(t);return lt(Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2)}var St=Math.pow(2,29);function xt(t,r,e){var n=k(r);if(\"number\"!=typeof n||r<0||r>1||e&&(0===r||1===r))throw S;var o=F(t).sort((function(t,r){return t-r}));e&&(o=function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),o=0;for(r=0;r<e;r++)for(var i=arguments[r],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}([0],o));var i=(o.length+(e?0:-1))*n,a=Math.floor(i);if(void 0===o[a+1])return o[a];var u=o[a+1]-o[a];return o[a]+u*(i-a)}function Ot(t,r,e){var n=k(r);if(\"number\"!=typeof n)throw S;switch(n){case 0:if(e)throw S;return Z.apply(void 0,t);case 1:return xt(t,.25,e);case 2:return xt(t,.5,e);case 3:return xt(t,.75,e);case 4:if(e)throw S;return J.apply(void 0,t);default:throw x}}function Rt(t,r,e,n){var o=H(t),i=H(r),a=H(e);if(1==r)return 1/a;var u=Math.exp(-Math.pow(o/a,i));return n?1-u:i/Math.pow(a,i)*Math.pow(o,i-1)*u}function Lt(t,r,e,n){void 0===n&&(n=!1);var o=H(t),i=H(r),a=H(e),u=function(t,r,e){return pt(r,t)*Math.pow(e,t)*Math.pow(1-e,r-t)};if(!n)return u(o,i,a);for(var f=0,s=0;s<o+1;s++)f+=u(s,i,a);return f}function Pt(t,r,e){var n=t.filter((function(t){return\"number\"==typeof t})),o=r.filter((function(t){return\"number\"==typeof t}));if(n.length!==o.length)throw O;var i=n.length;if(0===i)throw N;for(var a=n.reduce((function(t,r){return t+r}),0)/i,u=o.reduce((function(t,r){return t+r}),0)/i,f=0,s=0;s<i;s++)f+=(n[s]-a)*(o[s]-u);return f/(e?i-1:i)}function kt(t,r){return Pt(t,r,!1)}var Ft={ABS:function(t){var r=k(t);if(\"number\"==typeof r)return Math.abs(r)},ACOS:function(t){var r=k(t);if(\"number\"==typeof r)return Math.acos(r)},ACOSH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.acosh(r)},ACOT:function(t){var r=k(t);if(\"number\"==typeof r)return Math.atan(1/r)},ACOTH:function(t){var r=k(t);if(\"number\"==typeof r)return.5*Math.log((r+1)/(r-1))},ADD:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e+n},ARABIC:function(t){if(!k(t)&&/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(\"\"+t)){var r=0;return(\"\"+t).replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){return r+=st[t],t})),+r}},ASIN:function(t){var r=k(t);if(\"number\"==typeof r)return Math.asin(r)},ASINH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.asinh(r)},ATAN:function(t){var r=k(t);if(\"number\"==typeof r)return Math.atan(r)},ATAN2:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.atan2(n,e)},ATANH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.log((1+r)/(1-r))/2},AVEDEV:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t).filter((function(t){return\"number\"==typeof t})),n=e.length;if(0===n)throw N;var o=e.reduce((function(t,r){return t+r}),0)/n,i=e.reduce((function(t,r){return t+Math.abs(r-o)}),0);return i/n},AVERAGE:q,AVERAGEA:W,BASE:function(t,r,e){void 0===e&&(e=0);var n=k(t),o=k(r),i=k(e);if(\"number\"==typeof n&&\"number\"==typeof o&&\"number\"==typeof i){var a=n.toString(o);return new Array(Math.max(i+1-a.length,0)).join(\"0\")+a.toUpperCase()}},BINOMDIST:Lt,\"BINOM.INV\":function(t,r,e){for(var n=H(t),o=H(r),i=H(e),a=0;a<=n;a++){if(Lt(a,n,o,!0)>=i)return a}},\"BINOM.DIST.RANGE\":function(t,r,e,n){var o=H(t),i=H(r),a=H(e),u=k(n);\"number\"!=typeof u&&(u=a);for(var f=0,s=a;s<=u;s++){f+=pt(o,s)*Math.pow(i,s)*Math.pow(1-i,o-s)}return f},\"BINOM.DIST\":Lt,BITAND:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e&n;throw S},BITLSHIFT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return n>0?e<<n:e>>-n;throw S},BITOR:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e|n;throw S},BITRSHIFT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return n>0?e>>n:e<<-n;throw S},BITXOR:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e^n;throw S},CEILING:function(t,r,e){void 0===r&&(r=1),void 0===e&&(e=0);var n=k(t),o=k(r),i=k(e);if(\"number\"==typeof n&&\"number\"==typeof o&&\"number\"==typeof i)return 0===o?0:(o=Math.abs(o),n>=0?Math.ceil(n/o)*o:0===e?-1*Math.floor(Math.abs(n)/o)*o:-1*Math.ceil(Math.abs(n)/o)*o)},COMBIN:pt,COMBINA:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return 0===e&&0===n?1:pt(e+n-1,e-1)},COMPLEX:lt,CORREL:function(t,r){if(t.length!==r.length)throw O;for(var e=t.filter((function(t){return\"number\"==typeof t})),n=r.filter((function(t){return\"number\"==typeof t})),o=e.length,i=e.reduce((function(t,r){return t+r}),0)/o,a=n.reduce((function(t,r){return t+r}),0)/o,u=0,f=0,s=0,h=0;h<o;h++)u+=(e[h]-i)*(n[h]-a),f+=Math.pow(e[h]-i,2),s+=Math.pow(n[h]-a,2);var c=Math.sqrt(f*s);if(!c)throw N;return u/c},COS:function(t){var r=k(t);if(\"number\"==typeof r)return Math.cos(r)},COSH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.cosh(r)},COT:function(t){var r=k(t);if(\"number\"==typeof r)return 1/Math.tan(r)},COTH:function(t){var r=k(t);if(\"number\"==typeof r){var e=Math.exp(2*r);return(e+1)/(e-1)}},COUNT:K,COUNTA:Q,COUNTBLANK:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=F(t),o=0;o<n.length;o++)0===n[o]||n[o]||e++;return e},COVAR:kt,\"COVARIANCE.P\":kt,\"COVARIANCE.S\":function(t,r){return Pt(t,r,!0)},CSC:function(t){var r=k(t);if(\"number\"==typeof r)return 1/Math.sin(r)},CSCH:function(t){var r=k(t);if(\"number\"==typeof r)return 2/(Math.exp(r)-Math.exp(-r))},DEC2BIN:gt,DEC2HEX:dt,DEC2OCT:_t,DECIMAL:function(t,r){var e=k(t),n=k(r);if(!(\"\"+e).match(\"/[2-9]/\")&&\"number\"==typeof e&&\"number\"==typeof n&&n>1&&n<37)return parseInt(\"\"+e,n)},DEGREES:function(t){var r=k(t);if(\"number\"==typeof r)return 180*r/Math.PI},DELTA:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e||\"number\"==typeof e)return+(e===n);throw S},DEVSQ:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t),n=[];e.forEach((function(t){\"number\"==typeof t&&n.push(t)}));var o=n.reduce((function(t,r){return t+r}),0)/n.length;return n.reduce((function(t,r){return t+Math.pow(r-o,2)}),0)},DIVIDE:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n&&0!==n)return e/n},EQ:function(t,r){return typeof t==typeof r&&t==r},ERF:bt,ERFC:function(t,r){var e=k(t);if(\"number\"==typeof e)return 1-bt(e,r);throw S},EVEN:function(t){var r=k(t);if(\"number\"==typeof r){var e=z(r);return e%2?e+Math.sign(r):e}},EXP:function(t){var r=k(t);if(\"number\"==typeof r)return Math.exp(r);throw S},FACT:ct,FACTDOUBLE:function t(r){var e=k(r);if(\"number\"==typeof e){var n=Math.floor(e);return n<=0?1:n*t(n-2)}},FISHER:function(t){var r=k(t);if(\"number\"==typeof r&&r>-1&&r<1)return.5*Math.log((1+r)/(1-r));throw S},FISHERINV:function(t){var r=k(t);if(\"number\"==typeof r){var e=Math.exp(2*r);return(e-1)/(e+1)}throw S},FLOOR:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n){var o=Math.abs(n);return e>=0?Math.floor(e/o)*o:-1*Math.ceil(Math.abs(e)/o)*o}},GAMMA:function t(r){var e=k(r);if(\"number\"!=typeof e)throw S;if(!(Number.isInteger(e)&&e<=0)){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*t(1-e));e-=1;for(var n=mt[0],o=1;o<9;o++)n+=mt[o]/(e+o);var i=e+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*n}throw x},GCD:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t),n=e.length;if(!n)return 1;for(var o=e[0],i=1;\"number\"!=typeof o;){if(o=e[i],i>e.length)throw\"The arguments should contain at least one numeric value\";i++}for(var a=o<0?-o:o;i<n;i++){var u=k(e[i]);if(\"number\"==typeof u){for(var f=u<0?-u:u;a&&f;)a>f?a%=f:f%=a;a+=f}}return a},GEOMEAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t);if(e.some((function(t){return!Number.isFinite(t)||t<=0})))throw x;return Math.pow(e.reduce((function(t,r){return r*t}),1),1/e.length)},GESTEP:function(t,r){void 0===r&&(r=0);var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return+(t>=r);throw S},GT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e>n},GTE:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e>=n},HARMEAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t);if(e.some((function(t){return!Number.isFinite(t)||t<=0})))throw x;var n=e.reduce((function(t,r){return t+1/r}),0);return 1/(1/e.length*n)},HEX2BIN:function(t,r){return gt(parseInt(t.toString(),16),r)},HEX2DEC:function(t,r){var e=parseInt(t.toString(),16);if(!Number.isFinite(e))throw S;var n=e>wt;n&&(e=-(e-2*wt));var o=r?k(r):null,i=e.toString();return(n?\"-\":\"\")+(o?i.padStart(o,\"0\"):i)},HEX2OCT:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),16);return e>wt&&(e^=wt),_t(e,r)},IMABS:function(t){var r=Et(t),e=Ct(t);if(!Number.isFinite(+r)||!Number.isFinite(+e))throw S;return Math.sqrt(Math.pow(+r,2)+Math.pow(+e,2))},IMAGINARY:Ct,IMCONJUGATE:function(t){return lt(+Et(t),-+Ct(t))},IMCOS:It,IMCOSH:Tt,IMCOT:function(t){return Dt(It(t),At(t))},IMCSC:function(t){return Dt(\"1\",At(t))},IMCSCH:function(t){return Dt(\"1\",Nt(t))},IMDIV:Dt,IMEXP:function(t){var r=+Et(t),e=+Ct(t),n=Math.exp(r);return lt(n*Math.cos(e),n*Math.sin(r))},IMLN:function(t){var r=+Et(t),e=+Ct(t);return lt(Math.log(Math.sqrt(r*r+e*e)),Math.atan(e/r))},IMPOWER:function(t,r){var e=k(r);if(\"number\"!=typeof e)throw S;var n=+Et(t),o=+Ct(t),i=Math.sqrt(n*n+o*o),a=Math.pow(i,e),u=Math.atan(o/n);return lt(a*Math.cos(e*u),a*Math.sin(e*u))},IMPRODUCT:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)throw S;for(var e=t[0],n=0,o=t.slice(1);n<o.length;n++){var i=o[n];e=Y(e.toString(),i.toString())}return e.toString()},IMREAL:Et,IMSEC:function(t){return Dt(\"1\",It(t))},IMSECH:function(t){return Dt(\"1\",Tt(t))},IMSIN:At,IMSINH:Nt,IMSQRT:function(t){var r=+Et(t),e=+Ct(t),n=Math.sqrt(Math.sqrt(r*r+e*e)),o=Math.atan(e/r)/2;return lt(n*Math.cos(o),n*Math.sin(o))},IMSUB:function(t,r){var e=+Et(t),n=+Ct(t);return lt(e-+Et(r),n-+Ct(r))},IMSUM:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)throw S;for(var e=t[0],n=0,o=t.slice(1);n<o.length;n++){var i=o[n];e=j(e.toString(),i.toString())}return e.toString()},IMTAN:function(t){return Dt(At(t),It(t))},INT:function(t){var r=k(t);if(\"number\"==typeof r)return Math.floor(r)},LARGE:function(t,r){var e=k(r),n=t.sort((function(t,r){return t-r}));if(\"number\"==typeof e&&!t.some((function(t){return\"number\"!=typeof k(t)})))return n[n.length-e];throw S},LN:function(t){var r=k(t);if(\"number\"==typeof r)return Math.log(r)},LOG:function(t,r){void 0===r&&(r=10);var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.log(e)/Math.log(n)},LOG10:function(t){var r=k(t);if(\"number\"==typeof r)return Math.log(r)/Math.log(10)},LT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e<n},LTE:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e<=n},MAX:J,MEDIAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F(t);e.sort((function(t,r){return t-r}));var n=Math.floor(e.length/2);return e.length%2?e[n]:(e[n-1]+e[n])/2},MIN:Z,MINUS:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e-n},MOD:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n&&0!==n){var o=Math.abs(e%n);return r>0?o:-o}},MROUND:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n&&e*n>-1)return Math.round(e/n)*n},MULTINOMIAL:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=F(t),n=0,o=1,i=0;i<e.length;i++){var a=k(e[i]);\"number\"==typeof a&&(n+=a,o*=ct(e[i]))}return ct(n)/o},MULTIPLY:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e*n},NE:function(t,r){return typeof t!=typeof r||t!=r},OCT2BIN:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),8);return e&St&&(e=-(2*St-e)),gt(e,r)},OCT2DEC:function(t,r){void 0===r&&(r=null);var e=r?k(r):null,n=parseInt(t.toString(),8);if(n&St&&(n=-(2*St-n)),!Number.isFinite(n)||\"boolean\"==typeof e)throw S;return n.toString().padStart(e||0,\"0\")},OCT2HEX:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),8);return e&St&&(e=-(2*St-e)),dt(e,r)},ODD:function(t){var r=k(t);if(\"number\"==typeof r){var e=z(r);return e%2?e:e+Math.sign(r)}},PERCENTILE:xt,\"PERCENTILE.INC\":xt,\"PERCENTILE.EXC\":function(t,r){return xt(t,r,!0)},PERMUT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ct(e)/ct(e-n);throw S},PI:function(){return Math.PI},POW:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ft(t,r)},POWER:ft,PRODUCT:tt,QUARTILE:Ot,\"QUARTILE.INC\":Ot,\"QUARTILE.EXC\":function(t,r){return Ot(t,r,!0)},QUOTIENT:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return G(e/n)},RADIANS:function(t){var r=k(t);if(\"number\"==typeof r)return r*Math.PI/180},RAND:function(){return Math.random()},RANDBETWEEN:function(t,r){var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e+Math.ceil((n-e+1)*Math.random())-1},ROMAN:function(t){var r=k(t);if(\"number\"==typeof r){for(var e=String(r).split(\"\"),n=\"\",o=3;o--;)n=(vt[+e.pop()+10*o]||\"\")+n;return new Array(+e.join(\"\")+1).join(\"M\")+n}},ROUND:function(t,r){var e=k(t),n=k(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return parseFloat(e.toFixed(n))},ROUNDDOWN:function(t,r){var e=k(t),n=k(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return Math.floor(e*Math.pow(10,n))/Math.pow(10,n)},ROUNDUP:function(t,r){var e=k(t),n=k(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return Math.ceil(e*Math.pow(10,n))/Math.pow(10,n)},SEC:function(t){var r=k(t);if(\"number\"==typeof r)return 1/Math.cos(r)},SECH:function(t){var r=k(t);if(\"number\"==typeof r)return 2/(Math.exp(r)+Math.exp(-r))},SIGN:function(t){var r=k(t);if(\"number\"==typeof r)return 0===r?0:r/Math.abs(r);throw S},SIN:function(t){var r=k(t);if(\"number\"==typeof r)return Math.sin(r)},SINH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.sinh(r)},SMALL:function(t,r){var e=k(r),n=t.sort((function(t,r){return t-r}));if(\"number\"==typeof e&&!t.some((function(t){return\"number\"!=typeof k(t)})))return n[e-1];throw S},SQRT:function(t){var r=k(t);if(\"number\"==typeof r&&r>=0)return Math.sqrt(r)},SQRTPI:function(t){var r=k(t);if(\"number\"==typeof r&&r>-1)return Math.sqrt(r*Math.PI)},STDEV:at,\"STDEV.S\":at,\"STDEV.P\":ut,STDEVA:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(nt.apply(void 0,t))},STDEVP:ut,STDEVPA:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(it.apply(void 0,t))},STEYX:function(t,r){if(t.length!==r.length)throw O;var e=t.filter((function(t){return\"number\"==typeof t})),n=r.filter((function(t){return\"number\"==typeof t})),o=e.length;if(2===o)throw N;for(var i=e.reduce((function(t,r){return t+r}),0)/o,a=n.reduce((function(t,r){return t+r}),0)/o,u=0,f=0,s=0,h=0;h<o;h++)u+=(e[h]-i)*(n[h]-a),f+=Math.pow(e[h]-i,2),s+=Math.pow(n[h]-a,2);if(2===s)throw N;return Math.sqrt((f-Math.pow(u,2)/s)/(o-2))},SUBTOTAL:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=k(t),o=F(r);if(\"number\"==typeof n)switch(n){case 1:case 101:return q.apply(void 0,o);case 102:case 2:return K.apply(void 0,o);case 103:case 3:return Q.apply(void 0,o);case 104:case 4:return J.apply(void 0,o);case 105:case 5:return Z.apply(void 0,o);case 106:case 6:return tt.apply(void 0,o);case 107:case 7:case 110:case 10:return;case 108:case 8:return ut.apply(void 0,o);case 109:case 9:return $.apply(void 0,o);case 111:case 11:return ot.apply(void 0,o)}},SUM:$,SUMPRODUCT:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=t[0].length;for(var n in t)if(t[n].length!==e)return;var o=0;for(n=0;n<t[0].length;n++){var i=!1,a=1;for(var u in t){var f=k(t[u][n]);\"number\"==typeof f&&(a*=f,i=!0)}i&&(o+=a)}return o},SUMSQ:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=F(t),o=0;o<n.length;o++){var i=k(n[o]);\"number\"==typeof i&&(e+=Math.pow(i,2))}return e},SUMX2MY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof k(t)}))&&!r.find((function(t){return\"number\"!=typeof k(t)}))){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n]-r[n]*r[n];return e}},SUMX2PY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof k(t)}))&&!r.find((function(t){return\"number\"!=typeof k(t)}))){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n]+r[n]*r[n];return e}},SUMXMY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof k(t)}))&&!r.find((function(t){return\"number\"!=typeof k(t)}))){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n]-r[n],2);return e}},TAN:function(t){var r=k(t);if(\"number\"==typeof r)return Math.tan(r)},TANH:function(t){var r=k(t);if(\"number\"==typeof r)return Math.tanh(r)},TRUNC:function(t){var r=k(t);if(\"number\"==typeof r)return G(r)},VAR:et,\"VAR.S\":et,\"VAR.P\":ot,VARA:nt,VARP:ot,VARPA:it,WEIBULL:Rt,\"WEIBULL.DIST\":Rt};var Ut=/[\\0-\\x1F]/g;var Vt=Object.freeze({__proto__:null,CONCATENATE:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return F(t).join(\"\")},LEFT:function(t,r){return U(t)?\"\":t.toString().substring(0,r)},MID:function(t,r,e){return U(t)?\"\":t.toString().substring(r,r+e)},RIGHT:function(t,r){return U(t)?\"\":t.toString().substring(t.length-r)},LOWER:function(t){return U(t)?\"\":t.toString().toLowerCase()},UPPER:function(t){return U(t)?\"\":t.toString().toUpperCase()},PROPER:function(t){if(U(t))return\"\";var r=t.toString().toLowerCase().split(\" \");for(var e in t=\"\",r)t+=(t?\" \":\"\")+r[e].substring(0,1).toUpperCase()+r[e].substring(1);return t},TRIM:function(t){return U(t)?\"\":t.toString().trim()},LEN:function(t){return U(t)?0:t.toString().length},CHAR:function(t){var r=k(t);if(\"number\"==typeof r)return String.fromCharCode(r)},CLEAN:function(t){return void 0===t&&(t=\"\"),(\"\"+t).replace(Ut,\"\")},CODE:function(t){return void 0===t&&(t=\"\"),(\"\"+t).charCodeAt(0)},EXACT:function(t,r){return t===r},FIND:function(t,r,e){void 0===e&&(e=0);var n=k(e);if(\"number\"==typeof n&&r)return(\"\"+r).indexOf(\"\"+t,n-1)+1;throw\"index cannot be string\"},FIXED:function(t,r,e){void 0===r&&(r=2),void 0===e&&(e=!1);var n=k(t),o=k(r);if(\"number\"==typeof n&&\"number\"==typeof o){var i=n.toFixed(o);if(V(e))return\"\"+i;var a=(\"\"+i).split(\".\"),u=a[0],f=a[1];return u.replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")+\".\"+f}},NUMBERVALUE:function(t,r,e){if(void 0===r&&(r=\".\"),void 0===e&&(e=\",\"),\"string\"==typeof t&&\"string\"==typeof r&&\"string\"==typeof e)return Number(t.replace(r,\".\").replace(e,\"\"))},REGEXEXTRACT:function(t,r){if(\"string\"==typeof t&&\"string\"==typeof r){var e=t.match(new RegExp(r));return e?e[e.length>1?e.length-1:0]:null}},REGEXMATCH:function(t,r){if(\"string\"==typeof t&&\"string\"==typeof r)return!!t.match(new RegExp(r))},REGEXREPLACE:function(t,r,e){if(\"string\"==typeof t&&\"string\"==typeof r)return t.replace(new RegExp(r),\"\"+e)},REPT:function(t,r){var e=k(r);if(\"number\"==typeof e)return new Array(e+1).join(\"\"+t)},SEARCH:function(t,r,e){void 0===e&&(e=0);var n=k(e);if(\"number\"==typeof n){var o=(\"\"+r).toLowerCase().indexOf((\"\"+t).toLowerCase(),n-1)+1;if(0!==o)return o;throw\"not found\"}},SUBSTITUTE:function(t,r,e,n){if(!t||!r||!e&&\"\"!==e)return\"\"+t;if(void 0===n)return(\"\"+t).replace(new RegExp(\"\"+r,\"g\"),\"\"+e);for(var o=0,i=0;(\"\"+t).indexOf(\"\"+r,o)>0;)if(o=(\"\"+t).indexOf(\"\"+r,o+1),++i===n)return(\"\"+t).substring(0,o)+e+(\"\"+t).substring(o+(\"\"+r).length)},T:function(t){return\"string\"==typeof t&&\"TRUE\"!==t&&\"FALSE\"!==t?\"\"+t:\"\"},JOIN:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=[];return r.forEach((function(r){\"object\"==typeof r?n.push(r.join(\"\"+t)):n.push(r)})),n.join(\"\"+t)},REPLACE:function(t,r,e,n){var o=k(r),i=k(e);if(\"number\"==typeof o&&\"number\"==typeof i){var a=t.toString(),u=n.toString();return a.replace(a.substr(o-1,i),u)}},ARRAYTOTEXT:function(t,r){return r?\"{\"+t.map((function(t){return\"string\"==typeof t?'\"'+t+'\"':t})).join(\"; \")+\"}\":t.join(\"; \")}});function Xt(t){return void 0===t?null:t}function Ht(t,r,e,n){void 0===e&&(e=0);var o=-1;if(0===e)o=r.indexOf(t);else{var i=\"string\"==typeof t?\"\":-1/0*e;1===e?r.forEach((function(r,e){r<=t&&r>i&&(i=r,o=e)})):-1===e&&r.forEach((function(r,e){r>=t&&r<i&&(i=r,o=e)}))}return o+1}var Bt={LOOKUP:function(t,r,e){var n=Ht(t,r,1);if(0===n)throw\"#N/A\";return(e||r)[n-1]},HLOOKUP:function(t,r,e,n){var o=!0;void 0!==n&&(o=V(n));var i=r.$width?r.$width:r.length,a=Ht(t,r.slice(0,i),o?1:0);if(0===a)throw\"#N/A\";return Xt(r[i*((e||1)-1)+a-1])},VLOOKUP:function(t,r,e,n){var o=!0;void 0!==n&&(o=V(n));var i,a=r.$width?r.$width:1,u=r.length/a;if(1===u)i=r;else{i=[];for(var f=0;f<u;f++)i.push(r[a*f])}var s=e,h=Ht(t,i,o?1:0);if(0===h)throw\"#N/A\";return Xt(r[a*(h-1)+(s||1)-1])},XLOOKUP:function(t,r,e,n,o,i){var a=Ht(t,r,o);if(0===a){if(void 0!==n)return n;throw\"#N/A\"}return(e||r)[a-1]},INDEX:function(t,r,e){var n=r,o=e;return Xt(t[(t.$width?t.$width:1)*(n-1)+(o||1)-1])},MATCH:function(t,r,e){var n=e;void 0===e&&(n=1);var o=Ht(t,r,n);if(0===o)throw\"#N/A\";return o},XMATCH:function(t,r,e,n){var o=Ht(t,r,e);if(0===o)throw\"#N/A\";return o}},Yt=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],jt=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Gt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function zt(t,r){var e=X(t),n=X(r);if(e&&n)return Math.round((e.getTime()-n.getTime())/864e5)}function $t(t){var r=X(t);if(r){r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r.getTime()-e.getTime())/864e5+1)/7)}}function qt(t,r,e,n){var o=X(t),i=X(r);if(o&&i){for(var a=void 0===e?Gt[1]:Gt[e],u=n||[],f=0;f<u.length;f++){if((g=L(u[f]))instanceof Error)throw\"The \"+u[f]+\" is not a  number\";u[f]=g}var s=(i.getTime()-o.getTime())/864e5+1,h=Math.round(s),c=o;for(f=0;f<s;f++){var p=(new Date).getTimezoneOffset()>0?c.getUTCDay():c.getDay(),v=!1;p!==a[0]&&p!==a[1]||(v=!0);for(var l=0;l<u.length;l++){var g;if((g=u[l]).getDate()===c.getDate()&&g.getMonth()===c.getMonth()&&g.getFullYear()===c.getFullYear()){v=!0;break}}v&&h--,c.setDate(c.getDate()+1)}return h}}function Wt(t,r,e,n){var o=X(t),i=k(r);if(o&&\"number\"==typeof i){for(var a=void 0===e?Gt[1]:Gt[e],u=n||[],f=0;f<u.length;f++){if((p=L(u[f]))instanceof Error)throw\"The \"+u[f]+\" is not a  number\";u[f]=p}for(var s=0;s<i;){o.setDate(o.getDate()+1);var h=o.getDay();if(h!==a[0]&&h!==a[1]){for(var c=0;c<u.length;c++){var p;if((p=u[c]).getDate()===o.getDate()&&p.getMonth()===o.getMonth()&&p.getFullYear()===o.getFullYear()){s--;break}}s++}}return P(o)}}function Kt(t){return 1===new Date(t,1,29).getMonth()}function Qt(t,r,e){void 0===e&&(e=0);var n=X(t),o=X(r);if(n&&o){var i=n.getDate(),a=n.getMonth()+1,u=n.getFullYear(),f=o.getDate(),s=o.getMonth()+1,h=o.getFullYear(),c=365,p=h-u+1,v=(new Date(h+1,0,1).getTime()-new Date(u,0,1).getTime())/1e3/60/60/24/p;switch(e){case 0:return 31===i&&31===f?(i=30,f=30):31===i?i=30:30===i&&31===f&&(f=30),(f+30*s+360*h-(i+30*a+360*u))/360;case 1:return u===h||u+1===h&&(a>s||a===s&&i>=f)?((u===h&&Kt(u)||function(t,r){var e=t.getFullYear(),n=new Date(e,2,1);if(Kt(e)&&t<n&&r>=n)return!0;var o=r.getFullYear(),i=new Date(o,2,1);return Kt(o)&&r>=i&&t<i}(n,o)||1===s&&29===f)&&(c=366),zt(o.toDateString(),n.toDateString())/c):zt(o.toDateString(),n.toDateString())/v;case 2:return zt(o.toDateString(),n.toDateString())/360;case 3:return zt(o.toDateString(),n.toDateString())/365;case 4:return(f+30*s+360*h-(i+30*a+360*u))/360}}}var Jt={DATE:function(t,r,e){return P(new Date(t,r-1,e))},TIME:function(t,r,e){var n=P(new Date(1900,0,1,t,r,e,0));return n-Math.trunc(n)},DAY:function(t){return L(t).getDate()},MONTH:function(t){return L(t).getMonth()+1},YEAR:function(t){return L(t).getFullYear()},HOUR:function(t){return L(t).getHours()},MINUTE:function(t){return L(t).getMinutes()},SECOND:function(t){return L(t).getSeconds()},NOW:function(){return P(new Date)},DATEDIF:function(t,r,e){var n=e.toLowerCase();if(\"d\"===n)return r-t;var o=L(t),i=L(r);switch(n){case\"y\":return i.getFullYear()-o.getFullYear();case\"m\":return(u=12*(i.getFullYear()-o.getFullYear()))+i.getMonth()-o.getMonth();case\"d\":return Math.floor(r-t);case\"md\":if((f=i.getDate()-o.getDate())<0){var a=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();return i.getDate()+a-o.getDate()}return f;case\"ym\":var u;return(u=i.getMonth()-o.getMonth())<0?12+u:u;case\"yd\":var f;return(f=R(i)-R(o))<0?365+f:f}},DATEVALUE:function(t){if(\"string\"==typeof t)return P(new Date(new Date(t).toDateString()))},DAYS:zt,DAYS360:function(t,r,e){void 0===e&&(e=0);var n=X(t),o=X(r);if(n&&o){var i=n.getMonth(),a=o.getMonth(),u=void 0,f=void 0;if(V(e))u=31===n.getDate()?30:n.getDate(),f=31===o.getDate()?30:o.getDate();else{var s=new Date(n.getFullYear(),i+1,0).getDate(),h=new Date(o.getFullYear(),a+1,0).getDate();u=n.getDate()===s?30:n.getDate(),o.getDate()===h?u<30?(a++,f=1):f=30:f=o.getDate()}return 360*(o.getFullYear()-n.getFullYear())+30*(a-i)+(f-u)}},EDATE:function(t,r){var e=X(t),n=k(r);if(e&&\"number\"==typeof n)return e.setMonth(e.getMonth()+n),P(e)},EOMONTH:function(t,r){var e=X(t),n=k(r);if(e&&\"number\"==typeof n)return P(new Date(e.getFullYear(),e.getMonth()+n+1,0))},ISOWEEKNUM:$t,NETWORKDAYS:function(t,r,e){return qt(t,r,1,e)},\"NETWORKDAYS.INTL\":qt,TIMEVALUE:function(t){if(\"string\"==typeof t){var r=t.split(\" \"),e=r[1],n=r[0].split(\":\"),o=new Date;return o.setHours(+n[0]),e&&\"PM\"===e.toUpperCase()&&o.setHours(o.getHours()+12),o.setMinutes(+n[1]),n[2]&&o.setSeconds(+n[2]),(3600*o.getHours()+60*o.getMinutes()+o.getSeconds())/86400}},WEEKNUM:function(t,r){void 0===r&&(r=1);var e=X(t);if(21===r)return $t(r);var n=jt[r],o=new Date(e.getFullYear(),0,1),i=o.getDay()<n?1:0,a=o.getTime()-24*Math.abs(o.getDay()-n)*60*60*1e3;return Math.floor((e.getTime()-a)/864e5/7+1)+i},WEEKDAY:function(t,r){void 0===r&&(r=1);var e=X(t).getDay();return Yt[r][e]},WORKDAY:function(t,r,e){return Wt(t,r,1,e)},\"WORKDAY.INTL\":Wt,YEARFRAC:Qt};var Zt=Object.freeze({__proto__:null,IF:function(t,r,e){return t?r:e},AND:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0;e<t.length;e++)if(!V(t[e]))return!1;return!0},NOT:function(t){return!V(t)},OR:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0;e<t.length;e++)if(t[e])return!0;return!1},CHOOSE:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=k(t);if(r.length>1&&\"number\"==typeof n){if(r.length<n)throw\"the index number is greater than the length of the array of values\";if(n<=0)throw\"index cannot be less than or equal to 0\";return r[--n]}},FALSE:function(){return!1},TRUE:function(){return!0}});var tr=Object.freeze({__proto__:null,ISBLANK:function(t){return U(t)},ISBINARY:function(t){return/^[01]{1,10}$/.test(\"\"+t)},ISEVEN:function(t){var r=k(t);return\"number\"==typeof r&&r%2==0},ISODD:function(t){var r=k(t);return\"number\"==typeof r&&r%2!=0},ISNONTEXT:function(t){return\"string\"!=typeof t},ISNUMBER:function(t){return\"number\"==typeof k(t)},ISTEXT:function(t){return\"string\"==typeof t},N:function(t){var r=k(t);if(\"number\"==typeof r)return r;var e=new Date(t);return e.getTime()?P(e):\"TRUE\"===t||!0===t?1:0}});function rr(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i,a=H(t),u=H(r),f=H(e),s=H(n);if(0===a)i=(f+s)/u;else{var h=Math.pow(1+a,u);i=a*(f*h+s)/(h-1),1===o&&(i/=1+a)}return-i}function er(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i,a=H(t),u=H(r),f=H(e),s=H(n);if(0!==a){var h=Math.pow(1+a,u);return i=s*h+f*(h-1)/a,1===o&&(i=s*h+f*(1+a)*(h-1)/a),-i}i=s+f*u}function nr(t,r,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=0);var a=H(t),u=H(e),f=H(r),s=H(n),h=rr(a,u,s,H(o),i);return(1===f?1===i?0:-s:1===i?er(a,f-2,h,s,1)-h:er(a,f-1,h,s,0))*a}var or=Object.freeze({__proto__:null,ACCRINT:function(t,r,e,n,o,i,a){void 0===o&&(o=0),void 0===a&&(a=0);var u=X(t),f=X(e),s=H(n),h=H(o),c=H(i),p=H(a);if(1!==c)throw\"This function is only supported with frequency 1\";if(-1===[0,1,2,3,4].indexOf(p))throw\"Basis is \"+a+\". It's should be 0, 1, 2, 3 or 4\";if(f<=u)throw\"Settlement canot be before or equal to issue\";return h*s*Qt(t,e,p)},PMT:rr,FV:er,DB:function(t,r,e,n,o){void 0===o&&(o=12);var i=H(t),a=H(r),u=H(e),f=H(n),s=H(o);if(i<0||a<0||u<0||f<0)throw\"Parameters cannot be negative\";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s))throw\"Month is \"+o+\". It's should be beetwen 1 and 12\";if(f>u)throw\"Period cannot be greater than life\";if(a>=i)return 0;for(var h=+(1-Math.pow(a/i,1/u)).toFixed(3),c=i*h*s/12,p=c,v=0,l=n===u?u-1:n,g=2;g<=l;g++)p+=v=(i-p)*h;return 1===n?c:n===u?(i-p)*h:v},DDB:function(t,r,e,n,o){void 0===o&&(o=2);var i=H(t),a=H(r),u=H(e),f=H(n),s=H(o);if(i<0||a<0||u<0||f<0||s<0)throw\"Parameters cannot be negative\";if(f>u)throw\"Period cannot be greater than life\";if(a>=i)return 0;for(var h=0,c=0,p=1;p<=n;p++)h+=c=Math.min(s/u*(i-h),i-a-h);return c},DOLLAR:function(t,r){void 0===r&&(r=2);var e=k(t),n=k(r);if(\"number\"==typeof e&&\"number\"==typeof n){if(n>=0)return\"$\"+e.toFixed(n);var o=Math.pow(10,-n);return\"$\"+Math.trunc(e/o)*o}},DOLLARDE:function(t,r){var e=H(t),n=H(r);if(n<0)throw\"Fraction cannot be negative\";if(n>=0&&n<1)throw\"Fraction cannot be zero\";n=parseInt(\"\"+n,10);var o=parseInt(\"\"+t,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var i=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return o=Math.round(o*i)/i},DOLLARFR:function(t,r){var e=H(t),n=H(r);if(n<0)throw\"Fraction cannot be negative\";if(n>=0&&n<1)throw\"Fraction cannot be zero\";n=parseInt(\"\"+n,10);var o=parseInt(\"\"+t,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},EFFECT:function(t,r){var e=H(t),n=H(r);if(e<=0)throw\"Rate cannot be less than or equal to zero\";if(n<1)throw\"Periods cannot be less than 1\";return n=parseInt(\"\"+n,10),Math.pow(1+e/n,n)-1},FVSCHEDULE:function(t,r){for(var e=H(t),n=r.map((function(t){return H(t)})),o=n.length,i=e,a=0;a<o;a++)i*=1+n[a];return i},IRR:function(t,r){void 0===r&&(r=0);for(var e=F(t).map((function(t){return H(t)})),n=H(r),o=function(t,r,e){for(var n=e+1,o=t[0],i=1;i<t.length;i++)o+=t[i]/Math.pow(n,(r[i]-r[0])/365);return o},i=function(t,r,e){for(var n=e+1,o=0,i=1;i<t.length;i++){var a=(r[i]-r[0])/365;o-=a*t[i]/Math.pow(n,a+1)}return o},a=[],u=!1,f=!1,s=0;s<e.length;s++)a[s]=0===s?0:a[s-1]+365,e[s]>0&&(u=!0),e[s]<0&&(f=!0);if(!u||!f)throw\"Values should contain at least one positive value and one negative value\";var h,c,p,v=n=void 0===r?.1:n,l=!0;do{h=v-(p=o(e,a,v))/i(e,a,v),c=Math.abs(h-v),v=h,l=c>1e-10&&Math.abs(p)>1e-10}while(l);return v},IPMT:nr,ISPMT:function(t,r,e,n){var o=H(t),i=H(r),a=H(e);return H(n)*o*(i/a-1)},NPV:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=F(t).map((function(t){return H(t)})),n=H(e[0]),o=0,i=1;i<e.length;i++)o+=e[i]/Math.pow(1+n,i);return o},NOMINAL:function(t,r){var e=H(t),n=H(r);if(e<=0)throw\"Rate cannot be less then or equal to zero\";if(n<1)throw\"Periods cannot be less then 1\";return n=parseInt(\"\"+n,10),(Math.pow(e+1,1/n)-1)*n},NPER:function(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i=H(t),a=H(r),u=H(e),f=H(n),s=H(o),h=a*(1+i*s)-f*i,c=u*i+a*(1+i*s);return Math.log(h/c)/Math.log(1+i)},PDURATION:function(t,r,e){var n=H(t),o=H(r),i=H(e);if(n<=0)throw\"Rate cannot be less then or equal to zero\";return(Math.log(i)-Math.log(o))/Math.log(1+n)},PPMT:function(t,r,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=0);var a=H(t),u=H(r),f=H(e),s=H(n),h=H(o),c=H(i);return rr(a,f,s,h,c)-nr(a,u,f,s,h,c)},PV:function(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i=H(t),a=H(r),u=H(e),f=H(n),s=H(o);return 0===i?-u*a-f:((1-Math.pow(1+i,a))/i*u*(1+i*s)-f)/Math.pow(1+i,a)},SYD:function(t,r,e,n){var o=H(t),i=H(r),a=H(e);return(o-i)*(a-H(n)+1)*2/(a*(a+1))},TBILLPRICE:function(t,r,e){var n=X(t),o=X(r),i=H(e);if(\"number\"==typeof i&&o>n)return 100*(1-i*Math.round((o.getTime()-n.getTime())/864e5)/360)},TBILLYIELD:function(t,r,e){var n=X(t),o=X(r),i=H(e);if(\"number\"==typeof i&&o>n)return(100-i)/i*360/Math.round((o.getTime()-n.getTime())/864e5)}}),ir={number:Ft,string:Vt,date:Jt,other:Zt,information:tr,financial:or,lookup:Bt},ar=r(r(r(r(r(r(r({},Ft),Vt),Jt),Zt),tr),or),Bt);function ur(t,r,e,n,o,a){var u=i(t),f=u[0],s=u[1],h=u[2],c=i(n),p=c[0],v=c[1];return h===c[2]&&(!(f>=p+o)&&(!(f+r<=p)&&(!(s>=v+a)&&!(s+e<=v))))}var fr=Math.pow(10,8);function sr(t,r,e){e.add?t.has(r)||e.add(r):t.add(r)}function hr(t){if(t.keys)return Array.from(t.keys());var r=[];return t.forEach((function(t,e){return r.push(e)})),r}function cr(t){if(t.values)return t.values();var r=[];t.forEach((function(t,e){return r.push(e)}));var e=0;return{add:function(t){r.push(t)},next:function(){var t=r[e];return{done:++e>r.length,value:t}}}}var pr=function(){function t(t){var r=this;(t=t||{get:null,set:null,strict:!1})&&(this._getter=t.get,this._setter=t.set,this._strict=t.strict),this._parser=I,this._printer=A,this._parseContext={name:function(){},pageName:function(){return\"\"},pageObj:function(){return null},page:function(){return 0},z:0},this.$count=0,this._data=new Map,this._triggers=new Map,this._holders={},this._context={a:function(t,r,e){return t.$width=r,t.$height=e,t},v:function(t){if(-1===t)throw new Error;var e=r._getter(t);return void 0===e?null:e},r:function(t,e){var n=i(t),o=n[0],a=n[1],u=i(e),f=u[0]-o,s=u[1]-a+1,h=[];h.$width=s,h.$height=f+1;for(var c=0;c<=f;c++)for(var p=0;p<s;p++)h[c*s+p]=r._getter(t+64*p+4096*c*64);return h},m:ar,e:function(t){throw t},p:function(t){return r.getPlaceholder(t)}}}return t.prototype.getTriggerList=function(t){return this._triggers.get(t)},t.prototype.setValue=function(t,r,e,n){\"\"===r&&(r=null),this._removeTriggers(t,null),this._setter(t,r,e)&&(n||this.trigger(t))},t.prototype.clean=function(t){this._removeTriggers(t,null)},t.prototype.getValue=function(t){return this._getter(t)},t.prototype.getMeta=function(){return this._meta},t.prototype.setMeta=function(t){this._meta=r(r({},this._meta),t)},t.prototype.setPlaceholder=function(t,r){var e=this;\"*\"===t?Object.entries(r).forEach((function(t){return e.setPlaceholder(t[0],t[1])})):(null===r?delete this._holders[t]:this._holders[t]=r,this.each((function(r,n){(function(t,r,e){for(var n=0;n<t.length;n+=3)if(2===t[n]&&r.substr(t[n+1],t[n+2])==e)return!0;return!1})(n.code,n.source,t)&&e.setMath(r,n.source,e._parseContext)})))},t.prototype.getPlaceholder=function(t){if(\"*\"===t)return this._holders;var r=this._holders[t];return void 0===r?null:r},t.prototype.setMath=function(t,r,e,n){var o=this._generate(r,e),i=this._setMathAt(t,o);n||this._execAndTrigger(i)},t.prototype.refresh=function(t){this._execAndTrigger(t)},t.prototype.getMath=function(t){return this._data.get(t)},t.prototype.trigger=function(t,r){var e=this._triggers.get(t);if(e){var n=!r;r||(r=new Set);for(var o=0;o<e.length;o++)r.add(e[o]);n&&this.triggerSet(r)}return null},t.prototype.triggerSet=function(t){for(var r=this,e=new Map;t.size;){var n=cr(t),o=!1;t:for(var i=n.next();!i.done;i=n.next()){var a=this._data.get(i.value),u=e.get(i.value);if(!u||(1==u&&(u=this._check_for_loops(i.value,a.triggers,e)),2!=u)){var f=a.triggers;if(f)for(var s=0;s<f.length;s++)if(t.has(f[s]))continue t;this._execAndTrigger(i.value,t),u||e.set(i.value,1),t.delete(i.value),o=!0}}if(!o)return void t.forEach((function(e){return r._errorAndTrigger(e,t)}))}},t.prototype.getStats=function(){return{math:this._data.size,trigger:this._triggers.size}},t.prototype._check_for_loops=function(t,r,e){var n=new Set;r.forEach((function(t){return n.add(t)}));for(var o=cr(n),i=o.next();!i.done;i=o.next()){if(i.value==t)return e.set(t,2),2;var a=e.get(i.value);if(a&&a>1)return e.set(t,a),a;var u=this._data.get(i.value);u&&u.triggers&&u.triggers.forEach((function(t){return sr(n,t,o)}))}return e.set(t,3),3},t.prototype._setMathAt=function(t,e){if(this._removeTriggers(t,e)){if(e.triggers)if(-1===e.triggers.indexOf(t)&&3!==e.broken)for(var n=0;n<e.triggers.length;n++){var o=e.triggers[n],i=this._triggers.get(o);void 0===i&&(i=[],this._triggers.set(o,i)),i.push(t)}else e=r(r({},e),{broken:3});return this._data.set(t,e),t}},t.prototype._removeTriggers=function(t,r){var e=this._data.get(t);if(!e)return!0;if(e===r)return!1;e.$width&&this._clearArea(t,!1);var n=e.triggers;if(n&&3!==e.broken)for(var o=0;o<n.length;o++){var i=n[o],a=this._triggers.get(i);if(a){var u=a.filter((function(r){return r!==t}));u.length?this._triggers.set(i,u):this._triggers.delete(i)}}return this._data.delete(t),!0},t.prototype.parse=function(t,r){return this._parser(t,r||this._parseContext)},t.prototype.exec=function(t,r){var e=this._generate(t,r);return this._exec(e)},t.prototype.each=function(t){var r=this;hr(this._data).forEach((function(e){return t(e,r._data.get(e))}))},t.prototype.setLogger=function(t){this._err_handler=t},t.prototype._setErr=function(t,r){return t.broken=2,r&&this._err_handler&&this._err_handler(r),n[t.broken]},t.prototype._exec=function(t){if(t.broken>0&&2!==t.broken)return n[t.broken];try{var r=t.exec(this._context);return t.broken=0,\"number\"==typeof r?isFinite(r)?Math.round(r*fr)/fr:this._setErr(t):r}catch(r){return this._setErr(t,r)}},t.prototype.toString=function(t,r){return c(t,r||this._parseContext)},t.prototype.regenerate=function(t,e,n){var o=this;n=r({},n||this._parseContext),hr(this._data).forEach((function(r){var i=!1,a=o._data.get(r),u=f(r);if(e&&u===t)o._removeTriggers(r,null);else{for(var s=0;s<a.code.length;s+=3)if(9===a.code[s]&&f(a.code[s+1])===t){i=!0;break}i&&(n.z=u,e?o.setMath(r,a.source,n):(a.source=c(a,n),a.code=o._parser(a.source,n).code))}}))},t.prototype.recalculate=function(t,e){var n=this;e=r({},e||this._parseContext);var o=new Set;this.each((function(r){if(t){var i=n._data.get(r);if(i.broken&&2!==i.broken)return e.z=f(r),void n.setMath(r,i.source,e)}o.add(r)})),this.triggerSet(o)},t.prototype._generate=function(t,r,e){var n=e||this._parser(t,r||this._parseContext);return this._printer(n,this._strict),n.triggers=function(t){for(var r=[],e=t.code,n=e.length,o=0;o<n;o+=3){switch(e[o]){case 7:case 6:var i=e[o+4];r.push(i);break;case 8:s(e[o+4],e[o+7],(function(t){return r.push(t)}))}}if(r.length>10){var a=new Set;r=r.filter((function(t){return!a.has(t)&&(a.add(t),!0)}))}return r.length?r:null}(n),n},t.prototype._execAndTrigger=function(t,r){this.$count+=1;var e=this._data.get(t);if(e){var n=this._exec(e);if(Array.isArray(n))if(63!==f(t))return void this._complexSetter(t,n,r);this._setter(t,n,2)&&this.trigger(t,r)}},t.prototype._complexSetter=function(t,r,e){var n=this,o=r.$width,i=r.$height,a=this._data.get(t);a.$width=o,a.$height=i;try{h(t,o,i,(function(o,i){n._setter(o,r[i],2,0===i?null:t)&&n.trigger(o,e)}))}catch(r){this._clearArea(t,!0)}},t.prototype._clearArea=function(t,r){var e=this,o=this._data.get(t),i=o.$width,a=o.$height;h(t,i,a,(function(o,i){0===i&&r?e._setter(o,n[4],1)&&e.trigger(o):(r?e._setter(o,null,3,t):e._setter(o,null,3,-1))&&e.trigger(o)}))},t.prototype._errorAndTrigger=function(t,r){var e=this._data.get(t),n=this._setErr(e);this._setter(t,n,2)&&this.trigger(t,r)},t.prototype.debug=function(t,r){void 0===r&&(r=!1);var e=function(t){for(var r=t.code,e=t.source,n=\"\",o=r.length,i=0;i<o;i+=3){var a=r[i],u=void 0;switch(a){case 4:u=\"method\";break;case 1:u=\"text\";break;case 5:u=\"page\";break;case 2:u=\"holder\";break;case 6:u=\"name\";break;case 7:u=\"arg\";break;case 8:u=\"range\";break;case 9:u=\"data\";break;case 10:u=\"op\";break;case 11:u=\"number\";break;case 3:u=\"error\";break;case 12:u=\"extra\";break;case 13:u=\"arr\"}n+=9===a?\"            \"+r[i+1]+\".\"+r[i+2]+\"\\n\":13===a?\"[\"+u+\"]\"+T(u)+r[i+1]+\" x \"+r[i+2]+\"\\n\":\"[\"+u+\"]\"+T(u)+e.substr(r[i+1],r[i+2])+\"\\n\"}return n}(this.parse(t));if(r)return e;console.log(e)},t.prototype.transpose=function(t,e,n,a){var u=this;a=a||this._parseContext;var f=i(t),s=f[0],h=f[1],c=f[2],p=new Map,v=new Map,l=new Set;hr(this._data).forEach((function(t){var f=i(t),g=f[0],d=f[1],_=f[2],y=u._data.get(t),M=_===a.z?a:r(r({},a),{z:_}),b=u._transpose(y,s,h,e,n,a,M),m=t;if(_===c&&(d>=h||g>=s)&&(m=o(g>=s?g+e:g,d>=h?d+n:d,_)),y!==b||t!==m){if(v.set(t,b),_===c&&(n<0&&d>=h&&d<h-n||e<0&&g>=s&&g<s-e))return;p.set(m,b),y.broken!==b.broken&&l.add(m)}})),hr(p).forEach((function(t){return u._setMathAt(t,p.get(t))})),Array.from(v.keys()).forEach((function(t){p.has(t)||u._removeTriggers(t,null)})),e>0&&this._triggerRow(s,e,l),n>0&&this._triggerColumn(h,n,l),e<0&&this._triggerColumn(s-1,2,l),n<0&&this._triggerColumn(h-1,2,l),this.triggerSet(l)},t.prototype._triggerColumn=function(t,r,e){var n=this,o=r?t+r:t;hr(this._triggers).forEach((function(r){var i=u(r);i>=t&&i<o&&n.trigger(r,e)}))},t.prototype._triggerRow=function(t,r,e){var n=this,o=r?t+r:t;hr(this._triggers).forEach((function(r){var i=a(r);i>=t&&i<o&&n.trigger(r,e)}))},t.prototype.moveMath=function(t,r,e,n,o,i,a){return\"string\"==typeof t&&(t=this.parse(t,i)),this._moveMath(t,r,e,n,o,a||i).source},t.prototype._moveMath=function(t,r,e,n,a,u){for(var f=t.code,s=0;s<f.length;s+=3)if(7===f[s]){var h=i(f[s+4]),p=h[0],v=h[1];ur(a.id,a.h,a.w,f[s+4],1,1)&&(p+=r,v+=e,f[s+4]=o(p,v,n)),s+=3}else if(8===f[s]){var l=i(f[s+4]),g=l[0],d=l[1],_=i(f[s+7]),y=_[0],M=_[1];ur(a.id,a.h,a.w,f[s+4],y-g+1,M-d+1)&&(g+=r,d+=e,y+=r,M+=e,f[s+4]=o(g,d,n),f[s+7]=o(y,M,n)),s+=6}var b={code:f,broken:t.broken,source:t.source,triggers:null,exec:null};return b=this._parser(c(b,u),u),this._generate(b.source,u,b)},t.prototype.transposeMath=function(t,r,e,n){return\"string\"==typeof t&&(t=this.parse(t,n)),n=n||this._parseContext,this._transpose(t,-1,-1,r,e,n,n).source},t.prototype._transpose=function(t,r,e,n,a,u,f){for(var s=!0,h=t.code,p=!(r<0||e<0),v=0;v<h.length;v+=3)if(7===h[v]){var l=i(h[v+4]),g=l[0],d=l[1],_=l[2];if(u.z!==_)continue;var y=h[v+5];if(!p&&3==y)continue;(p||0==(1&y))&&0!==n&&g>=r&&(s&&(h=[].concat(h),s=!1),((g+=n)<r||g<0)&&(h[v]=3)),(p||0==(2&y))&&0!==a&&d>=e&&(s&&(h=[].concat(h),s=!1),((d+=a)<e||d<0)&&(h[v]=3)),s||(h[v+4]=o(g,d,_)),v+=3}else if(8===h[v]){var M=h[v+5],b=h[v+8];if(!p&&3===M&&3===b)continue;var m=i(h[v+4]),w=m[0],E=m[1],C=(_=m[2],i(h[v+7])),I=C[0],T=C[1];if(u.z!==_)continue;0!==n&&((p||0==(1&M))&&(n>0?w>=r:w>r)&&(s&&(h=[].concat(h),s=!1),(w+=n)<0&&(h[v]=3)),(p||0==(1&b))&&I>=r&&(s&&(h=[].concat(h),s=!1),(I+=n)<w&&(h[v]=3))),0!==a&&((p||0==(2&M))&&(a>0?E>=e:E>e)&&(s&&(h=[].concat(h),s=!1),(E+=a)<0&&(h[v]=3)),(p||0==(2&b))&&T>=e&&(s&&(h=[].concat(h),s=!1),(T+=a)<E&&(h[v]=3))),s||(h[v+4]=o(w,E,_),h[v+7]=o(I,T,_)),v+=6}if(s)return t;var D={code:h,broken:t.broken,source:t.source,triggers:null,exec:null};return D=this._parser(c(D,f),f),this._generate(D.source,f,D)},t}();var vr=function(){function t(t,e,n){this._id=t,this._store=e,this._meta={},this._parseContext=r(r({},n),{z:t}),this.reset(),this._parseMode=!1}return t.prototype.reset=function(){this._data=[],this._rows=[],this._cols=[],this._spans=[]},t.prototype.getMeta=function(){return this._meta},t.prototype.setMeta=function(t){this._meta=r(r({},this._meta),t)},t.prototype.getID=function(){return this._id},t.prototype.cellID=function(t,r){return o(t,r,this._id)},t.prototype.getSize=function(){var t=this._data.length,r=0;return this._data.forEach((function(t){t&&t.length>r&&(r=t.length)})),[t,r]},t.prototype.getContext=function(){return this._parseContext},t.prototype.addRow=function(t,r){this._data.splice.apply(this._data,lr(t,r)),this._store.transpose(o(t,0,this._id),r,0,this._parseContext),this._rows.splice.apply(this._rows,lr(t,r)),this._recalculateSpans(t,r,0)},t.prototype.removeRow=function(t,r){return this._data.splice(t,r),this._store.transpose(o(t,0,this._id),-r,0,this._parseContext),this._rows.splice(t,r),this._recalculateSpans(t,-r,0)},t.prototype.addColumn=function(t,r){var e=lr(t,r);this._data.forEach((function(t){t&&t.splice.apply(t,e)})),this._store.transpose(o(0,t,this._id),0,r,this._parseContext),this._cols.splice.apply(this._cols,lr(t,r)),this._recalculateSpans(t,0,r)},t.prototype.removeColumn=function(t,r){this._data.forEach((function(e){e&&e.splice(t,r)})),this._store.transpose(o(0,t,this._id),0,-r,this._parseContext),this._cols.splice(t,r),this._recalculateSpans(t,0,-r)},t.prototype.setCell=function(t,e,n){var o=this._data[t];o||(o=this._data[t]=[]);var i=o[e];o[e]=i?r(r(r({},i),n),{value:i.value}):n,void 0!==n.value&&this.setValue(t,e,n.value)},t.prototype.clearCell=function(t,r){var e=this._data[t];e&&e[r]&&(e[r]=null,this._store.setValue(o(t,r,this._id),\"\"))},t.prototype.setValue=function(t,r,e,n){var i=o(t,r,this._id);\"string\"==typeof e&&e.length>1&&\"=\"===e[0]?this._store.setMath(i,e.substr(1),this._parseContext):this._store.setValue(i,e,n)},t.prototype.getCell=function(t,r,e){var n=this._data[t],o=n?n[r]:null;return o||!e||(n||(n=this._data[t]=[]),(o=n[r])||(o=n[r]={value:null})),o},t.prototype.getValue=function(t,r,e){if(e){var n=this._store.getMath(o(t,r,this._id));if(n)return\"=\"+n.source}var i=this.getCell(t,r,!1);return i?i.value:null},t.prototype.getRange=function(t,r,e,n){for(var o=[],i=t;i<=e;i++)for(var a=r;a<=n;a++)o.push(this.getValue(i,a,!1));return o},t.prototype.getCellRange=function(t,r,e,n){for(var o=[],i=t;i<=e;i++)for(var a=r;a<=n;a++)o.push(this.getCell(i,a));return o},t.prototype.eachCell=function(t){this._data.forEach((function(r,e){r&&r.forEach((function(r,n){r&&t(e,n,r)}))}))},t.prototype.serialize=function(t){var e=this,n=[];return this.eachCell((function(i,a,u){if(u=r({},u),t){var f=e._store.getMath(o(i,a,e.getID()));f&&(u.value=\"=\"+f.source)}n.push([i,a,u])})),n},t.prototype.parse=function(t,r){var e=this;this.reset(),this._store.each((function(t){f(t)===e._id&&e._store.clean(t)})),this.parseBlock(t,r,!0)},t.prototype.parseBlock=function(t,e,n){var i=this,a=new Set;this._parseMode=!0,t.forEach((function(t){var u=t[0],f=t[1],s=t[2],h=o(u,f,i._id);n||i._store.clean(h);var c=i._data[u];c||(c=i._data[u]=[]);var p=(s=c[f]=r({},s)).value;if(p)if(\"string\"==typeof p&&p.length>1&&\"=\"===p[0]){var v=p.substr(1);i._store.setMath(h,v,i.getContext(),!0),a.add(h)}else e&&(s.value=null,i._store.setValue(h,p,null,!0),i._store.trigger(h,a))})),this._store.triggerSet(a),this._parseMode=!1},t.prototype.throwError=function(t){if(!this._parseMode)throw t},t.prototype.setRowMeta=function(t,e){var n=this._rows[t]||{};this._rows[t]=n?r(r({},n),e):e},t.prototype.getRowMeta=function(t,r){var e=this._rows[t];if(r&&!e){var n={};return this._rows[t]=n,n}return e||null},t.prototype.setColumnMeta=function(t,e){var n=this._cols[t]||{};this._cols[t]=n?r(r({},n),e):e},t.prototype.getColumnMeta=function(t,r){var e=this._cols[t];if(r&&!e){var n={};return this._cols[t]=n,n}return e||null},t.prototype.sort=function(t,r,e,n){void 0===e&&(e=0),void 0===n&&(n=\"asc\");for(var o=i(t),a=o[0],u=o[1],f=i(r),s=f[0],h=f[1],c=\"asc\"===n,p=[],v=[],l=a;l<=s;l++){for(var g=[],d=u;d<=h;d++){var _=this._store.getMath(this.cellID(l,d));g.push({value:this.getValue(l,d),row:l,math:_||null})}p.push(g)}p.sort((function(t,r){var n=t[e].value,o=r[e].value;return\"string\"==typeof n&&\"string\"==typeof o||\"number\"==typeof n&&\"number\"==typeof o?n<o?c?-1:1:n>o?c?1:-1:0:\"number\"==typeof n?-1:1}));for(l=a;l<=s;l++)for(d=u;d<=h;d++){var y=p[l-a][d-u];if(y.math){var M=y.row-l,b=this._store.transposeMath(y.math,-M,0,this._parseContext);y.value=\"=\"+b}v.push([l,d,{value:y.value}])}this.parseBlock(v)},t.prototype.addSpan=function(t,r,e){var n;if(r>1||e>1){for(var o=0;o<=this._spans.length-1;o++){var i=this._spans[o];ur(t,r,e,i.id,i.info.width,i.info.height)&&this._spans.splice(o,1)}this._spans.push({id:t,info:{width:r,height:e}})}else-1!==(n=this._spans.findIndex((function(r){return r.id===t})))&&this._spans.splice(n,1)},t.prototype.getSpan=function(t){return this._spans.find((function(r){return r.id===t}))||null},t.prototype.getSpans=function(){return this._spans},t.prototype._recalculateSpans=function(t,r,e){var n,a;if(this._spans.length)for(var u=this._spans.length-1;u>=0;u--){var f=this._spans[u],s=f.info,h=s.height,c=s.width,p=i(f.id),v=p[0],l=p[1];r&&(v=(n=this._adjustSpan(v,h,t,r))[0],h=n[1]),e&&(l=(a=this._adjustSpan(l,c,t,e))[0],c=a[1]),c<1||h<1||c+h<=2?this._spans.splice(u,1):(f.id=o(v,l,this._id),f.info.height=h,f.info.width=c)}},t.prototype._adjustSpan=function(t,r,e,n){var o=t+r;if(n<0){var i=e+(n=-n);e>t?e<=o&&(r-=Math.min(n,t+r-e)):i>t?(r-=i-t,t=n-(i-t)):t-=n}else e<=t?t+=n:e<=o&&(r+=n);return[t,r]},t}();function lr(t,r){for(var e=[t,0],n=0;n<r;n++)e.push(null);return e}var gr=function(){function t(t,r,e){this._ranges=new Map,this._counter=1,this._rangeOrder=[],this._store=t,this._page=r,this._pageGetter=e}return t.prototype.get=function(t){return this._store.getMath(this._ranges.get(t))},t.prototype.toId=function(t){return this._ranges.get(t)},t.prototype.add=function(t,r){var e=this._ranges.get(t)||this._next_id();this._store.setMath(e,r,this._page.getContext()),this._ranges.set(t,e),this._refresh(t)},t.prototype.remove=function(t){this._ranges.delete(t),this._counter=1,this._refresh(t)},t.prototype.serialize=function(){var t=this;return Array.from(this._ranges.keys()).map((function(r){return[r,t.get(r).source]}))},t.prototype.parse=function(t){var r=this;t.forEach((function(t){return r.add(t[0],t[1])}))},t.prototype._refresh=function(t){var r=this,e=t.indexOf(\"!\"),n=\"\";-1!==e&&(n=t.substr(0,e),t=t.substr(e+1)),this._store.each((function(e,o){if(function(t,r,e,n){for(var o=0;o<t.length;o+=3)if(6===t[o]){if(\"\"!==e){if(5===t[o-3]&&r.substr(t[o-2],t[o-1])!==e)continue;return!0}if(r.substr(t[o+1],t[o+2])===n)return!0}return!1}(o.code,o.source,n,t)){var i=f(e);r._store.setMath(e,o.source,r._pageGetter(i).getContext())}}))},t.prototype._next_id=function(){for(;this._rangeOrder[this._counter];)this._counter++;return this._rangeOrder[this._counter]=!0,o(this._counter,0,this._page.getID())},t.prototype.renamePage=function(t,r){var e=this;t+=\"!\",r&&(r+=\"!\"),this._ranges.forEach((function(n,o,i){0===o.indexOf(t)&&(r?i.set(o.replace(t,r),n):e._store.clean(n),i.delete(o))}))},t}();var dr=function(){function t(t,r){this._store=t,this._pageGetter=r}return t.prototype.copy=function(t,r){r||(r=t);var e=this._serialize(t,r);return this._store.setMeta({$clipboard:e}),e},t.prototype.paste=function(t,r,e,n,o){var a;if(void 0===o&&(o=this._updateCurrentCell),n=n||0,null===(a=e=e||this._store.getMeta().$clipboard)||void 0===a?void 0:a.data.length){var u=i(t),f=u[0],s=u[1],h=u[2],c=i(r),p=c[0],v=c[1],l=this._pageGetter(h),g=i(e.from||0),d=g[0],_=g[1],y=e.data,M=[],b=f-d,m=s-_;if(0===n)for(var w=y[0].length-1,E=0;E<=y.length-1;E++)for(var C=0;C<=w;C++){var I=y[E][C],T=f+E,D=s+C;(A=this._updateCell(T,D,h,I,b,m,o))&&M.push(A)}if(1===n)for(E=f;E<=p;E++)for(C=s;C<=v;C++){D=C-s,I=y[T=E-f][D];(A=this._updateCell(E,C,h,I,b,m,o))&&M.push(A)}if(2===n)for(T=0,E=f;E<=p;E++){D=0;T===y.length&&(T=0);for(C=s;C<=v;C++){D===y[0].length&&(D=0);I=y[T][D];var A,N=E-(d+T),S=C-(_+D);(A=this._updateCell(E,C,h,I,N,S,o))&&M.push(A),D++}T++}l.parseBlock(M)}},t.prototype.clean=function(t,e,n){n=n||255;for(var a=i(t),u=a[0],f=a[1],s=a[2],h=i(e),c=h[0],p=h[1],v=this._pageGetter(s),l=[],g=[],d=u;d<=c;d++)for(var _=f;_<=p;_++){var y=v.getCell(d,_),M=o(d,_,s),b=255===n?{}:r({},y);if(1&n){var m=this._store.getTriggerList(M);m&&g.push.apply(g,m),delete b.value}l.push([d,_,b])}v.parseBlock(l),this._refreshRelatedFormulas(g)},t.prototype._refreshRelatedFormulas=function(t){var r=this;_r(t).forEach((function(t){return r._store.refresh(t)}))},t.prototype._serialize=function(t,e){for(var n=i(t),a=n[0],u=n[1],f=n[2],s=i(e),h=s[0],c=s[1],p=this._pageGetter(f),v={from:t,data:[]},l=a;l<=h;l++){for(var g=[],d=u;d<=c;d++){var _=p.getCell(l,d),y=this._store.getMath(o(l,d,f)),M=void 0;y&&(M=y.source);var b=[_?r({},_):null];M&&b.push(M),g.push(b)}v.data.push(g)}return v},t.prototype.reset=function(){this._store.setMeta({$clipboard:null})},t.prototype.move=function(t,r){for(var e=r||this._store.getMeta().$clipboard,n=e.data,a=e.from,u=i(a),f=u[0],s=u[1],h=u[2],c=n.length,p=n[0].length,v=i(t),l=v[0],g=v[1],d=v[2],_=[],y=[],M=this._pageGetter(d),b={id:a,h:c,w:p},m=0;m<c;m++)for(var w=0;w<p;w++){var E=n[m][w],C=E[0],I=E[1],T=o(f+m,s+w,h),D=this._store.getTriggerList(T);if(D){var A=this._getTriggersOutsideCutRange(D,a,c,p);A.length&&_.push.apply(_,A)}var N=l+m,S=g+w;if(C){if(I){var x=this._pageGetter(h).getContext(),O=this._store.moveMath(I,l-f,g-s,d,b,x,M.getContext());C.value=\"=\"+O}y.push([N,S,C])}else y.push([N,S,{}])}M.parseBlock(y),this._updateRelatedFormulas(_,l-f,g-s,d,b)},t.prototype._updateRelatedFormulas=function(t,r,e,n,o){var a=this;_r(t).forEach((function(t){var u=i(t)[2],f=a._store.getMath(t),s=a._pageGetter(u).getContext(),h=a._store.moveMath(f,r,e,n,o,s);a._store.setMath(t,h,s)}))},t.prototype._getTriggersOutsideCutRange=function(t,r,e,n){var o=[];return t.forEach((function(t){ur(r,e,n,t,1,1)||o.push(t)})),o},t.prototype._updateCell=function(t,e,n,o,i,a,u){var f=o[0],s=o[1],h=this._pageGetter(n),c=f?r({},f):{value:null};c.formula=s?\"=\"+this._store.transposeMath(s,i,a):null;var p=u(h.getCell(t,e)||{},c);return p?[t,e,p]:null},t.prototype._updateCurrentCell=function(t,r){return r.formula&&(r.value=r.formula),r},t.prototype.fromCSV=function(t,r,e){return void 0===r&&(r=\"\\n\"),void 0===e&&(e=\"\\t\"),{data:t.split(r).map((function(t){return t.split(e).map((function(t){return[{value:t}]}))}))}},t}();function _r(t){var r=new Set(t);return Array.from(r)}var yr=function(){function t(t){var e=this;this._cfg=t||{strict:!1},this._pages=[],this._pageNames=[],this._pageName2ID=new Map,this._pCounter=0,this._parseContext={page:function(t){return e._pageName2ID.get(t)},pageName:function(t){return e._pageNames[t]},pageObj:function(t){return e._pages[t]},name:function(t,r,n){var o,i=t.length,a=r.substr(t[i-2],t[i-1]);if(5===t[i-6]){var u=r.substr(t[i-5],t[i-4]);o=e._ranges.toId(u+\"!\"+a)||e._ranges.toId(a)}else o=e._ranges.toId(n.pageName(n.z)+\"!\"+a)||e._ranges.toId(a);t.push(9,o||-1,0)},z:0};var n=this._store=new pr(r(r({},this._cfg),{get:function(t){var r=i(t),n=r[0],o=r[1],a=r[2];return e._pages[a].getValue(n,o)},set:function(t,r,o,a){var u=i(t),f=u[0],s=u[1],h=u[2],c=e._pages[h].getCell(f,s,!0),p=a?null:\"number\"==typeof c.spill?c.spill:r||0===r?c.source:null;if(3===o){if(a>=0&&(c.spill=a,c.source!==a))return!1;c.source=a=null}else if(null===r&&!a&&c.source)return!1;a&&(t!==a&&c.source!==a&&(c.value||0===c.value||\"number\"==typeof c.source&&c.source!==a)&&e._pages[h].throwError(\"spill error\"));c.source!==a&&(c.source=a);var v=2===o||3===o;if((null==o||v)&&(o=c.$format||0),c.$format=o,\"string\"==typeof r&&1!=o&&r){var l=parseFloat(r);v&&(l=l.toString()),l==r&&(r=parseFloat(r))}var g=c.value!==r;return g&&(c.value=r),\"number\"==typeof p&&n.triggerSet(new Set([p])),g}})),o=this._pages[63]=new vr(63,this._store,this._parseContext);this._ranges=new gr(this._store,o,this.getPage.bind(this)),this._cm=new dr(this._store,this.getPage.bind(this))}return t.prototype.addPage=function(t){for(;this._pages[this._pCounter];)this._pCounter++;var r=this._pCounter,e=new vr(r,this._store,this._parseContext);return this._pageName2ID.set(t,r),this._pages[r]=e,this._pageNames[r]=t,e},t.prototype.renamePage=function(t,r){if(t!==r){var e=this._pageName2ID.get(t);this._pageName2ID.delete(t),this._pageName2ID.set(r,e),this._pageNames[e]=r,this._ranges.renamePage(t,r);var n=this._pages[e].getContext();this._store.regenerate(e,!1,n)}},t.prototype.removePage=function(t){var r=this._pageName2ID.get(t),e=this._pages[r].getContext();this._pageName2ID.delete(t),this._pages[r]=this._pageNames[r]=null,this._pCounter=0,this._ranges.renamePage(t,null),this._store.regenerate(r,!0,e)},t.prototype.getPage=function(t){return\"string\"==typeof t&&(t=this._pageName2ID.get(t)),this._pages[t]},t.prototype.getRanges=function(){return this._ranges},t.prototype.getStore=function(){return this._store},t.prototype.find=function(t,r){var e=r.firstOnly,n=r.resultsLimit,i=void 0===n?100:n,a=[];return this._pages.forEach((function(r,n){r.eachCell((function(r,u,f){var s=f.value;t(s)&&(e&&0===a.length||!e&&a.length<i)&&a.push({id:o(r,u,n),value:s})}))})),a},t.prototype.getCopyManager=function(){return this._cm},t}();exports.CLEAN_MODE_ALL=255,exports.CLEAN_MODE_DATA=1,exports.D_COMMON=0,exports.D_STRING=1,exports.DataPage=vr,exports.DataStore=yr,exports.PASTE_MODE_OVERLAP=0,exports.PASTE_MODE_RANGE=1,exports.PASTE_MODE_REPEAT=2,exports.Store=pr,exports.T_ARG=7,exports.T_DATA=9,exports.T_ERROR=3,exports.T_METHOD=4,exports.T_NAME=6,exports.T_NUMBER=11,exports.T_OPERATOR=10,exports.T_PAGE=5,exports.T_PLACEHOLDER=2,exports.T_RANGE=8,exports.T_SPACE=12,exports.T_TEXT=1,exports.addMethod=function(t,r){ar[t]=r},exports.column=u,exports.fromId=i,exports.methodGroups=ir,exports.methods=ar,exports.page=f,exports.row=a,exports.str2id=function(t){var r=[];return C(r,t,0),r[1]},exports.str2pos=function(t){var r=[];return C(r,t,0),i(r[1]).slice(0,2)},exports.str2range=function(t){var r=[];t.split(\":\").map((function(t){return C(r,t,0)}));var e=i(r[1]),n=e[0],o=e[1],a=i(r[4]);return[n,o,a[0],a[1]]},exports.toId=o;\n//# sourceMappingURL=muon.js.map\n","import {addMethod} from \"@xbs/muon\";\n\nexport function init(view){\n\tconst math = {\n\t\tIMAGE: url => `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`,\n\t\tHYPERLINK: (url, text) => {\n\t\t\tconst escape = webix.template.escape;\n\t\t\tlet attrs;\n\n\t\t\tif(url[0] == \"#\")\n\t\t\t\tattrs = `href=\"javascript:void(0);\" class=\"webix_ssheet_ref\" data-ref=\"${escape(url.substr(1))}\"`;\n\t\t\telse\n\t\t\t\tattrs = `target=\"blank\" href=\"${escape(url)}\"`;\n\n\t\t\treturn `<a ${attrs}>${escape(text || url)}</a>`;\n\t\t},\n\t\tSPARKLINE: (arr, type, color1, color2) => {\n\t\t\tconst config = { type, color: color1, negativeColor:color2, paddingX:2, paddingY:2 };\n\n\t\t\tif(type == \"donut\")\n\t\t\t\twebix.extend(config, {type:\"pie\", donut:1}, true);\n\t\t\telse if(type == \"barH\")\n\t\t\t\twebix.extend(config, {type:\"bar\", horizontal:1}, true);\n\n\t\t\tfor(let i = 0 ; i < arr.length; i++)\n\t\t\t\tarr[i] = arr[i]||0;\n\n\t\t\tconst tableConfig = view.$$(\"cells\").config;\n\n\t\t\t//[FIXME] we do not know from which cell the method was called, so this is not the real width and height\n\t\t\tconst isCircle = config.type == \"pie\" || type == \"radar\";\n\t\t\tconst width = isCircle ? 100 : tableConfig.columnWidth;\n\t\t\tconst height = isCircle ? 100 : tableConfig.rowHeight;\n\t\t\treturn webix.Sparklines.getTemplate(config)(arr, { width, height });\n\t\t}\n\t};\n\n\tconst keys = Object.keys(math);\n\tkeys.forEach((key, i) => addMath(view, key, math[key], i == keys.length - 1));\n}\n\nexport function addMath(view, name, handler, sort){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(view.$$(\"liveEditor\")){\n\t\t[\n\t\t\twebix.$$(view.$$(\"liveEditor\").config.suggest).getList(),\n\t\t\twebix.$$(view.$$(\"formulaButton\").config.popup).getBody()\n\t\t].forEach(list => {\n\t\t\tif(!list.exists(name)){\n\t\t\t\tlist.add({id:name, value:name});\n\t\t\t\tif(sort)\n\t\t\t\t\tlist.sort(\"value\", \"asc\", \"string\");\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t\tthis.config.close = true;\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpadding: webix.skin.$active.layoutPadding.form,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, hotkey: \"enter\", autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tif(webix.isUndefined(value.padding))\n\t\t\t\tvalue.padding = webix.skin.$active.layoutPadding.form;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tmove:true,\n\t\thead: \"Dialog\",\n\t\tbuttons: true,\n\t\tclose:true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-suggest-labels\",\n\tdefaults:{\n\t\tfitMaster:false,\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t},\n\tgetItemText: function(id){\n\t\treturn this.getList().getItem(id).value;\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t}\n\t\t}\n\t}\n}, webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onSheetStateChange\", type:\"state\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName, _, page){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse{\n\t\t\t\tlet activeSheet = view.getActiveSheet();\n\t\t\t\tif(handler.name == \"onCellChange\" && page != activeSheet)\n\t\t\t\t\tactiveSheet = page;\n\t\t\t\tparams = [\"update\", activeSheet];\n\t\t\t}\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nfunction indexToHeader(index){\n\tconst chars = alpha.length;\n\tconst quotient = Math.floor(--index / chars);\n\tif (quotient > 0)\n\t\treturn indexToHeader(quotient) + alpha[index % chars];\n\n\treturn alpha[index % chars];\n}\n\nexport function updateMaxColumn(maxColumn){\n\tconst lastColumn = Object.keys(encode).length;\n\n\tfor(let i = lastColumn + 1; i <= maxColumn; i++){\n\t\tlet str = indexToHeader(i);\n\n\t\tdecode[str] = i;\n\t\tencode[i] = str;\n\t}\n}\n\nexport function adress(text){\n\tlet size;\n\tfor(let i = 0; i < text.length; i++)\n\t\tif(text.charCodeAt(i) < 59){\n\t\t\tsize = i;\n\t\t\tbreak;\n\t\t}\n\n\tconst col = text.substr(0, size);\n\tconst row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view, page){\n\tconst nind = text.indexOf(\"!\");\n\tlet sheet = page || \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tlet parts = text.split(\":\");\n\tif (parts.length != 2){\n\t\tif(view){\n\t\t\tlet code = view.ranges.getCode(text, sheet);\n\t\t\tif(!code){\n\t\t\t\t// global named range\n\t\t\t\tcode = view.ranges.getCode(text, true);\n\t\t\t\tif(!code)\n\t\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst rangeParts = code.split(\"!\");\n\t\t\tif(rangeParts[0] != page || view.getActiveSheet())\n\t\t\t\tsheet = rangeParts[0].replace(/'/g,\"\");\n\t\t\tcode = rangeParts[1];\n\t\t\tparts = code.split(\":\");\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t} \n\n\tconst d1 = adress(parts[0]);\n\tconst d2 = adress(parts[1]);\n\n\tif(d1[0] && d1[1] && d2[0] && d2[1])\n\t\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nexport function escapeSheet(sheet){\n\treturn sheet.indexOf(\" \") == -1 ? sheet : `'${sheet}'`;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tconst a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tconst range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nexport function isRange(text){\n\tif(typeof text == \"string\"){\n\t\tconst cells = text.split(\":\");\n\t\tif(cells.length == 2){\n\t\t\tfor(let i = 0; i < cells.length; i++){\n\t\t\t\tconst parts = cells[i].split(\"!\");\n\t\t\t\tif(!isCell(parts.pop()))\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nconst cellTest = /^[A-Z]+[0-9]+$/;\nexport function isCell(text){\n\treturn cellTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n};\n\nconst fonts = {\n\tmaterial: \"'Roboto', sans-serif\",\n\tmini: \"'Roboto', sans-serif\",\n\tflat: \"'PT Sans', Tahoma\",\n\tcompact: \"'PT Sans', Tahoma\",\n\tcontrast: \"'PT Sans', Tahoma\",\n\twillow: \"'Open Sans', sans-serif\",\n\tdark: \"'Open Sans', sans-serif\",\n};\n\nexport function setSkinDefaults(){\n\tconst skin = webix.skin.$name;\n\ttoolbarSizes.width = webix.skin.$active.inputHeight + 2;\n\ttoolbarSizes.titleHeight = (skin == \"mini\" || skin == \"compact\") ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = fonts[skin];\n\n\tif (skin == \"contrast\"){\n\t\tdefaultStyles.background = \"#393939\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t} else if (skin == \"material\" || skin == \"mini\"){\n\t\tdefaultStyles.color = \"#475466\";\n\t} else if (skin == \"willow\"){\n\t\tdefaultStyles.color = \"#2C2F3C\";\n\t} else if (skin == \"dark\"){\n\t\tdefaultStyles.background = \"#2A2B2D\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t}\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"underline\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\",\n\t\"strike\", \"indent\"\n];\n\nconst _style_map = {\n\tformat: ()=> \"\",\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;text-align:center;\",\n\t\tright: () => \"justify-content:flex-end;text-align:right;\"\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-left\", obj, zoom);\n\t},\n\t\"border-top\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-top\", obj, zoom);\n\t},\n\t\"border-right\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-right\", obj, zoom);\n\t},\n\t\"border-bottom\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-bottom\", obj, zoom);\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t},\n\tunderline: obj => {\n\t\tconst underline = obj.underline == \"underline\" ? \"underline\" : \"\";\n\t\tif(underline){\n\t\t\tconst strike = obj.strike == \"strike\" ? \"line-through\" : \"\";\n\t\t\treturn `text-decoration: ${underline} ${strike};`;\n\t\t}\n\t\treturn \"\";\n\t},\n\tstrike: obj => {\n\t\tif(obj.underline != \"underline\" && obj.strike == \"strike\")\n\t\t\treturn \"text-decoration: line-through;\";\n\t\treturn \"\";\n\t},\n\tindent: (obj, zoom) => {\n\t\tconst count = obj.indent * 1;\n\t\tif(count > 0){\n\t\t\tconst pos = obj[\"text-align\"] == \"right\" ? \"right\" : \"left\";\n\t\t\treturn { innerCss: `margin-${pos}:${(count * 8 + 12)*zoom}px;` }; // 12 - default cell margin\n\t\t}\n\t},\n\t\"font-size\": (obj, zoom) => {\n\t\tlet fontSize = obj[\"font-size\"];\n\n\t\tif(zoom != 1)\n\t\t\tfontSize = obj[\"font-size\"].replace(\"px\",\"\") * zoom + \"px\";\n\n\t\treturn \"font-size:\"+fontSize+\";\";\n\t},\n};\n\nfunction getBorderCss(pos, obj, zoom){\n\tlet border = obj[pos];\n\tif(border){\n\t\tlet [color, type] = border.split(\",\");\n\n\t\ttype = type || \"thin\";\n\t\tlet size = 1;\n\t\tif(type == \"medium\")\n\t\t\tsize = 2;\n\t\telse if(type == \"thick\" || type == \"double\")\n\t\t\tsize = 3;\n\n\t\tsize = size * zoom + \"px\";\n\n\n\t\tif([\"thin\", \"medium\", \"thick\"].indexOf(type) != -1)\n\t\t\ttype = \"solid\";\n\n\t\treturn `${pos}: ${size} ${type} ${color} !important;`;\n\t}\n\treturn \"\";\n}\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tconst area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tconst type = value[0];\n\t\tlet color = value[1];\n\t\tlet lineStyle = value[2];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"no\" && type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type)){\n\t\t\t\tconst border = type == \"no\" ? \"\" : `${color},${lineStyle}`;\n\t\t\t\tstyle = _updateStyle(view, style, mode, border, cell);\n\t\t\t}\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function zoomStyles(view){\n\tconst data = {};\n\t_serialize(view, data);\n\treset(view);\n\t_parse(view, data, true);\n}\n\nexport function getStyle(view, cell){\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\n\tif(span && span[0] == cell.row && span[1] == cell.column){\n\t\tconst spanStyles = span[5].split(\" \");\n\t\tfor (let i = 0; i < spanStyles.length; i++){\n\t\t\tconst spanStyle = view._styles[spanStyles[i]];\n\t\t\tif(spanStyle)\n\t\t\t\treturn spanStyle;\n\t\t}\n\t}\n\n\tif (obj && obj.style)\n\t\treturn view._styles[obj.style];\n\n\treturn null;\n}\n\nexport function getFormat(view, row, column){\n\tvar obj = view._mPage.getCell(row-1, column-1);\n\treturn (obj && obj.format) || \"\";\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops: styleFromText( style_names.map(()=>\"\").join(\";\") )\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\n\n\tstyle.text = styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj, zoom){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tif(!zoom)\n\t\tfor (let i = 0; i < obj.data.length; i++){\n\t\t\tvar [row, column, , css] = obj.data[i];\n\n\t\t\tif (css)\n\t\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t\t}\n}\n\nfunction _applyStyles(view, name, value){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\t\t\tif(!span || (span && span[0] == cell.row && span[1] == cell.column))\n\t\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tconst ostyle = getStyle(view, cell);\n\n\tif(name == \"indent\"){\n\t\tconst oldVal = ((ostyle && ostyle.props[name]) || 0) * 1;\n\n\t\tif(!oldVal && value == -1)\n\t\t\treturn;\n\n\t\tvalue += oldVal;\n\t}\n\n\tconst nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle, true);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst obj = view._mPage.getCell(row-1, column-1, true);\n\tobj.style = style && style.id;\n\tobj.format = style && style.props.format;\n}\n\nexport function setStyle(view, cell, style){\n\tconst old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old, toolbar){\n\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\tgroup.set(()=>{\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\n\t\t\t\tconst sel = view.getSelectedId();\n\t\t\t\tif(!toolbar && sel && sel.row == cell.row && sel.column == cell.column)\n\t\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\"}]);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction _buildCssString(view, style) {\n\tlet css = \"\";\n\tlet innerCss = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\"){\n\t\t\t\t\tconst outCss = _style_map[key](style, view._zoom);\n\n\t\t\t\t\tif(typeof outCss == \"object\"){\n\t\t\t\t\t\tcss += outCss.css || \"\";\n\t\t\t\t\t\tinnerCss += outCss.innerCss || \"\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tcss += outCss;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn {css, innerCss};\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst {css, innerCss} = _buildCssString(view, style.props);\n\tconst prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\twebix.html.addStyle(prefix+\" .\"+style.id+\" div:first-child{\"+innerCss+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text, page: view.getActiveSheet() } );\n}\n\nexport function styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nexport function styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tconst serialized = view.serialize();\n\tserialized.styles = removeUnusedStyles(serialized);\n\n\treset(view);\n\t_parse(view, serialized);\n}\n\nexport function removeUnusedStyles(serialized){\n\tconst data = serialized.data;\n\tconst styles = serialized.styles;\n\n\tconst used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tconst name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tconst newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tconst name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\treturn newStyles;\n}","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, spans, rows, cols){\n\tfor(let i=0; i<data.length; i++){\n\t\t// data[i] - [ row, column, value, style]\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\n\tif(spans)\n\t\tfor(let i = 0; i < spans.length; i++){\n\t\t\t// spans[i] - [ row, column, colCount, rowCount ]\n\t\t\tconst spanEndRow = spans[i][0] + spans[i][3] - 1;\n\t\t\tconst spanEndCol = spans[i][1] + spans[i][2] - 1;\n\n\t\t\tif(spanEndRow > rows) rows = spanEndRow;\n\t\t\tif(spanEndCol > cols) cols = spanEndCol;\n\t\t}\n\n\treturn [rows*1, cols*1];\n}","import {addStyle, styleFromText} from \"./styles\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport group from \"./undo_group\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\nexport let currencies = [];\nconst defaultFormats = {common:1};\n\n\nexport let formatsCount;\nexport let formatCache;\n\nlet formats;\nlet formatSources;\n\nfunction getCurrencySymbol(format){\n\treturn webix.template(format)(\"\");\n}\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\n\tcurrencies = [ webix.i18n.price ];\n\tcurrencies = currencies.concat(webix.copy(formatsLocale.currencies));\n\n\tcurrencies = currencies.map(format => {\n\t\tconst id = getCurrencySymbol(format);\n\t\treturn {\n\t\t\tformat,\n\t\t\tid,\n\t\t\tvalue: id.trim()\n\t\t};\n\t});\n\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\tconst minusSign = value < 0 ? \"-\" : \"\";\n\t\t\t\tif(minusSign) value = Math.abs(value);\n\t\t\t\treturn minusSign+webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tdefaultFormats[i] = 1;\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\n\tfor(let i in formatSources){\n\t\tif(!defaultFormats[i]) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tif(typeof(values) == \"string\")\n\t\tvalues = formatToForm(str);\n\n\twebix.extend(\n\t\tvalues,\n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.symbol, separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\tlet method;\n\ttry {\n\t\tmethod = new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n\t}\n\tcatch(err){\n\t\tmethod = function(){return errorMessage;};\n\t}\n\treturn method;\n}\n\nfunction genCode(check, color, symbol, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters, symbol);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters, symbol){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tlet symbolPos;\n\tif(symbol){\n\t\tconst currency = arr.find(currencies, val => val.id == symbol);\n\t\tsymbolPos = \"left\";\n\n\t\tif(currency)\n\t\t\tsymbolPos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\t}\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tif(symbolPos == \"left\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tif(symbolPos == \"right\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst obj = view._mPage.getCell(cells[0].row-1, cells[0].column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\t\n\tif(webix.rules.isNumber(value) || oldFormat){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = getFormatName(view, cells[0].row, cells[0].column) || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\n\tif(oldFormat){\n\t\tformat = webix.copy({values:formatHelpers[oldFormat].values, format:getFormatSource(oldFormat)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn !defaultFormats[name];\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\tif(formValues.negative == 4)\n\t\tvalues[1].left.text += \"(\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text += \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbolId = formValues.symbol;\n\t\tconst currency = arr.find(currencies, val => val.id == symbolId);\n\t\tconst pos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\n\t\tvalues[0][pos].symbol = values[1][pos].symbol = symbolId;\n\t}\n\n\tif(formValues.negative == 4)\n\t\tvalues[1].right.text += \")\";\n\n\treturn values;\n}\n\nfunction formatToForm(format){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tconst dates = [\n\t\tformatsLocale.dateFormat,\n\t\tformatsLocale.timeFormat,\n\t\tformatsLocale.fullDateFormat,\n\t\tformatsLocale.longDateFormat\n\t];\n\tconst form = {format, type:\"custom\"};\n\n\tif(arr.find(dates, date => date == format)){\n\t\twebix.extend(form, {\n\t\t\ttype:\"date\", date:format\n\t\t}, true);\n\t}\n\telse{\n\t\tlet [first, second] = format.split(\";\");\n\t\tif(first && second){\n\t\t\tif(first.indexOf(\"[>=0]\") == 0 && second.indexOf(\"[<0]\") == 0){\n\t\t\t\tfirst = first.replace(\"[>=0]\", \"\");\n\t\t\t\tsecond = second.replace(\"[<0]\", \"\");\n\n\t\t\t\tlet red;\n\t\t\t\tif(second.indexOf(\"[red]\") == 0){\n\t\t\t\t\tsecond = second.replace(\"[red]\", \"\");\n\t\t\t\t\tred = true;\n\t\t\t\t}\n\n\t\t\t\tif(second[0] == \"-\"){\n\t\t\t\t\tsecond = second.substring(1);\n\t\t\t\t\tform.negative = red ? 2 : 1;\n\t\t\t\t}\n\t\t\t\telse if(red){\n\t\t\t\t\tif(second[0] == \"(\" && second[second.length-1] == \")\"){\n\t\t\t\t\t\tform.negative = 4;\n\t\t\t\t\t\tsecond = second.substring(1, second.length-1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tform.negative = 3;\n\t\t\t\t}\n\n\t\t\t\tif(form.negative && first == second){\n\t\t\t\t\tlet type = \"int\";\n\t\t\t\t\tlet priceBrackets = first.indexOf(\"[$\") != -1;\n\n\t\t\t\t\tif(first[first.length-1] == \"%\"){\n\t\t\t\t\t\tfirst = first.substring(0, first.length-1);\n\t\t\t\t\t\ttype = \"percent\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfor(let i = 0; i < currencies.length; i++){\n\t\t\t\t\t\t\tconst currency = currencies[i].id;\n\t\t\t\t\t\t\tlet isPrice;\n\n\t\t\t\t\t\t\tif(priceBrackets){\n\t\t\t\t\t\t\t\tif(first.indexOf(`[$${currency}]`) != -1){\n\t\t\t\t\t\t\t\t\tfirst = first.replace(`[$${currency}]`, \"\");\n\t\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(first.indexOf(currency) != -1){\n\t\t\t\t\t\t\t\tfirst = first.replace(currency, \"\");\n\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(isPrice){\n\t\t\t\t\t\t\t\ttype = \"price\";\n\t\t\t\t\t\t\t\tform.symbol = currency;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst delimiters = getDelimiters(type);\n\n\t\t\t\t\tif(first.indexOf(\"#\"+delimiters.groupSign) == 0){\n\t\t\t\t\t\tfirst = first.replace(\"#\"+delimiters.groupSign, \"\");\n\t\t\t\t\t\tform.separator = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst [integer, decimal] = first.split(delimiters.decimalSign);\n\t\t\t\t\tif((!integer || integer == \"0\") && (!decimal || /^[0]+$/.test(decimal))){\n\t\t\t\t\t\tform.type = type;\n\t\t\t\t\t\tform.delimiters = delimiters;\n\t\t\t\t\t\tform.zeros = decimal ? decimal.length : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn form;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].left.symbol+\"]\";\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].right.symbol+\"]\";\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition ,left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\n\t\tconst symbol = separated.symbol;\n\t\tif(symbol){\n\t\t\tconst currency = arr.find(currencies, val => val.id == symbol);\n\t\t\tlet pos = \"left\";\n\n\t\t\tif(currency)\n\t\t\t\tpos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\n\t\t\tvalues[i][pos].symbol = symbol;\n\t\t}\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet symbol = \"\";\n\n\tlet start = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[$\");\n\tif(start != -1){\n\t\tlet end = start + line.substr(start).indexOf(\"]\");\n\t\tsymbol = line.substr(start+2, end-start-2);\n\t\tline = line.substr(0, start)+line.substr(end+1);\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color, symbol, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view._mPage.getCell(row-1, col-1);\n\treturn (item && item.format) || null;\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(view, row, col){\n\tconst formatName = getFormatName(view, row, col);\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}\n\nexport function getFormatFromData(data, array){\n\tconst styleName = array[3];\n\tlet fmt;\n\tif(styleName){\n\t\tlet style = arr.find(data.styles, arr => arr[0] == styleName);\n\t\tif(style){\n\t\t\tstyle = style[1];\n\t\t\tconst fmtName = styleFromText(style).format;\n\t\t\tif(fmtName){\n\t\t\t\tif(data.formats)\n\t\t\t\t\tfmt = arr.find(data.formats, arr => arr[0] == fmtName);\n\n\t\t\t\tif(fmt)\n\t\t\t\t\tfmt = fmt[1];\n\t\t\t\telse\n\t\t\t\t\tfmt = getFormatSource(fmtName); //default formats (int, percent, etc.)\n\t\t\t}\n\t\t}\n\t}\n\treturn fmt;\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nexport function isChar(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? code >= 65 || code == 35 || code == 36 || code == 46 : code > 191;\n}\n\nexport function getLastCharIndex(str, includeNumbers){\n\tlet lastChar = str.length;\n\tfor(let i = lastChar - 1; i >= 0; i--){\n\t\tif(!isChar(str[i])){\n\t\t\tif(includeNumbers && isNumber(str[i]))\n\t\t\t\tcontinue;\n\t\t\treturn lastChar;\n\t\t}\n\t\telse\n\t\t\tlastChar = i;\n\t}\n}\n\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i){\n\tlet sheet = \"\";\n\tlet quotes = false;\n\n\tlet j;\n\tfor(j=i; j<formula.length; j++){\n\t\tconst key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nexport function split(formula, view, crosssheet, fromSheet){\n\tconst activeSheet = view.getActiveSheet();\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i);\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\n\t\t\t\t\tif(formula[next+1] !== \"(\"){\n\t\t\t\t\t\tif(isPosition(word)){\n\t\t\t\t\t\t\tif(!sheet || sheet == activeSheet || crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t//specified sheet or active sheet (if not specified) range\n\t\t\t\t\t\t\t\tlet range = view.ranges.getCode(word, sheet || fromSheet);\n\n\t\t\t\t\t\t\t\t//global range\n\t\t\t\t\t\t\t\tif(!range)\n\t\t\t\t\t\t\t\t\trange = view.ranges.getCode(word, true);\n\n\t\t\t\t\t\t\t\tif(range){\n\t\t\t\t\t\t\t\t\tconst parts = range.split(\"!\");\n\t\t\t\t\t\t\t\t\tif(parts[0] == activeSheet){\n\t\t\t\t\t\t\t\t\t\tvalue = [sheet, word, escaped, parts[1]];\n\t\t\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\n\tconst parts = split(value, view);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(/^[A-Za-z]+$/.test(parts[i][1]))\n\t\t\t\t\tparts[i] = parts[i][3].split(\":\")[0];\n\t\t\t\telse if(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","import {getFormatName, checkFormat, isDateInvalid, getFormatFromData, getFormatSource} from \"./formats\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getMathFormat} from \"../mathematics/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, page){\n\t\tif(page == this.getActiveSheet() && !this._setType){\n\t\t\tconst formatName = getFormatName(this, row, col);\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue,\n\t\t\t\tfmt: formatName ? {fmt: getFormatSource(formatName)} : null\n\t\t\t};\n\t\t\tsetType(this, cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, formatName){\n\t\tif(!this._setType){\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue: view.getCellValue(row, col),\n\t\t\t\tfmt: {fmt:getFormatSource(formatName)}\n\t\t\t};\n\t\t\tsetType(this, cell, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nexport function loadCell(view, data, item){\n\tconst fmt = getFormatFromData(data, item);\n\tconst cell = {\n\t\tvalue: item[2],\n\t\tfmt: fmt ? {fmt} : null,\n\t\ttype: item[4]\n\t};\n\tsetType(view, cell);\n\treturn cell;\n}\n\nfunction getExpectType(view, cell, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(cell.value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(cell.value))\n\t\t\t\ttype = \"date\";\n\t\t\telse if(/^=(sparkline|image)\\(/i.test(cell.value))\n\t\t\t\ttype = \"string\";\n\t\t}\n\t\telse if(!isNaN(cell.value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tconst value  = parser(cell.value);\n\t\t\tif(value != \"\" && !isNaN(value)){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, cell, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, cell, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, cell, date){\n\tdate = getExcelDateFromJs(date);\n\tcell.value = date;\n\n\tif(!(view._loading_data || view._page_value_set))\n\t\tview.setCellValue(cell.row, cell.col, date);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column, page){\n\tpage = page ? view._mData.getPage(page) : view._mPage;\n\tconst item = page.getCell(row-1, column-1);\n\treturn (item && item.type) || null;\n}\n\nfunction setType(view, cell, style){\n\tconst parseToStore = !(cell.row && cell.col);\n\n\t//prevent type change during value or format change\n\tview._setType = true;\n\n\tconst isFormula = typeof cell.value == \"string\" && cell.value[0] == \"=\";\n\tconst parseDate = (!style || cell.fmt == getFormatSource(\"date\")) && (!view._loading_data || view._page_value_set || cell.type == \"date\");\n\n\tlet mathFormat;\n\tif(!parseToStore)\n\t\tmathFormat = isFormula && !cell.fmt ? getMathFormat(view, cell.value) : null;\n\n\tconst formatType = getFormatType(cell.fmt || mathFormat);\n\tconst expectType = getExpectType(view, cell, parseDate, isFormula, formatType, style);\n\n\tcell.type = checkType(cell.type, expectType, formatType, isFormula, cell.value);\n\n\tif(!parseToStore){\n\t\tconst item = view._mPage.getCell(cell.row-1, cell.col-1, true);\n\t\titem.$format = formatType == \"string\" ? 1 : 0;\n\t\tupdateCell(view, cell, expectType, formatType, mathFormat);\n\t\titem.type = cell.type;\n\t}\n\n\tdelete view._setType;\n}\n\nfunction updateCell(view, cell, expectType, formatType, mathFormat){\n\tconst row = cell.row;\n\tconst col = cell.col;\n\tconst isString = typeof cell.value == \"string\";\n\n\tconst isFormula = isString && cell.value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\t//update cell value if set number format (5e5 -> 500000, 005 -> 5)\n\tif(!(view._loading_data || view._page_value_set) && cell.type === \"number\" && isString && !isFormula && cell.value !== \"\")\n\t\tview.setCellValue(row, col, cell.value*1);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(cell.type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && cell.value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && cell.type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((cell.type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import {isChar, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tconst str = val.substring(0, cursor);\n\t\t\tconst search = str.substring( getLastCharIndex(str, true) );\n\t\t\tconst nextSymbol = val.charAt(cursor);\n\n\t\t\tif(search && (cursor === val.length || !(isChar(nextSymbol) || /^[0-9]/.test(nextSymbol))))\n\t\t\t\tvalue = search;\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tconst arrowCss = config.arrow ? \" webix_ssheet_button_menu\" : \"\";\n\t\tconst iconCss = config.label ? \"\" : \" webix_ssheet_icon_only\";\n\t\tthis.$view.className += \" webix_ssheet_button\"+arrowCss+iconCss;\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow){\n\t\t\t\tconst right = webix.skin.$active.inputSpacing/2;\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down' style='right:\"+right+\"px;'></span>\";\n\t\t\t}\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","export function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tobj.data = getSheetData(view, math);\n\n\twebix.extend(\n\t\tobj.table,\n\t\t{\n\t\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\t\tfrozenRows : (view._frozenRows || 0)\n\t\t}\n\t);\n}\n\nfunction _parse(view, obj){\n\tconst tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns))\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows))\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tview.$$(\"cells\").define(\"fixedRowHeight\", false);\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}\n\nexport function getSheetData(view, math, page){\n\tpage = page ? view._mData.getPage(page) : view._mPage;\n\treturn page.serialize(math)\n\t\t.map(arr =>{\n\t\t\tlet value = arr[2].value;\n\t\t\tif(value === null)\n\t\t\t\tvalue = \"\";\n\t\t\treturn [ ++arr[0], ++arr[1], value, arr[2].style||\"\", arr[2].type];\n\t\t})\n\t\t.filter(arr => {\n\t\t\treturn arr[2] || arr[2] === 0 || arr[3];\n\t\t});\n}","import \"./suggest_formula\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport {getType} from \"../operations/types\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {split, position, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconst master = this.getTopParentView();\n\n\t\tconfig.suggest = {\n\t\t\twidth: 250,\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData,\n\t\t\ttemplate: obj => obj.pos ? obj.id : obj.value,\n\t\t\tbody: {\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(obj.id.indexOf(\"$range_\") == 0)\n\t\t\t\t\t\treturn `<span class=\"webix_ssheet_left\">${obj.value}</span><span class=\"webix_ssheet_range webix_ssheet_right\">${obj.pos}</span>`;\n\t\t\t\t\telse\n\t\t\t\t\t\treturn obj.value;\n\t\t\t\t}\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeShow: function(){\n\t\t\t\t\tconst list = this.getList();\n\n\t\t\t\t\tconst oldRanges = list.find(obj => obj.id.indexOf(\"$range_\") == 0);\n\t\t\t\t\tif(oldRanges)\n\t\t\t\t\t\toldRanges.forEach(obj => list.remove(obj.id));\n\n\t\t\t\t\tconst allRanges = master.ranges.serialize(master.getActiveSheet()).map(r => ({\n\t\t\t\t\t\tid: \"$range_\" + r[0],\n\t\t\t\t\t\tvalue: r[0],\n\t\t\t\t\t\tpos: r[1],\n\t\t\t\t\t\tglobal: r[2]\n\t\t\t\t\t}));\n\n\t\t\t\t\tconst suggestRanges = allRanges.filter(range => !range.global);\n\t\t\t\t\t\n\t\t\t\t\tallRanges.filter(range => range.global).forEach(range => {\n\t\t\t\t\t\tif(!suggestRanges.find(sRange => sRange.value == range.value))\n\t\t\t\t\t\t\tsuggestRanges.push(range);\n\t\t\t\t\t});\n\n\t\t\t\t\tsuggestRanges.forEach(range => list.add(range));\n\t\t\t\t\tlist.sort(\"value\", \"asc\", \"string\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code == 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\t\tthis.showActiveSheet(true);\n\t\t\t\t\tthis.updateCellValue(cell);\n\t\t\t\t\t//blur to avoid calling highlight function after selection move\n\t\t\t\t\tthis.getInputNode().blur();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t\t//esc - cancel editing\n\t\t\telse if(code == 27){\n\t\t\t\tthis.showActiveSheet();\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tconst cell = master.getSelectedId();\n\t\t\t\t\tconst oldVal = this.getCellValue(cell.row, cell.column);\n\n\t\t\t\t\tif(this.getValue() == oldVal)\n\t\t\t\t\t\tmaster.$$(\"cells\").refresh(cell.row);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.setValue(oldVal);\n\n\t\t\t\t\tdelete master.$handleSelection;\n\n\t\t\t\t\twebix.UIManager.setFocus(master.$$(\"cells\"));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst parts = split(value, master, null, this._activeMath);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = crossheet && !getLastCharIndex(parts[i][1]);\n\n\t\t\t\t\tif(rangeName || activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = parts[i][3].split(\":\");\n\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(webix.isArray(parts[i+2]) ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = webix.isArray(parts[i+2]) ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? cellText : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//OtherSheet!A1:A3 - do not highlight A3\n\t\t\t\t\t\telse if(parts[i-1] && parts[i-1][ parts[i-1].length-1 ] == \":\"){\n\t\t\t\t\t\t\thtml += cellText;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(enter){\n\t\tconst master = this.getTopParentView();\n\t\tconst grid = master._table;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst cell = this.config.activeCell;\n\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tgrid.select(cell.row + (enter ? 1 : 0), cell.column);\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t\telse if(enter){\n\t\t\twebix.delay(()=>{\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tconst code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9){\n\t\t\twebix.html.preventEvent(e);\n\n\t\t\tthis.getInputNode().blur();\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(e.shiftKey ? \"left\" : \"right\");\n\t\t}\n\t},\n\tpaintValue(){\n\t\tconst master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tconst cell = this.config.activeCell;\n\t\t\tconst node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue(cell) {\n\t\tconst newv = this.getValue();\n\t\tconst master = this.getTopParentView();\n\t\tcell = cell || this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tconst val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv !== val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tconst str2 = formula.substring(cursor);\n\n\t\t\tif(str1[str1.length-1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length-1);\n\n\t\t\tstr1 = str1.substring(0, getLastCharIndex(str1, true));\n\n\t\t\tconst range = value.indexOf(\"$range_\") == 0;\n\t\t\tif(range)\n\t\t\t\tvalue = value.substr(7);\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 += value + (range || str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectOperator(ignoreSel){\n\t\tconst text = this.getValue();\n\n\t\tif(text[0] == \"=\"){\n\t\t\tlet cursor = ignoreSel ? text.length : this.getInputNode().selectionStart;\n\t\t\twhile(text[cursor-1] == \" \")\n\t\t\t\tcursor--;\n\t\t\treturn text[cursor-1] && text[cursor-1].match(/[+&\\-/*=(:,]/);\n\t\t}\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tif(!sheet)\n\t\t\treturn \"\";\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t},\n\tgetCellValue(row, column){\n\t\tconst master = this.getTopParentView();\n\t\tlet value = master.getCellValue(row, column);\n\t\tif(getType(master, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(master, row, column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tconst old = this.getValue();\n\n\t\tif(!old || old == this.config.offValue)\n\t\t\tthis.config.value = this.config.onValue || true;\n\t\telse\n\t\t\tthis.config.value = this.config.offValue || false;\n\n\t\tconst val = this.getValue();\n\t\tthis.$setValue(val);\n\t\tthis.callEvent(\"onChange\", [val, old, \"user\"]);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true || obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","import * as arr from \"../helpers/array\";\n\nwebix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:0\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst value = this.getValue(true);\n\n\t\t\t\tif(webix.isArray(value) && (!value.length || !arr.find(value, config => !config.$hiddenSheet))){\n\t\t\t\t\tconst checkboxes = this._getCheckboxes();\n\t\t\t\t\tarr.find(checkboxes, c => !c.config.$hiddenSheet).setValue(1);\n\t\t\t\t}\n\n\t\t\t\tthis.elements.$all.setValue(this.getValue(true) === true ? 1 : 0);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tconst icon = `<span class=\"webix_icon wxi-eye${sheet.hidden ? \"-slash\" : \"\"}\"></span>`;\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: icon + sheet.name, name: sheet.name, value: sheet.active, $hiddenSheet: sheet.hidden });\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(config){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue()){\n\t\t\t\tconst cfg = checkboxes[i].config;\n\t\t\t\toutput.push(config ? cfg : cfg.name);\n\t\t\t}\n\n\t\tif(output.length == this._count)\n\t\t\treturn true;\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init:function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t\tthis.getMenu();\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tif(!this._menu){\n\t\t\tlet data = [\n\t\t\t\t{ value:labels[\"export-view\"], submenu:[\n\t\t\t\t\t{ id:\"pdf\", value:labels[\"export-view-pdf\"] },\n\t\t\t\t\t{ id:\"png\", value:labels[\"export-view-png\"] },\n\t\t\t\t\t{ id:\"excel\", value:labels[\"export-view-excel\"] }\n\t\t\t\t] }\n\t\t\t];\n\n\t\t\tif(!webix.$$(this.config.master).getTopParentView().config.readonly)\n\t\t\t\tdata = [\n\t\t\t\t\t{ id:\"edit\", value:labels[\"edit-view\"] },\n\t\t\t\t\t...data,\n\t\t\t\t\t{ id:\"del\", value:labels[\"remove-view\"] }\n\t\t\t\t];\n\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tsubmenuConfig:{\n\t\t\t\t\texternalUI: this.config.id\n\t\t\t\t},\n\t\t\t\tdata:data,\n\t\t\t\ton:{\n\t\t\t\t\tonMenuItemClick: id => this._menuActions(id),\n\t\t\t\t\tonBeforeShow: () => this._toggleExcel()\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tswitch(id){\n\t\t\tcase \"del\":\n\t\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"pdf\":\n\t\t\t\twebix.toPDF(this.getBody(), {display:\"image\"});\n\t\t\t\tbreak;\n\t\t\tcase \"png\":\n\t\t\t\twebix.toPNG(this.getBody());\n\t\t\t\tbreak;\n\t\t\tcase \"excel\":\n\t\t\t\twebix.toExcel(this.getBody(), {header: false});\n\t\t\t\tbreak;\n\t\t}\n\t},\n\t_toggleExcel:function(){\n\t\tconst view = this.getBody();\n\t\tif(view.data && view.data.pull)\n\t\t\tthis._menu.showMenuItem(\"excel\");\n\t\telse\n\t\t\tthis._menu.hideMenuItem(\"excel\");\n\t},\n\t_removeView:function(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname: \"ssheet-series\",\n\t$init: function(config){\n\t\tthis.hidden = {};\n\t\tconfig.rows = [\n\t\t\t{\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tborderless: true,\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\tmulti: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.getSectionConfig()\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonAfterScroll:function(){\n\t\t\t\t\t\t//close possibly open selector popups\n\t\t\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ view:\"button\", label:webix.i18n.spreadsheet.labels[\"add-line\"], click:()=>{\n\t\t\t\tthis.addSection();\n\t\t\t}}\n\t\t];\n\t},\n\tgetSectionConfig: function(i){\n\t\tconst view = this;\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tconst trashIcon = \"<span class='webix_icon webix_ssheet_series_icon wxi-trash'></span>\";\n\t\tconst padding = webix.skin.$active.dataPadding-2;\n\n\t\treturn {\n\t\t\tview:\"accordionitem\",\n\t\t\theader:`${labels[\"chart-item\"]} ${i ? i+1 : 1} ${trashIcon}`,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\tpadding,\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\", range:true, on:{\n\t\t\t\t\t\tonChange: function(val, oldVal) {\n\t\t\t\t\t\t\tconst upper = val.toUpperCase();\n\t\t\t\t\t\t\tif(val != upper){\n\t\t\t\t\t\t\t\tthis.blockEvent();\n\t\t\t\t\t\t\t\tthis.setValue(upper);\n\t\t\t\t\t\t\t\tthis.unblockEvent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tview.callEvent(\"onRangeChange\", [upper, oldVal]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-series-color\"], name:\"color\", hidden: this.hidden.color},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-tooltip\"], name:\"tooltip\" },\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-label\"], name:\"label\", hidden: this.hidden.label },\n\t\t\t\t\t{ view:\"richselect\", label:labels[\"chart-markers\"], value:\"square\", name:\"marker\", hidden: this.hidden.marker,\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{id:\"square\", value:labels[\"chart-markers-square\"]},\n\t\t\t\t\t\t\t\t{id:\"triangle\", value:labels[\"chart-markers-triangle\"]},\n\t\t\t\t\t\t\t\t{id:\"diamond\", value:labels[\"chart-markers-diamond\"]},\n\t\t\t\t\t\t\t\t{id:\"round\", value:labels[\"chart-markers-round\"]}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"wxi-trash\": function(){\n\t\t\t\t\tconst layout = this.getParentView();\n\t\t\t\t\tlayout.removeView(this);\n\n\t\t\t\t\tconst childs = layout.getChildViews();\n\n\t\t\t\t\tfor (let i = 0; i < childs.length; i++) {\n\t\t\t\t\t\tchilds[i].define({header:`${labels[\"chart-item\"]} ${i+1} ${trashIcon}`});\n\t\t\t\t\t\tchilds[i].refresh();\n\t\t\t\t\t}\n\n\t\t\t\t\tview.callEvent(\"onChange\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\taddSection: function(){\n\t\tconst layout = this.getLayout();\n\t\tconst lastIndex = layout.getChildViews().length;\n\t\tconst layoutId = layout.addView(this.getSectionConfig(lastIndex));\n\n\t\twebix.$$(layoutId).queryView({name: \"range\"}).focus();\n\t},\n\tsetValue: function(value){\n\t\tvalue = value || [];\n\n\t\tconst layout = this.getLayout();\n\t\tconst childs = layout.getChildViews();\n\t\tconst count = childs.length;\n\n\t\tif(count > value.length)\n\t\t\tfor(let i = count; i > value.length; i--)\n\t\t\t\tthis.getLayout().removeView(childs[i-1]);\n\t\telse if(value.length > count)\n\t\t\tfor(let i = value.length; i > count; i--)\n\t\t\t\tthis.addSection();\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst form = childs[i].getChildViews()[0];\n\t\t\tconst range = form.queryView({name: \"range\"});\n\n\t\t\t//block range events to ignore onRangeChange\n\t\t\trange.blockEvent();\n\t\t\tform.setValues(value[i]);\n\t\t\trange.unblockEvent();\n\t\t}\n\t},\n\tsetSubValue: function(sub, value){\n\t\tsub.blockEvent();\n\t\tsub.setValue(value);\n\t\tsub.unblockEvent();\n\t},\n\tgetLayout(){\n\t\treturn this.queryView(\"scrollview\").getBody();\n\t},\n\thideSubviews(name, show){\n\t\tthis.hidden[name] = !show;\n\n\t\tthis.queryView({ name }, \"all\").forEach(view => {\n\t\t\tif(show)\n\t\t\t\tview.show();\n\t\t\telse\n\t\t\t\tview.hide();\n\t\t});\n\t},\n\tgetValue: function(){\n\t\tconst value = [];\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.getChildViews().forEach(child => {\n\t\t\tvalue.push(child.getChildViews()[0].getValues());\n\t\t});\n\t\treturn value;\n\t}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-toolbar-scrollview\",\n\t$getSize: function(){\n\t\tconst size = webix.ui.scrollview.prototype.$getSize.apply(this, arguments);\n\t\tconst bodySize = this.getBody().$getSize(0, 0);\n\n\t\tlet scroll = 0;\n\t\tif(this.config.scroll)\n\t\t\tscroll = webix.env.scrollSize;\n\t\telse\n\t\t\tthis.$view.style[\"overflow-x\"] = \"hidden\";\n\n\t\tsize[2] = size[3] = bodySize[2] + scroll;\n\n\t\treturn size;\n\t},\n\t$setSize: function(x,y){\n\t\tconst bodySize = this.getBody().$getSize(0, 0);\n\t\tconst oldScroll = this.config.scroll;\n\t\tconst scroll = x < bodySize[0] ? \"x\" : false;\n\n\t\tif(scroll != oldScroll){\n\t\t\tthis.define({scroll});\n\t\t\treturn webix.delay(()=>{\n\t\t\t\tthis.resize();\n\t\t\t});\n\t\t}\n\n\t\twebix.ui.scrollview.prototype.$setSize.apply(this, [x, y]);\n\t}\n},webix.ui.scrollview);","import * as arr from \"./helpers/array\";\nimport {getSheetData} from \"./operations/data\";\nimport {DataStore} from \"@xbs/muon\";\nimport {loadCell} from \"./operations/types\";\nimport {removeUnusedStyles, styleFromText, styleToText} from \"./operations/styles\";\nimport {getFormatFromData, checkFormat} from \"./operations/formats\";\nimport {updateMaxColumn, encode, escapeSheet} from \"./helpers/column_names\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\",\n\t\"copy-sheet\",\n\t\"hide-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": view => _remove(view),\n\t\"rename-sheet\": view => edit(view),\n\t\"new-sheet\": view => add(view),\n\t\"copy-sheet\": view => copy(view),\n\t\"hide-sheet\": view => setState(view, view._activeSheet, \"hidden\")\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport const numbers = [0.5, 0.75, 0.9, 1, 1.1, 1.25, 1.5, 1.75, 2, 3, 4];\n\nexport function defaultBottom(view){\n\tconst locale = webix.i18n.spreadsheet.tooltips;\n\tconst readonly = view.config.readonly;\n\tconst tabWidth = view.config.sheetTabWidth;\n\tconst minTabWidth = tabWidth == \"auto\" ? view.defaults.sheetTabWidth : tabWidth;\n\n\tconst toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\thidden:readonly,\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: 2,\n\t\t\t\t\tbottom: 2,\n\t\t\t\t\tleft: 4\n\t\t\t\t},\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"icon\", icon:\"wxi-plus\", width:30, id: \"add-sheet\", click: ()=> add(view),\n\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"icon\", icon:\"wxi-dots\", width:30, id: \"show-sheet\", popup: getSheetsPopup(view),\n\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"show-sheet\"]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\tmaxWidth: 5 * minTabWidth,\n\t\t\t\tminWidth: minTabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t},\n\t\t\t{gravity:0.000001},\n\t\t\t{\n\t\t\t\tview: \"ssheet-zoom\",\n\t\t\t\tnumbers,\n\t\t\t\tvalue: 1,\n\t\t\t\twidth: 108,\n\t\t\t\ttooltip: locale[\"scale\"],\n\t\t\t\tid: \"zoom\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: (v, oldV, config) => {\n\t\t\t\t\t\tif (config == \"user\") view.zoom(v);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tconst sheets = view.$$(\"sheets\");\n\tlet step = view.config.sheetTabWidth;\n\tif(step == \"auto\")\n\t\tstep = view.defaults.sheetTabWidth;\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*step), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tconst tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tconst set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t\t_filterTabs(view);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tchangePagerVisability(view);\n\t\t\tchangePagerStatus(view);\n\t\t});\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterRender\", webix.once(() => {\n\t\t\twebix.delay(()=> changePagerVisability(view));\n\t\t}));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction getSheetsPopup(view){\n\treturn {\n\t\tview: \"popup\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\twidth: 125,\n\t\tbody:{\n\t\t\tview: \"list\",\n\t\t\tselect: true,\n\t\t\tcss: \"webix_ssheet_show_list\",\n\t\t\ttemplate: \"<span class='webix_icon wxi-#icon#'></span>#id#\",\n\t\t\ton:{\n\t\t\t\tonAfterSelect: function(id) {\n\t\t\t\t\tsetState(view, id, \"visible\");\n\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\tthis.getParentView().hide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmaxHeight: 200,\n\t\t\tautoheight: true\n\t\t},\n\t\ton:{\n\t\t\tonShow: function(){\n\t\t\t\tthis.getBody().showItem(view.getActiveSheet());\n\t\t\t},\n\t\t\tonBeforeShow: function(){\n\t\t\t\tconst data = view._sheets\n\t\t\t\t\t.filter(sheet => sheet.state != \"veryHidden\")\n\t\t\t\t\t.map(sheet => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: sheet.name,\n\t\t\t\t\t\t\ticon: sheet.state == \"hidden\" ? \"eye-slash\" : \"eye\"\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\n\t\t\t\tconst list = this.getBody();\n\t\t\t\tlist.clearAll();\n\t\t\t\tlist.parse(data);\n\t\t\t\tlist.select(view.getActiveSheet());\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", id => callAction(view,id));\n\t}\n\n\tconst oneSheet = view.$$(\"sheets\").count() == 1;\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tview.$sheetMenu[oneSheet ? \"disableItem\" : \"enableItem\"](\"remove-sheet\");\n\n\tif(view.$sheetMenu.getItem(\"hide-sheet\"))\n\t\tview.$sheetMenu[oneSheet ? \"disableItem\" : \"enableItem\"](\"hide-sheet\");\n\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id]))\n\t\tview.$sheetMenu.show(e);\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\tif(scrollPos == 0)\n\t\tview.$$(\"prev-sheet\").disable();\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tif(sheets.$view.scrollWidth - scrollPos == sheets.$width)\n\t\t\treturn view.$$(\"next-sheet\").disable();\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tconst sheets = view.$$(\"sheets\");\n\tview.$$(\"bottom-toolbar\").showBatch(\"pager\", sheets.$width != sheets.$view.scrollWidth);\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function setState(view, sheet, state){\n\tconst tab = getSheet(view, sheet);\n\n\tif(state == tab.state || (state == \"visible\" && !tab.state))\n\t\treturn;\n\n\tif(state != \"visible\"){\n\t\tconst visibleSheets = getVisible(view);\n\n\t\t//don't hide last visible tab\n\t\tif(visibleSheets.length == 1 && visibleSheets[0] === tab)\n\t\t\treturn;\n\n\t\t//select the previous sheet in case we hide the selected sheet\n\t\tif(sheet == view._activeSheet)\n\t\t\tshowPrevious(view, sheet);\n\t}\n\n\ttab.state = state;\n\t_filterTabs(view);\n\n\tview.callEvent(\"onSheetStateChange\", [sheet, state]);\n}\n\nfunction _filterTabs(view){\n\tconst tabs = view.$$(\"sheets\");\n\tif(tabs)\n\t\ttabs.filter(obj => {\n\t\t\tconst state = getSheet(view, obj.id).state;\n\t\t\treturn state != \"hidden\" && state != \"veryHidden\";\n\t\t});\n}\n\nexport function add(view, content, name, show){\n\tvar index, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\n\tif(!name || arr.find(view._sheets, sheet => sheet.name == name))\n\t\tname = getNewTitle(view);\n\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname,\n\t\tcontent\n\t});\n\n\tif(view.$$(\"sheets\"))\n\t\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\n\tview._mData.addPage(name);\n\n\tparseToStore(view, name, content, view.config.prepareData);\n\n\tif(show !== false)\n\t\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tif(!name)\n\t\tname = view._activeSheet;\n\tview.$$(\"sheets\").edit(name);\n}\n\nfunction _remove(view){\n\tview.confirm({\n\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t}).then(()=>{\n\t\tremove(view, view._activeSheet);\n\t});\n}\n\nfunction getVisible(view){\n\treturn view._sheets.filter(s => s.state != \"hidden\" && s.state != \"veryHidden\");\n}\n\nfunction showPrevious(view, name){\n\tconst visibleSheets = getVisible(view);\n\n\tlet index = arr.findIndex(visibleSheets, x => x.name == name);\n\t\t\t\n\tlet prevIndex = index - 1;\n\tif(!visibleSheets[prevIndex])\n\t\tprevIndex = 0;\n\tvisibleSheets.splice(index, 1);\n\n\tview.showSheet(visibleSheets[prevIndex].name);\n}\n\nexport function remove(view, name){\n\tif(view._sheets.length > 1){\n\t\tconst visibleSheets = getVisible(view);\n\n\t\t//don't remove last visible tab\n\t\tif(visibleSheets.length == 1 && visibleSheets[0] === getSheet(view, name))\n\t\t\treturn;\n\n\t\t//select the previous sheet in case we remove the selected sheet\n\t\tif(view._activeSheet == name)\n\t\t\tshowPrevious(view, name);\n\n\t\tconst index = arr.findIndex(view._sheets, x => x.name == name);\n\t\tview._sheets.splice(index, 1);\n\t\tview._mData.removePage(name);\n\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview._mData.renamePage(name, newName);\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj, config){\n\tconst active = getSheet(view, view._activeSheet);\n\tactive.content = obj;\n\tactive.state = active.state || \"visible\";\n\n\tconst sheets = webix.copy(view._sheets);\n\n\tconst math = !config || config.math!==false;\n\tconst compactStyles = config && config.compactStyles;\n\n\tsheets.forEach(sheet => {\n\t\tif(sheet.name != view._activeSheet){\n\t\t\tsheet.content.data = getSheetData(view, math, sheet.name);\n\t\t\tsheet.state = sheet.state || \"visible\";\n\t\t\tif(compactStyles)\n\t\t\t\tsheet.content.styles = removeUnusedStyles(sheet.content);\n\t\t\tsheet.content.ranges = view.ranges.serialize(sheet.name);\n\t\t}\n\t});\n\n\treturn sheets;\n}\n\nfunction parseToStore(view, name, obj, prepareData){\n\tview.ranges.parse(obj.ranges, name);\n\n\twebix.extend(obj, {\n\t\tstyles: [],\n\t\tformats: [],\n\t\teditors: []\n\t});\n\n\tconst page = view._mData.getPage(name);\n\tconst data = obj.data.map(arr => {\n\t\tconst invalidValue = webix.isUndefined(arr[2]) || arr[2] === null;\n\n\t\tif(prepareData){\n\t\t\tif(invalidValue)\n\t\t\t\tarr[2] = \"\";\n\t\t\telse {\n\t\t\t\tconst linkRegex = /^=link\\(/i;\n\t\t\t\tif(typeof arr[2] == \"string\" && linkRegex.test(arr[2])){\n\t\t\t\t\t// LINK is deprecated\n\t\t\t\t\tarr[2] = arr[2].replace(linkRegex, \"=HYPERLINK(\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cell = loadCell(view, obj, arr);\n\t\t\t//cell value and type can be changed via types module\n\t\t\tarr[2] = cell.value;\n\t\t\tarr[3] = arr[3] || \"\";\n\t\t\tarr[4] = cell.type;\n\n\t\t\tprepareCell(arr, obj);\n\t\t}\n\t\telse if(invalidValue)\n\t\t\tthrow `unsupported value in ${escapeSheet(name)}!${encode[arr[0]]}${arr[1]}`;\n\n\t\treturn [ arr[0]-1, arr[1]-1, {\n\t\t\tvalue: arr[2],\n\t\t\ttype: arr[4],\n\t\t\tstyle: arr[3],\n\t\t\t$format: checkFormat({ fmt: getFormatFromData(obj, arr) }, \"string\") ? 1 : 0\n\t\t}];\n\t});\n\n\tpage.parse(data, true);\n}\n\nexport function prepareCell(cell, data, update){\n\tconst isDate = cell[4] == \"date\";\n\tif(isDate || update){\n\t\tconst isString = typeof cell[2] == \"string\";\n\n\t\tconst link = update && isString && /^=hyperlink\\(/i.test(cell[2]);\n\n\t\tconst styleProperties = cell[3] ? arr.find(data.styles, style => style[0] == cell[3]) : null;\n\t\tconst styleObj = styleProperties ? styleFromText(styleProperties[1]) : {};\n\n\t\tif((isDate && (!styleProperties || !styleObj.format)) || link){\n\t\t\tlet props = {};\n\n\t\t\tif(link){\n\t\t\t\tcell[3] = \"wss_link\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops = { color: \"#0000ff\", underline: \"underline\" };\n\t\t\t}\n\t\t\telse if(isString && /^=time\\(/i.test(cell[2])){\n\t\t\t\tcell[3] = \"wss_load_time\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops.format = cell[3]+\"_fmt\";\n\t\t\t\tdata.formats.push([props.format, webix.i18n.spreadsheet.formats.timeFormat]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcell[3] = \"wss_load_date\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops.format = \"date\";\n\t\t\t}\n\n\t\t\tif(!arr.find(data.styles, style => style[0] == cell[3]))\n\t\t\t\tdata.styles.push([\n\t\t\t\t\tcell[3],\n\t\t\t\t\tstyleToText({props: webix.extend(styleObj, props, true)})\n\t\t\t\t]);\n\t\t}\n\t}\n}\n\nexport function load(view, obj, excel){\n\tview._loading_data = true;\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\tconst prepareData = view.config.prepareData || excel;\n\n\tif(!obj.sheets && view._activeSheet){\n\t\t//loading into active sheet\n\t\tconst name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\tparseToStore(view, name, obj, prepareData);\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj, prepareData);\n\t}\n\tview._loading_data = false;\n}\n\nexport function prepare(view, obj, prepareData){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\tview._mData = new DataStore({strict: view.config.strict});\n\n\t// first add all pages then parse data in them\n\tobj.sheets.forEach(sheet => {\n\t\tview._mData.addPage(sheet.name);\n\t});\n\n\tobj.sheets.forEach(sheet => {\n\t\tconst content = sheet.content;\n\t\tconst sheetName = sheet.name;\n\n\t\tparseToStore(view, sheetName, content, prepareData);\n\t});\n\n\treset(view, obj);\n\tshow(view, getVisible(view)[0].name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view, name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tconst obj = getSheet(view, name).content;\n\n\t\tview._mPage = view._mData.getPage(name);\n\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function isVisible(view, sheet){\n\tsheet = getSheet(view, sheet);\n\treturn sheet.state != \"hidden\" && sheet.state != \"veryHidden\";\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tconst data = getSheetData(view);\n\n\tlet [rows, cols] = arr.getDimension(data, obj.spans, view.config.rowCount, view.config.columnCount);\n\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tupdateMaxColumn(cols);\n\n\tview.callEvent(\"onReset\", []);\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\")){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\", [{id}]);\n\t}\n}\n\n","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.$$(\"cells\").getItem(id).$height, page: view.getActiveSheet() });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width, page: view.getActiveSheet() });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tload(view,data);\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view,data);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", (r,c) => _adjustRowHeight(view,r,c));\n\tview.attachEvent(\"onCellChange\", (r,c,v,p)=> {\n\t\tif(p == view.getActiveSheet())\n\t\t\t_adjustRowHeight(view,r,c);\n\t});\n}\n\nfunction serialize(view, data, oldZoom){\n\tconst sizes = [];\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.getState().order;\n\tconst order = grid.data.order;\n\n\tconst zoom = oldZoom || view._zoom;\n\n\tconst defWidth = grid.config.columnWidth;\n\tconst defHeight = grid.config.rowHeight;\n\n\tfor (let i = 1; i < columns.length; i++){\n\t\tconst width = Math.ceil(grid.getColumnConfig(columns[i]).width / zoom);\n\t\tif (width && width != defWidth)\n\t\t\tsizes.push([0, i, width]);\n\t}\n\n\tfor (let i = 0; i < order.length; i++){\n\t\tconst height = Math.ceil(grid.getItem(order[i]).$height / zoom);\n\t\tif (height && height != defHeight)\n\t\t\tsizes.push([order[i]*1, 0, height]);\n\t}\n\t\n\tdata.sizes = sizes;\n}\n\nexport function load(view, data){\n\tlet zoom = 1;\n\tif(data.table && data.table.zoom)\n\t\tzoom = data.table.zoom;\n\n\tconst grid = view.$$(\"cells\");\n\tconst defWidth = grid.config.columnWidth;\n\tconst defHeight = grid.config.rowHeight;\n\n\tfor(let i = 1; i <= view.config.rowCount; i++){\n\t\tconst row = view.$$(\"cells\").getItem(i);\n\t\trow.$height = defHeight*zoom;\n\t}\n\n\tconst rowHeight = (webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20) * zoom;\n\tconst rowId = view.getColumn(\"rowId\");\n\trowId.width = 40 * zoom;\n\trowId.header[0].height = rowHeight;\n\n\tfor(let i = 1; i <= view.config.columnCount; i++){\n\t\tconst col = view.getColumn(i);\n\t\tcol.header[0].height = rowHeight;\n\t\tcol.width = defWidth*zoom;\n\t}\n\n\tif (data.sizes){\n\t\tfor (let i=0; i<data.sizes.length; i++){\n\t\t\tconst size = data.sizes[i];\n\t\t\tif (size[0]*1 !== 0){\n\t\t\t\tconst row = view.$$(\"cells\").getItem(size[0]);\n\t\t\t\tif(row) row.$height = size[2]*zoom;\n\t\t\t} else {\n\t\t\t\tconst col = view.getColumn(size[1]);\n\t\t\t\tif(col) col.width = size[2]*zoom;\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh(true);\n}\n\nexport function zoomSizes(view, oldZoom){\n\tconst data = {table:{zoom:view._zoom}};\n\tserialize(view, data, oldZoom);\n\tload(view, data);\n}\n\nfunction _undoResize(view, row, column, value){\n\tconst table = view.$$(\"cells\");\n\tif(row){\n\t\ttable.getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value, page: view.getActiveSheet() });\n\t}\n\telse{\n\t\ttable.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\ttable.refreshSelectArea();\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length - 1; i >= 0; i--){\n\t\t\tlet [row, column, size] = sizes[i];\n\n\t\t\tif(row && name == \"row\" && row >= start.row){\n\t\t\t\tif(inc < 0 && row < start.row - inc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnsizes.push([row*1 + inc, column, size]);\n\t\t\t}\n\t\t\telse if(column && name == \"column\" && column >= start.column){\n\t\t\t\tif(inc < 0 && column < start.column - inc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnsizes.push([row, column*1 + inc, size]);\n\t\t\t}\n\t\t\telse\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\n\t\tif(inc > 0){\n\t\t\t//col/row add: set sizes according to the selected area\n\t\t\tif(name == \"column\"){\n\t\t\t\tfor(let i = 0; i < inc; i++){\n\t\t\t\t\tconst size = arr.find(sizes, arr => arr[1] == start.column + i);\n\t\t\t\t\tif(size)\n\t\t\t\t\t\tnsizes.push([0, start.column + i, size[2]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(let i = 0; i < inc; i++){\n\t\t\t\t\tconst size = arr.find(sizes, arr => arr[0] == start.row + i);\n\t\t\t\t\tif(size)\n\t\t\t\t\t\tnsizes.push([start.row + i, 0, size[2]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(view, row, column){\n\tif(view._loading_data)\n\t\treturn;\n\n\tconst style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tconst grid = view._table;\n\t\tconst item = grid.getItem(row);\n\t\tlet height = item.$height || grid.config.rowHeight;\n\n\t\tgrid.eachColumn(function(col, config){\n\t\t\tconst style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = grid.getSpan(row, col);\n\t\t\t\tlet spanHeight;\n\n\t\t\t\tif(span){\n\t\t\t\t\tconst node = grid.getSpanNode({row:span[0], column:span[1]});\n\t\t\t\t\tbaseWidth = node.offsetWidth;\n\t\t\t\t\tspanHeight = node.offsetHeight;\n\t\t\t\t}\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\tlet textHeight = getTextSize(view, text, style.id, baseWidth).height;\n\n\t\t\t\tif(spanHeight)\n\t\t\t\t\ttextHeight = spanHeight >= textHeight ? 0 : textHeight - spanHeight + height;\n\n\t\t\t\theight = Math.max(height, textHeight);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {numbers} from \"../sheets\";\nimport {zoomStyles} from \"./styles\";\nimport {zoomSizes} from \"./resize\";\n\nconst readyZoom = {};\n\nexport function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"zoom\"){\n\t\t\tzoom(view, value);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n}\n\nexport function zoom(view, newValue, load){\n\tconst grid = view.$$(\"cells\");\n\tconst value = view._zoom || 1;\n\n\tif(newValue == \"in\" || newValue == \"out\")\n\t\tnewValue = getNext(value, newValue == \"in\" ? 1 : -1, numbers);\n\n\tview._zoom = newValue;\n\tgrid.define({ minColumnWidth: 40*newValue });\n\n\tif(view.$$(\"zoom\"))\n\t\tview.$$(\"zoom\").setValue(newValue);\n\n\tif(newValue != value){\n\t\tconst fontSize = webix.skin.$active.fontSize * newValue;\n\t\tconst rowHeight = webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20;\n\t\tconst className = \"webix_ssheet_zoom_\"+newValue.toString().replace(\".\", \"_\");\n\n\t\tgrid.$view.className = grid.$view.className.replace(/ webix_ssheet_zoom_\\w+/,\"\");\n\t\tgrid.define({css: className});\n\n\t\tif(!load){\n\t\t\tzoomSizes(view, value);\n\t\t\tzoomStyles(view);\n\n\t\t\tview.callEvent(\"onZoom\", [newValue, value]);\n\t\t}\n\n\t\tif(!readyZoom[className] && newValue != 1){\n\t\t\treadyZoom[className] = 1;\n\n\t\t\t// cells\n\t\t\twebix.html.addStyle(`\n\t\t\t\t.${className} .webix_hcell, .${className} .webix_cell{\n\t\t\t\t\tfont-size: ${fontSize}px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .sheet_column_0 .webix_cell{\n\t\t\t\t\tpadding: 0 ${12*newValue}px;\n\t\t\t\t}\n\n\t\t\t\t.${className}.webix_ssheet_table .webix_hs_left .webix_hcell.webix_first:before{\n\t\t\t\t\tright: ${4*newValue}px;\n\t\t\t\t\tbottom: ${4*newValue}px;\n\t\t\t\t\tborder-top-width: ${(rowHeight - 8)*newValue}px;\n\t\t\t\t\tborder-right-width: ${(rowHeight - 8)*newValue}px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .webix_cell{\n\t\t\t\t\tpadding: ${2*newValue}px 0px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .webix_cell div:first-child{\n\t\t\t\t\tmargin: 0 ${12*newValue}px;\n\t\t\t\t}\n\t\t\t`);\n\n\t\t\t// icons\n\t\t\twebix.html.addStyle(`\n\t\t\t\t.${className} .webix_cell.ss_filter, .${className} .webix_cell.ss_editor{\n\t\t\t\t\tpadding-right: ${16*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .ssheet_filter_sign, .${className} .webix_cell.ss_editor:after{\n\t\t\t\t\tfont-size: ${20*newValue}px;\n\t\t\t\t\tright: ${6*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_cell.ss_filter.ss_editor:after{\n\t\t\t\t\tright: ${28*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_cell.ss_filter.ss_editor{\n\t\t\t\t\tpadding-right: ${36*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_lock:before{\n\t\t\t\t\tfont-size: ${fontSize}px;\n\t\t\t\t}\n\t\t\t\t.${className} .ssheet_commented_sign:before{\n\t\t\t\t\tborder-top-width: ${8*newValue}px;\n\t\t\t\t\tborder-left-width: ${8*newValue}px;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table = {\n\t\tzoom: view._zoom\n\t};\n}\n\nexport function load(view, data){\n\tlet value = 1;\n\tif(data.table && data.table.zoom)\n\t\tvalue = data.table.zoom;\n\n\tzoom(view, value, true);\n}\n\nexport function getNext(value, step, numbers) {\n\tconst index = numbers.indexOf(value);\n\n\tif(index != -1)\n\t\treturn numbers[index + step] || value;\n\n\tlet nextValue;\n\tfor(let i = 0; i < numbers.length; i++){\n\t\tif(numbers[i] > value){\n\t\t\tif(step < 0){\n\t\t\t\tif(--i == -1)\n\t\t\t\t\treturn value;\n\t\t\t}\n\t\t\tnextValue = numbers[i];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(step < 0 && !nextValue)\n\t\tnextValue = numbers[numbers.length - 1];\n\n\treturn nextValue || value;\n}","import {getNext} from \"../operations/zoom\";\n\nwebix.protoUI(\n\t{\n\t\tname: \"ssheet-zoom\",\n\t\t$cssName: \"counter webix_ssheet_zoom\",\n\t\t$init: function() {\n\t\t\tthis.attachEvent(\"onAfterRender\", () => {\n\t\t\t\tthis.$setValue(this.config.value);\n\t\t\t\tthis.getInputNode().readOnly = true;\n\t\t\t\twebix.event(this.$view.firstChild, \"keydown\", e =>\n\t\t\t\t\twebix.html.preventEvent(e)\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\t$setValue: function(value) {\n\t\t\tthis.getInputNode().value = parseInt(value * 100, 10) + \"%\";\n\t\t},\n\t\tshift: function(step, config) {\n\t\t\tconst v = this.config.value;\n\t\t\tconst arr = this.config.numbers;\n\n\t\t\tconst value = getNext(v, step, arr);\n\t\t\tthis.setValue(value, config);\n\t\t},\n\t},\n\twebix.ui.counter\n);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst view = webix.$$(this.config.node).queryView(a => a.name === \"spreadsheet\", \"parent\");\n\t\tconst format = getDateEditFormat(view, this.config.row.id, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: view => {\n\t\tconst range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range))\n\t\t\t\tview.splitCell();\n\t\t\telse {\n\t\t\t\tconst values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: view => view.undo(),\n\tredo: view => view.redo(),\n\t\"hide-gridlines\": view => view.hideGridlines(\"toggle\"),\n\t\"hide-headers\": view => view.hideHeaders(\"toggle\"),\n\t\"freeze-columns\": view => view.freezeColumns(),\n\t\"freeze-rows\": view => view.freezeRows(),\n\t\"increase-decimals\": view => changeAreaDecimals(view, 1),\n\t\"decrease-decimals\": view => changeAreaDecimals(view, -1),\n\t\"increase-indent\": view => view.callEvent(\"onStyleSet\", [\"indent\", 1]),\n\t\"decrease-indent\": view => view.callEvent(\"onStyleSet\", [\"indent\", -1]),\n\t\"show-formulas\": view => view.showFormulas(\"toggle\"),\n\t\"print-borders\": view => view.showPrintBorders(\"toggle\"),\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"'Open Sans', sans-serif\", value:\"Open Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"], neighbors:true},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"], neighbors:true},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\treturn [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"underline\": \"underline\",\n\t\"strike\": \"strike\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+(config.icon||config.name)+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100, view:\"combo\"});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 70, view:\"text\", icon: \"wxi-menu-down\", css: \"webix_ssheet_text\",\n\t\t\ton: {\n\t\t\t\tonItemClick: function(){\n\t\t\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\t\t\tif(!suggest.isVisible())\n\t\t\t\t\t\tsuggest.show(this.getInputNode());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"underline\": function(){\n\t\treturn ui.button({name: \"underline\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"strike\": function(){\n\t\treturn ui.button({name: \"strike\",label: \"S\",css: \"webix_ssheet_strike\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 70});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t},\n\t\"show-formulas\": function(){\n\t\treturn ui.toggleButton({name: \"show-formulas\"});\n\t},\n\t\"print-borders\": function(){\n\t\treturn ui.toggleButton({name: \"print-borders\", icon:\"borders-no\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(readonly){\n\tconst sizes = calcButtons();\n\tconst titleHeight = toolbarSizes.titleHeight;\n\n\tif(readonly)\n\t\treturn [\n\t\t\t{\n\t\t\t\tpadding: 3,\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{$button: \"excel-export\"},\n\t\t\t\t\t\t\t{$button: \"print\"},\n\t\t\t\t\t\t\t{$button: \"print-borders\"}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{view: \"ssheet-separator\"},\n\t\t\t{}\n\t\t];\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"hide-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"},\n\t\t\t\t\t\t\t\t{$button: \"print-borders\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*4+6},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"underline\"},\n\t\t\t\t\t\t\t\t{$button: \"strike\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"},\n\t\t\t\t\t\t{$button: \"increase-indent\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\t\t\t\t\t\t{$button: \"wrap\"},\n\t\t\t\t\t\t{$button: \"decrease-indent\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"show-formulas\"},\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\nimport {getStyle, getFormat} from \"./operations/styles\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"underline\",\"strike\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\",\"increase-indent\",\"decrease-indent\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\"){\n\t\t\tif(action.name)\n\t\t\t\tupdateValue(view, action.name, action.value);\n\t\t\telse\n\t\t\t\tsetValues(view, view.getSelectedId(true));\n\t\t}\n\t});\n\n\tlet elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements(view.config.readonly);\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tconst bar = {\n\t\tview: webix.env.$customScroll ? \"scrollview\" : \"ssheet-toolbar-scrollview\",\n\t\tscroll: \"x\",\n\t\tbody: {\n\t\t\tview:\"toolbar\",\n\t\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\t\tid:\"bar\",\n\t\t\tpadding:0,\n\t\t\telements,\n\t\t\ton: {\n\t\t\t\tonChange: function (value, old, config){\n\t\t\t\t\tif(config == \"user\"){\n\t\t\t\t\t\tconst source = this.$eventSource;\n\t\t\t\t\t\tconst name = source.config.name;\n\t\t\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\t\t\tvalue = \"\";\n\n\t\t\t\t\t\tconst size = name == \"font-size\";\n\t\t\t\t\t\tif((size || name == \"font-family\") && (!value || (size && isNaN(value))))\n\t\t\t\t\t\t\treturn source.setValue(old);\n\t\t\t\t\t\telse if(size){\n\t\t\t\t\t\t\tconst maxSize = Math.floor(400 / 0.75); // 400 pt - max excel font size; divide 0.75 - pt to px conversion\n\t\t\t\t\t\t\tconst limited = Math.max(1, Math.min(maxSize, value));\n\t\t\t\t\t\t\tif (limited != value){\n\t\t\t\t\t\t\t\tvalue = limited;\n\t\t\t\t\t\t\t\tsource.setValue(value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvalue += \"px\";\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonItemClick: function (id){\n\t\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\t\tif (actions[viewId])\n\t\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\t\telse\n\t\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst barStyles = getBarStyles(view, selected);\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}\n\nfunction getBarStyles(view, selected){\n\tconst dropdowns = [\n\t\t\"font-family\",\n\t\t\"font-size\",\n\t\t\"text-align\",\n\t\t\"vertical-align\",\n\t\t\"format\",\n\t\t\"background\",\n\t\t\"color\"\n\t];\n\n\tconst cell = selected[0];\n\tconst barStyles = getCellStyles(view, cell);\n\n\tfor(let i = 1; i < selected.length; i++){\n\t\tconst cellStyle = getCellStyles(view, selected[i]);\n\n\t\tfor(let k = dropdowns.length-1; k >= 0; k--){\n\t\t\tconst property = dropdowns[k];\n\t\t\tif(barStyles[property] != cellStyle[property]){\n\t\t\t\tdelete barStyles[property];\n\t\t\t\tdropdowns.splice(k, 1);\n\t\t\t}\n\t\t}\n\n\t\tif(!dropdowns.length)\n\t\t\tbreak;\n\t}\n\n\treturn barStyles;\n}\n\nfunction getCellStyles(view, cell){\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span)\n\t\t[cell.row, cell.column] = span;\n\n\tconst obj = getStyle(view, cell);\n\tconst styles = obj ? webix.copy(obj.props) : {};\n\n\tfor (let i in defaultStyles)\n\t\tif(!styles[i])\n\t\t\tstyles[i] = defaultStyles[i];\n\n\tstyles[\"font-size\"] = styles[\"font-size\"].replace(\"px\", \"\");\n\n\tconst format = getFormat(view, cell.row, cell.column) || \"common\";\n\tstyles.format = isCustom(format) ? \"custom\" : format;\n\n\treturn styles;\n}\n","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tconst grid = view.$$(\"cells\");\n\tlet width = 25;\n\tconst columnWidth = grid.getColumnConfig(column).width;\n\n\tgrid.eachRow(function(row) {\n\t\tconst span = grid.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\t\t\tconst zoom = view._zoom;\n\n\t\t\tif(view.getCellEditor(row, column))\n\t\t\t\tsize.width += 18 * zoom;\n\t\t\tif(view.getCellFilter(row, column))\n\t\t\t\tsize.width += 18 * zoom;\n\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tgrid.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\n\t\t\t// if there is text wrap in cell we need to know width to get correct height\n\t\t\tlet width = this.getColumnConfig(column).width;\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start, end, view){\n\tif(!view._table.config.header) return;\n\n\tconst grid = view._table;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\n\tconst columns = grid.config.columns;\n\tconst firstColumn = columns[1].id;\n\n\tif(sc == \"rowId\"){\n\t\tif(sc == ec){\n\t\t\tstart.column = sc = firstColumn;\n\t\t\tend.column = ec = columns[ columns.length-1 ].id;\n\t\t}\n\t\telse\n\t\t\tstart.column = sc = firstColumn;\n\t}\n\telse if(ec == \"rowId\")\n\t\tend.column = ec = firstColumn;\n\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tgrid.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tgrid.removeCellCss(row, \"rowId\", css, true);\n\t\telse\n\t\t\tgrid.addCellCss(row, \"rowId\", css, true);\n\t});\n\twebix.delay(() => grid.refresh());\n\n\tgrid.eachColumn(function(col){\n\t\tconst node = grid.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n\n\tif(view.$$(\"navigation\")){\n\t\tlet range = \"\";\n\n\t\tif(sc && ec){\n\t\t\tif(!sr){\n\t\t\t\tconst order = grid.data.order;\n\t\t\t\tsr = order[0];\n\t\t\t\ter = order[order.length-1];\n\t\t\t}\n\t\t\trange = toRange(sr, sc, er, ec);\n\t\t\tconst cells = range.split(\":\");\n\t\t\tif(cells[0] == cells[1])\n\t\t\t\trange = cells[0];\n\t\t}\n\n\t\tview.$$(\"navigation\").setValue(range);\n\t}\n}","import group from \"./undo_group\";\nimport {find, findIndex} from \"../helpers/array\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent, page, innerCall){\n\tconst activeSheet = view.getActiveSheet();\n\tif(!page)\n\t\tpage = activeSheet;\n\n\tconst table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true, page, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tif(page == activeSheet){\n\t\t\tconst objrow = view._locks[row] = view._locks[row] || {};\n\t\t\tobjrow[column] = mode;\n\t\t\tif (mode)\n\t\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\t\telse\n\t\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\t\t}\n\t\telse{\n\t\t\tpage = find(view._sheets, sheet => sheet.name == page);\n\t\t\tif(page){\n\t\t\t\tconst locked = page.content.locked; \n\t\t\t\tif(locked){\n\t\t\t\t\tconst locked = page.content.locked;\n\t\t\t\t\tconst index = findIndex(locked, cell => cell[0] == row && cell[1] == column);\n\t\t\t\t\tif(mode){\n\t\t\t\t\t\tif(index == -1)\n\t\t\t\t\t\t\tlocked.push([row, column]);\n\t\t\t\t\t}\n\t\t\t\t\telse if(index != -1)\n\t\t\t\t\t\tlocked.splice(index, 1);\n\t\t\t\t}\n\t\t\t\telse if(!locked && mode)\n\t\t\t\t\tpage.content.locked = [[row, column]];\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!innerCall)\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler, master){\n\tfor (let x = start.row; x <= end.row; x++)\n\t\tfor (let y = start.column; y <= end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column, page){\n\tif(!page || page == view.getActiveSheet())\n\t\treturn view._locks[row]?(view._locks[row][column]||false):false;\n\telse{\n\t\tpage = find(view._sheets, sheet => sheet.name == page);\n\t\tif(page)\n\t\t\treturn !!find(page.content.locked, cell => cell[0] == row && cell[1] == column);\n\t\treturn false;\n\t}\n}\n\nexport function serialize(view,data){\n\tconst locked = [];\n\tfor(let row in view._locks){\n\t\tfor(let column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tconst locked = data.locked;\n\tif(locked)\n\t\tfor(let i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1], true, true);\n}\n\nfunction lock(view){\n\tconst block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tconst mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row >= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {save} from \"./save\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tparse(view, data);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view, data);\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\" && options.page == view.getActiveSheet())\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(view, options.name, options.inc, options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nfunction parse(view, data){\n\tif (data.spans)\n\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\tvar span = data.spans[i];\n\t\t\taddSpan( view,\n\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\tspan[2]*1,\n\t\t\t\tspan[3]*1,\n\t\t\t\ttrue \n\t\t\t);\n\t\t}\n}\n\nexport function serialize(view, data){\n\tvar spans = [];\n\tvar pull = view.$$(\"cells\").getSpan();\n\tif (pull){\n\t\tfor (var rid in pull){\n\t\t\tvar row = pull[rid];\n\t\t\tfor (var cid in row){\n\t\t\t\tvar span = row[cid];\n\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t}\n\t\t}\n\n\t\tdata.spans = spans;\n\t}\n\treturn data;\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\t\tlet css = ( obj && obj.style ) || \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\tpage: view.getActiveSheet(),\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\tlet extraCss = [];\n\tif(view.getCellEditor(row, column))\n\t\textraCss.push(\"ss_editor\");\n\tif(view.getCellFilter(row, column))\n\t\textraCss.push(\"ss_filter\");\n\treturn extraCss.join(\" \");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, view, data, spanData){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tconst item = arr.find(data, arr => arr[0] == span[0] && arr[1] == span[1]);\n\t\t\tif(item)\n\t\t\t\tspanData.push(item);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {isDateInvalid} from \"../operations/formats\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nexport const conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() === b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() !== b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\ta = a.toString();\n\t\t\tb = b.toString();\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\ta = a.toString();\n\t\t\tb = b.toString();\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {setSpanCss} from \"./spans\";\nimport {conditions} from \"../helpers/conditional\";\nimport {getType} from \"./types\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: createRules(),\n\t\tadd: function(rId, cId, cond, val, style){\n\t\t\tadd.apply(this, [view, rId, cId, cond, val, style]);\n\t\t},\n\t\tupdate: function(r, c, data){\n\t\t\tupdate.apply(this, [view, r, c, data]);\n\t\t},\n\t\tremove,\n\t\tget,\n\t\tparse,\n\t\tserialize,\n\t\tclear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction createRules(){\n\tconst rules = webix.copy(conditions);\n\trules.number = rules.number.concat([\n\t\t{ id:\"between\", handler: function(a, b){\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", handler: function(a, b){\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]);\n\treturn rules;\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\" && value.length > 1){\n\t\t\tvalue = view._mData.getStore().exec(value.substring(1), view._mPage.getContext());\n\t\t\tif(value === null)\n\t\t\t\tvalue = \"\";\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tconst collection = view.conditions.get(cell.row, cell.column);\n\t\t\tif(collection)\n\t\t\t\tfor (let i = 0; i < collection.length; i++)\n\t\t\t\t\tsetSpanCss(view, cell.row, cell.column, collection[i][2], false);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nexport function getConditionCss(view, row, column, rendered){\n\tlet css = \"\";\n\n\tif (!view.conditions._empty){\n\t\tconst collection = view.conditions.get(row, column);\n\t\tif(collection){\n\t\t\tconst span = view.$$(\"cells\").getSpan(row, column);\n\t\t\tlet value = view.getCellValue(row,column,false);\n\t\t\tif(!value && value !== 0)\n\t\t\t\tvalue = \"\";\n\n\t\t\tlet type = getType(view, row, column);\n\t\t\tif(!type || type == \"string\")\n\t\t\t\ttype = \"text\";\n\n\t\t\tfor (let i = collection.length - 1; i >= 0; i--){\n\t\t\t\tlet currentValue = value;\n\t\t\t\tconst rule = collection[i][0];\n\t\t\t\tconst handlers = view.conditions.handlers;\n\t\t\t\tlet handler;\n\n\t\t\t\tlet checkOrder = [\"text\", type, \"number\", \"date\"];\n\t\t\t\tcheckOrder = checkOrder.filter((v, i) => checkOrder.indexOf(v) == i);\n\n\t\t\t\tfor(let k = 0; k < checkOrder.length; k++){\n\t\t\t\t\tconst checkType = checkOrder[k];\n\n\t\t\t\t\thandler = arr.find(handlers[checkType], obj => obj.id == rule);\n\t\t\t\t\tif(handler){\n\t\t\t\t\t\thandler = handler.handler;\n\t\t\t\t\t\tif(checkType == \"text\" && rule != \"equal\" && rule != \"notEqual\")\n\t\t\t\t\t\t\tcurrentValue = rendered;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet compare = collection[i][1];\n\t\t\t\tif(webix.isArray(compare))\n\t\t\t\t\tcompare = {\n\t\t\t\t\t\tstart: getCellValue(view, compare[0]),\n\t\t\t\t\t\tend: getCellValue(view, compare[1])\n\t\t\t\t\t};\n\t\t\t\telse\n\t\t\t\t\tcompare = getCellValue(view, compare);\n\n\t\t\t\tif(!css && handler && handler(currentValue, compare)){\n\t\t\t\t\tcss = collection[i][2];\n\t\t\t\t\tif(!span)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], false);\n\t\t\t}\n\t\t}\n\t}\n\treturn css;\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\t//backward compatibility\n\tconst oldConditions = {\n\t\t\">\": \"greater\",\n\t\t\"<\": \"less\",\n\t\t\"=\": \"equal\",\n\t\t\"!=\": \"notEqual\",\n\t\t\"<>\": \"between\"\n\t};\n\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tconst c = data[i];\n\t\tconst collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tc[2] = oldConditions[ c[2] ] || c[2];\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(view, row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\n\tnewData.map(item => _normalizeValue(view, item) );\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(view, rowId, columnId, condition, value, style){\n\tconst collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push( _normalizeValue(view, [condition, value, style]) );\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}\n\nfunction _normalizeValue(view, condition){\n\tconst val = condition[1];\n\tif(val[0] == \"=\")\n\t\tcondition[1] = view._mData.getStore().parse(val).source; //fixes formula\n\treturn condition;\n}","import {getSheet} from \"../sheets\";\nimport {isCell, adress, range as getRange} from \"../helpers/column_names\";\n\nfunction error(view, silent){\n\tif(!silent)\n\t\tview.alert({\n\t\t\ttype: \"alert-error\",\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"error-link\"]\n\t\t});\n\treturn false;\n}\n\nexport function showCells(view, ref, silent) {\n\ttry {\n\t\tlet r1, r2, c1, c2, sheet;\n\n\t\tlet cellRef = ref.split(\"!\");\n\t\tswitch(cellRef.length){\n\t\t\tcase 1:\n\t\t\t\t[cellRef] = cellRef;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\t[sheet, cellRef] = cellRef;\n\t\t\t\tif(sheet.indexOf(\" \") != -1 && (sheet[0] != \"'\" || sheet[sheet.length - 1] != \"'\"))\n\t\t\t\t\treturn error(view, silent);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn error(view, silent);\n\t\t}\n\n\t\tif(isCell(cellRef))\n\t\t\t[r1, c1] = adress(cellRef);\n\t\telse{\n\t\t\tconst rangePos = getRange(ref, view);\n\t\t\tif(rangePos)\n\t\t\t\t[r1, c1, r2, c2, sheet] = rangePos;\n\t\t\telse\n\t\t\t\treturn error(view, silent);\n\t\t}\n\n\t\tif(sheet){\n\t\t\tsheet = sheet.replaceAll(\"'\", \"\");\n\t\t\tif(!getSheet(view, sheet))\n\t\t\t\treturn error(view, silent);\n\t\t\tif(sheet != view.getActiveSheet())\n\t\t\t\tview.showSheet(sheet);\n\t\t}\n\n\t\tconst grid = view.$$(\"cells\");\n\t\tgrid.showCell(r1, c1);\n\t\tgrid.addSelectArea(\n\t\t\t{ row: r1, column: c1 },\n\t\t\t{ row: r2 || r1, column: c2 || c1 }\n\t\t);\n\n\t\treturn true;\n\t}\n\tcatch(err){\n\t\treturn error(view, silent);\n\t}\n}","import * as cop from \"./operations/column_operations\";\nimport {getConditionCss} from \"./operations/conditional_formats\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\nimport {showCells} from \"./operations/show_cells\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:40,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true,\n\t\tonClick:{ \n\t\t\t\"webix_ssheet_ref\" : event => {\n\t\t\t\tconst ref = event.target.getAttribute(\"data-ref\").replaceAll(\"&#x27;\", \"'\");\n\t\t\t\tif(showCells(view, ref))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"pointermove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tif (e.pointerType !== \"mouse\") return;\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\tgrid.$anyKey = false;\n\t\tconst old = view.getCellValue(ed.row, ed.column);\n\t\t//ignore empty cells\n\t\tif (old === \"\" && st.value === \"\") return;\n\n\t\tif (st.value != old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onAfterEditStart\", ({row, column}) => {\n\t\tlet v = view.getCellValue(row, column);\n\n\t\tif(grid.$anyKey){\n\t\t\tgrid.$anyKey = false;\n\t\t\tv = \"\";\n\t\t}\n\n\t\tgrid.getEditor().setValue(v);\n\t});\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tcop.highlightColRow(\n\t\t\tfinalStep ? start : webix.copy(start),\n\t\t\tfinalStep ? end : webix.copy(end),\n\t\t\tview\n\t\t);\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onAfterColumnShow\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tconst target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tconst focus = webix.UIManager.getFocus();\n\t\t\tconst need_focus = focus &&\n\t\t\t\t!focus.config.saveFocus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tgrid.attachEvent(\"onMoveSelection\", (cell, mode, details) => {\n\t\tif(cell.column == \"rowId\" && mode == \"left\" && details.ctrl)\n\t\t\tcell.column = 1;\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, _v, column, valueOnly){\n\tconst formulasMode = view.$$(\"cells\").config.showFormulas && !valueOnly;\n\n\tconst col = column.id;\n\tconst row = obj.id;\n\n\tif (!view._mPage) return \"\";\n\tconst cell = view._mPage.getCell(row-1, col-1);\n\n\tlet value = cell ? cell.value : \"\";\n\tconst format = cell ? cell.format : \"\";\n\n\tconst math = view.getCellValue(row, col);\n\n\tif(formulasMode)\n\t\tvalue = math;\n\n\tif(math != value){\n\t\tconst locale = webix.i18n.spreadsheet.table;\n\t\tif(value == \"#REF!\")\n\t\t\tvalue = locale[\"math-ref-error\"];\n\t\telse if(value == \"#ERROR\")\n\t\t\tvalue = locale[\"math-error\"];\n\t}\n\n\tlet css = \"\";\n\tconst text = (typeof value == \"string\" && value.trim()[0] == \"+\") || (!value && value !== 0) || isNaN(value);\n\tconst invalidDate = !formulasMode && fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (typeof value == \"boolean\" || !text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue *= 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue *= 1;\n\t}\n\n\t//print only cell values (td with position:relative ignores borders while printing)\n\tif(view._print && !(value || value === 0))\n\t\treturn \"\";\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${view._print ? \"\" : extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\",\n\t\theader:\"\",\n\t\twidth:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t},\n\t\t\tcssFormat:function(value, obj, row, column){\n\t\t\t\tconst rendered = getRenderedValue(view, row, column);\n\t\t\t\tconst cell = view._mPage.getCell(row-1, column-1);\n\n\t\t\t\tlet css = cell ? (cell.style || \"\") : \"\";\n\n\t\t\t\tconst conditional = getConditionCss(view, row, column, rendered);\n\t\t\t\tif(conditional)\n\t\t\t\t\tcss += (css ? \" \" : \"\") + conditional;\n\n\t\t\t\tconst borders = view._printBorders.$render;\n\t\t\t\tif(borders){\n\t\t\t\t\tif(borders.cols[column])\n\t\t\t\t\t\tcss += (css ? \" \" : \"\") + \"webix_ss_print_border_right\";\n\t\t\t\t\tif(borders.rows[row])\n\t\t\t\t\t\tcss += (css ? \" \" : \"\") + \"webix_ss_print_border_bottom\";\n\t\t\t\t}\n\n\t\t\t\treturn css;\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\nexport function getRenderedValue(view, row, col){\n\tconst htmlFilter = /<[^>]*>/gi;\n\treturn cell_template(view, {id: row}, null, null, {id: col}, true).replace(htmlFilter, \"\");\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tconst grid = view.$$(\"cells\");\n\tconst key = webix.env.isMac ? \"command\" : \"ctrl\";\n\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => dialog(\"print\", view, e), grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\tconst code = ev.which || ev.keyCode;\n\t\t\tconst f2 = code == 113;\n\n\t\t\t//ignore shift key, f1, f3 - f12 (f2 - edit)\n\t\t\tif (code == 16 || (code >= 112 && code <= 123 && !f2)) return;\n\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && f2))\n\t\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && !grid.callEvent(\"onBeforeLiveEditor\", [sel[0]])))\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tconst redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\n\t\tconst strike = webix.env.isMac ? \"command-shift-x\" : \"ctrl-alt-s\";\n\t\twebix.UIManager.addHotKey(strike, () => styleHotKey(view, \"strike\"), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-add\", (v, e) => zoom(view, \"in\", e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-=\", (v, e) => zoom(view, \"in\", e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-subtract\", (v, e) => zoom(view, \"out\", e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-0\", (v, e) => zoom(view, 1, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-`\", () => view.showFormulas(\"toggle\"), grid);\n\t}\n}\n\nfunction del(view) {\n\tif(!view.$$(\"cells\").getEditor())\n\t\tgroup.set(function(){\n\t\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\t\tview.refresh();\n\t\t});\n}\n\nfunction zoom(view, value, e) {\n\tview.zoom(value);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"underline\");\n\treturn webix.html.preventEvent(e);\n}\n\nfunction dialog(id, view, e) {\n\tview.callEvent(\"onCommand\",[{id}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr]||attr;\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {methods} from \"@xbs/muon\";\n\nlet methodsName = [];\nfor(let name in methods)\n\tmethodsName.push(name);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\ticon: \"wxi-menu-down\",\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: function(){\n\t\t\t\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\t\t\t\tif(!suggest.isVisible())\n\t\t\t\t\t\t\tsuggest.show(this.getInputNode());\n\t\t\t\t\t},\n\t\t\t\t\tonChange: (val, oldVal, config) => {\n\t\t\t\t\t\tif(config == \"user\" && val !== \"\")\n\t\t\t\t\t\t\tview.showCell(val);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsuggest: {\n\t\t\t\t\tview:\"ssheet-suggest-labels\",\n\t\t\t\t\tcss: \"webix_ssheet_nav_suggest\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttemplate: \"<span class='webix_ssheet_left'>#name#</span><span class='webix_ssheet_right'>#value#</span>\",\n\t\t\t\t\t\twidth: 250\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonBeforeShow: function(){\n\t\t\t\t\t\t\tconst data = view.ranges.serialize(view.getActiveSheet()).map(r => ({name: r[0], value: r[1]}));\n\n\t\t\t\t\t\t\tif(!data.length)\n\t\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t\tconst list = this.getList();\n\t\t\t\t\t\t\tlist.clearAll();\n\t\t\t\t\t\t\tlist.parse(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdata: []\n\t\t\t\t},\n\t\t\t\twidth: 150,\n\t\t\t\tid: \"navigation\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"ssheet-separator\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:65\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tid:\"formulaButton\",\n\t\t\t\tlabel: \"f(x)\",\n\t\t\t\tautowidth:true,\n\t\t\t\tpopup: {\n\t\t\t\t\tview: \"popup\",\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tif(!view.getSelectedId()) return false;\n\t\t\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\t\t\tconst table = this.getBody();\n\t\t\t\t\t\t\t\tif(table.unselect) table.unselect();\n\t\t\t\t\t\t\t\ttable.scrollTo(0,0);\n\t\t\t\t\t\t\t\tconst filter = table.getFilter(\"value\");\n\t\t\t\t\t\t\t\tfilter.value = \"\";\n\t\t\t\t\t\t\t\tfilter.focus();\n\t\t\t\t\t\t\t\ttable.filterByAll();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHide: function(){\n\t\t\t\t\t\t\tview.$$(\"liveEditor\").focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\twidth: 200,\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datatable\",\n\t\t\t\t\t\tsaveFocus: true, //don't move focus to spreadsheet table\n\t\t\t\t\t\tscroll:\"y\",\n\t\t\t\t\t\tdata: methodsName,\n\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"value\",\n\t\t\t\t\t\t\t\theader: [{ content: \"textFilter\" }],\n\t\t\t\t\t\t\t\tfillspace: true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: function (id) {\n\t\t\t\t\t\t\t\tinsertFormula(view, this, id);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonKeyPress: function(code){\n\t\t\t\t\t\t\t\tif(code == 27)\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\telse if(code == 13){\n\t\t\t\t\t\t\t\t\tconst sel = this.getSelectedId();\n\t\t\t\t\t\t\t\t\tif(sel)\n\t\t\t\t\t\t\t\t\t\tinsertFormula(view, this, sel.row);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nexport function fillEditor(view, cell, clear){\n\tconst editor = view.$$(\"liveEditor\");\n\tif(!(editor && cell)) return;\n\tconst disabled = disableEditor(view, cell.row, cell.column);\n\teditor.config.activeCell = cell;\n\teditor.setValue( clear ? \"\" : editor.getCellValue(cell.row, cell.column) );\n\n\tif(!view._rangeDialog)\n\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(view, st, en, a); };\n\n\treturn !disabled;\n}\n\nfunction disableEditor(view, row, column){\n\tconst editor = view.$$(\"liveEditor\");\n\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\tif(disabled)\n\t\teditor.disable();\n\telse\n\t\teditor.enable();\n\treturn disabled;\n}\n\nfunction pasteRange(view, st, en, cell){\n\tconst editor = view.$$(\"liveEditor\");\n\tconst updateRange = editor._update_range;\n\tlet cursor = editor.getInputNode().selectionStart;\n\n\tlet sheet = \"\";\n\tif(editor._activeMath){\n\t\tconst activeSheet = view.getActiveSheet();\n\t\tif(editor._activeMath != activeSheet)\n\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t}\n\n\tlet range;\n\tif(st == en){\n\t\tconst colon = editor.getValue()[ (updateRange ? updateRange.pos : cursor)-1 ] == \":\";\n\t\trange = colon ? st : sheet+st;\n\t}\n\telse\n\t\trange = `${sheet+st}:${en}`;\n\n\tif(updateRange && updateRange.pos == cursor - updateRange.len){\n\t\teditor.setRange(range, true);\n\t\tcursor = editor._update_range.pos + range.length;\n\t}\n\telse if(editor.expectOperator()){\n\t\teditor.setRange(range);\n\t\tcursor += range.length;\n\t}\n\telse\n\t\treturn endEdit(view, cell);\n\n\teditor.focus();\n\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\teditor.paintValue();\n\n\treturn false;\n}\n\nfunction endEdit(view, st){\n\tconst editor = view.$$(\"liveEditor\");\n\tif (editor.isEnabled()){\n\t\tconst cell = editor.config.activeCell;\n\t\teditor.showActiveSheet();\n\t\teditor.updateCellValue(cell);\n\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t}\n\treturn true;\n}\n\nfunction insertFormula(view, table, id){\n\tconst editor = view.$$(\"liveEditor\");\n\tconst formula = table.getItem(id).value;\n\tconst value = editor.getValue();\n\n\tlet newValue = formula + \"(\";\n\n\tif(value.indexOf(\"=\") == 0)\n\t\tnewValue = value + (editor.expectOperator(true) ? \"\" : \"+\") + newValue;\n\telse\n\t\tnewValue = \"=\" + newValue;\n\n\ttable.getParentView().hide();\n\teditor.setValue(newValue);\n}\n\nfunction ready(view){\n\tconst editor = view.$$(\"liveEditor\");\n\tconst nav = view.$$(\"navigation\");\n\tconst grid = view._table;\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tgrid.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tconst mode = grid.$anyKey;\n\t\tgrid.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tgrid.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tgrid.attachEvent(\"onItemDblClick\", function(cell){\n\t\tif(view.getCellEditor(cell.row, cell.column))\n\t\t\tthis.edit(cell);\n\t\telse\n\t\t\tstartEdit(this, cell, false);\n\t});\n\n\tgrid.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v,p) => {\n\t\tif(p == view.getActiveSheet()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\t\teditor.setValue(v);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", data => {\n\t\tif (!view.$handleSelection)\n\t\t\tfillEditor(view, data[0]);\n\t});\n\n\tview.attachEvent(\"onChange\", mode => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", name => {\n\t\tif(view._rangeDialog)\n\t\t\treturn;\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tgrid.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(view, st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tnav.setValue(\"\");\n\t\t\t\tclearEditor();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => {\n\t\tif(!view._rangeDialog)\n\t\t\tview.$handleSelection = null;\n\t});\n\tview.$$(\"cells\").attachEvent(\"onFocus\", ()=>{\n\t\t//ignore table clipboard logic\n\t\tif(editor._activeMath){\n\t\t\twebix.delay(()=>editor.focus());\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tif(name == \"paste\")\n\t\t\treturn fillEditor(view, cell);\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(view, options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c, v , p) => {\n\t\tif(p == view.getActiveSheet())\n\t\t\tupdateEditor(r, c);\n\t});\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor(view, {row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(view, cell, clear)){\n\t\t\teditor.focus();\n\n\t\t\tif(!clear){\n\t\t\t\teditor.paintValue();\n\n\t\t\t\tconst input = editor.getInputNode();\n\t\t\t\tconst symbols = input.value.length;\n\t\t\t\tinput.setSelectionRange(symbols, symbols);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=> {\n\t\t\t\tthis.$hide();\n\t\t\t\twebix.UIManager.setFocus(this.view);\n\t\t\t});\n\t\t\tthis.$dialog.attachEvent(\"onShow\", ()=> {\n\t\t\t\twebix.UIManager.setFocus(this.$dialog);\n\t\t\t});\n\t\t}\n\t\telse if(this.$dialog.isVisible())\n\t\t\treturn;\n\n\t\tconst form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tconfig = webix.copy(config);\n\n\tconst bar = config.type == \"bar\";\n\tif(bar && config.horizontal)\n\t\tconfig.type = \"barH\";\n\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (bar)\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n}\n\nexport function parseImage(value){\n\tif (value && typeof value == \"string\" && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && typeof value == \"string\" && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\tconst result = {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\n\t\tif(result.type == \"barH\"){\n\t\t\tresult.type = \"bar\";\n\t\t\tresult.horizontal = 1;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../mathematics/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\t\tconst save = this.view.config.save;\n\t\tconst server = (save && save.images) || null;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\tonBeforeFileAdd: function(file){\n\t\t\t\t\t\t\tif (!this.config.upload){\n\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\t\t\t\t\t\t\treader.readAsDataURL(file.file);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tthis.getFormView().elements.preview.setHTML(\"\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonFileUpload: function(item, response){\n\t\t\t\t\t\t\tthis.getFormView().elements.url.setValue(response.imageURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.cell;\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\n\t\tthis.view.callEvent(\"onUIEditStart\", [this.viewid, \"image\"]);\n\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.view.callEvent(\"onUIEditStop\", [this.viewid, \"image\"]);\n\t\tthis.config = this.viewid = null;\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\t\tif(this.$dialog && this.$dialog.isVisible() && type != \"image\")\n\t\t\t\tthis.close();\n\t\t});\n\n\t\tthis.view.attachEvent(\"onCommand\", obj =>{\n\t\t\tif(obj.id == \"close-ui-editor\" && this.$dialog && this.$dialog.isVisible())\n\t\t\t\tthis.close();\n\t\t});\n\n\t\treturn box.DialogBox.prototype.$init.apply(this, arguments);\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse{\n\t\t\tconst id = this.view.views.add(null, null, \"image\", image);\n\t\t\tthis.view.views.highlight(id);\n\t\t}\n\t\tthis.close();\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue, page) => {\n\t\tif (isCellLocked(view, row, column, page)) return false;\n\t\tif(page == view.getActiveSheet())\n\t\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) => {\n\t\tif(!(action == \"lock\" && obj.page != view.getActiveSheet()))\n\t\t\taddToHistory(\n\t\t\t\tview,\n\t\t\t\t{\n\t\t\t\t\taction: action,\n\t\t\t\t\trow: obj.row || null,\n\t\t\t\t\tcolumn: obj.column || null,\n\t\t\t\t\tvalue: webix.isUndefined(obj.value) ? null : obj.value,\n\t\t\t\t\tnewValue: webix.isUndefined(obj.newValue) ? null : obj.newValue,\n\t\t\t\t\textra: obj.extra || null,\n\t\t\t\t\tgroup: group.value\n\t\t\t\t}\n\t\t\t);\n\t});\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action !== \"add\" && action !== \"del\")\n\t\t\taddToHistory(view, { action:{id: action, group:\"column\"}, group: group.value, column: {\n\t\t\t\tstart: { column:start }, end: { column:end }\n\t\t\t}});\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action !== \"add\" && action !== \"del\")\n\t\t\taddToHistory(view, { action: {id: action, group:\"row\"}, group: group.value, row: {\n\t\t\t\tstart: {row: start}, end: {row: end}\n\t\t\t}});\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\n\t// zoom\n\tview.attachEvent(\"onZoom\", (value, oldVal) =>\n\t\taddToHistory(view, {action: \"zoom\", value: oldVal, newValue: value, group: group.value})\n\t);\n\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory && !view._loading_data){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction, data.extra];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {range, toRange, changeRange, encode, isRange} from \"../helpers/column_names\";\nimport {ignoreUndo} from \"./undo\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tmove: function(id, x, y){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst old = webix.copy(this._pull[id]);\n\t\t\tthis._pull[id].x = _correctPos(view, old.config.width, x/view._zoom, \"x\");\n\t\t\tthis._pull[id].y = _correctPos(view, old.config.height, y/view._zoom, \"y\");\n\t\t\tview.callEvent(\"onAction\", [\"move-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t\t_showOne(view, win, this._pull[id]);\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\"){\n\t\t\t\tconfig = webix.extend(config, {\n\t\t\t\t\ttype: \"line\",\n\t\t\t\t\tdataSeries:\"columns\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst height = config.height = config.height || 300;\n\t\t\tconst width = config.width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis.move(id, x, y+state.y);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewResize\", () => {\n\t\t\t\tconst conf =  this._pull[id];\n\t\t\t\tconst old = webix.copy(conf);\n\n\t\t\t\tconf.config.height = win.$height;\n\t\t\t\tconf.config.width = win.$width;\n\t\t\t\tview.callEvent(\"onAction\", [\"resize-view\", { row:id, newValue:webix.copy(conf), value:old } ]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tx = _correctPos(view, height, x, \"x\");\n\t\t\ty = _correctPos(view, width, y, \"y\");\n\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tgetConfig:function(id){\n\t\t\treturn this._pull[id];\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || \"\";\n\t\t\tconfig = config || {};\n\n\t\t\tdelete config.data;\n\n\t\t\tif(conf.type == \"chart\"){\n\t\t\t\tconst type = config.type;\n\t\t\t\tif(type && !config.series){\n\t\t\t\t\tconst xAxis = config.xAxis && config.xAxis.range;\n\t\t\t\t\tconst legend = config.legend && config.legend.range;\n\n\t\t\t\t\tlet oldLeftColumn;\n\t\t\t\t\tif(old && old.config){\n\t\t\t\t\t\tif(_isPie(type)){\n\t\t\t\t\t\t\tif(old.config.legend && old.config.legend.fromData)\n\t\t\t\t\t\t\t\toldLeftColumn = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(old.config.xAxis && old.config.xAxis.fromData)\n\t\t\t\t\t\t\toldLeftColumn = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tconfig.series = _getSeries(view, data, config.dataSeries, {xAxis, legend}, oldLeftColumn);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst win = webix.$$(id);\n\n\t\t\tconst height = config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tif(win.$width != width && win.$height != height){\n\t\t\t\twin.define({width, height});\n\t\t\t\twin.resize();\n\t\t\t}\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tconst renderConfig = webix.copy(conf);\n\n\t\t\t\t//clear width and height for inner view resizing\n\t\t\t\trenderConfig.config.width = renderConfig.config.height = 0;\n\n\t\t\t\tnode = actions.render(node, renderConfig, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\thighlight:function(id){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst css = \"webix_ssheet_ui_focused\";\n\n\t\t\tconst oldWin = webix.$$(this._activeWin);\n\t\t\tif(oldWin && !oldWin.$destructed)\n\t\t\t\twebix.html.removeCss(oldWin.$view, css);\n\n\t\t\tif(win){\n\t\t\t\tthis._activeWin = id;\n\t\t\t\twebix.html.addCss(win.$view, css);\n\t\t\t}\n\t\t\telse\n\t\t\t\tdelete this._activeWin;\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tconst move = type === \"move-view\";\n\t\tif (move || type == \"resize-view\" || type === \"add-view\")\n\t\t\t_undoUI(view, move, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onZoom\", () => _showAll(view, true));\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", (r,c,v,p) => {\n\t\tif(p == view.getActiveSheet())\n\t\t\t_trackAll(view);\n\t});\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\tlet editUIType;\n\twebix.attachEvent(\"onClick\", function(ev){\n\t\tlet focus = webix.$$(ev);\n\t\tif(focus && focus.config.externalUI)\n\t\t\tfocus = webix.$$(focus.config.externalUI);\n\n\t\tconst ui = focus && (focus.queryView(\"ssheet-ui\",\"self\") || focus.queryView(\"ssheet-ui\",\"parent\"));\n\n\t\tif(ui){\n\t\t\tview.views.highlight(ui);\n\t\t\tconst id = ui.config.id;\n\n\t\t\tif(editUIType){\n\t\t\t\tif(view.views.getConfig(id).type == editUIType)\n\t\t\t\t\tui.callEvent(\"onViewEdit\", []); //start editing if any editor is open\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id:\"close-ui-editor\" }]);\n\t\t\t}\n\t\t}\n\t\telse if(!editUIType)\n\t\t\tview.views.highlight();\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", function(id, type){\n\t\tview.views.highlight(id);\n\t\teditUIType = type;\n\t});\n\n\tview.attachEvent(\"onUIEditStop\", function(id, type){\n\t\tif(editUIType == type)\n\t\t\twebix.delay(()=>{ // after onClick handler (to save focus)\n\t\t\t\teditUIType = null;\n\t\t\t});\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst dataRange = _getNames(view, conf);\n\t\tconst config = _genChartConfig(conf, data, dataRange);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\tconst views = data.views;\n\tif(views){\n\t\tignoreUndo(function(){\n\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t}, view);\n\t}\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst conf = ui._pull[id];\n\n\t\t\tconst viewMethods = ui._types[conf.type];\n\t\t\tconst render = viewMethods.render;\n\t\t\tconst track = viewMethods.track;\n\n\t\t\tif(track)\n\t\t\t\t_trackOne(view, ui.get(id), track, conf, render);\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf, render){\n\tconst data = _fromRange(view, conf);\n\n\tif(conf.type == \"chart\"){\n\t\tif(render)\n\t\t\tnode = render(node, conf, data, true);\n\n\t\tconst config = conf.config;\n\t\tif(config && !_isPie(config.type))\n\t\t\t_removeLegend(data, conf, view);\n\t}\n\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3])){\n\t\t\tconst series = views[i][4].series;\n\t\t\tif(series){\n\t\t\t\tseries.forEach(obj => {\n\t\t\t\t\tobj.range = changeRange(obj.range, name, inc, start);\n\t\t\t\t\tobj.active = changeRange(obj.active, name, inc, start);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst legend = views[i][4].legend && views[i][4].legend.range;\n\t\t\tif(legend)\n\t\t\t\tviews[i][4].legend.range = _getDataParts(legend).map(range => changeRange(range, name, inc, start)).join(\",\");\n\n\t\t\tconst xAxis = views[i][4].xAxis && views[i][4].xAxis.range;\n\t\t\tif(xAxis)\n\t\t\t\tviews[i][4].xAxis.range = changeRange(xAxis, name, inc, start);\n\n\t\t\tviews[i][3] = _getDataParts(views[i][3]).map(range => changeRange(range, name, inc, start)).join(\",\");\n\t\t}\n\t}\n}\n\nfunction _showAll(view, pos){\n\t//close possibly open menus of embedded ui\n\twebix.callEvent(\"onClick\", []);\n\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, conf.config.width, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, conf.config.height, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.define({\n\t\twidth: conf.config.width * view._zoom,\n\t\theight: conf.config.height * view._zoom\n\t});\n\twin.resize();\n\n\twin.show({\n\t\tx:conf.x * view._zoom,\n\t\ty:(conf.y * view._zoom) - state.y\n\t});\n}\n\nfunction _correctPos(view, winSize, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = (type == \"x\" ? _getWidth(view) : _getHeight(view)) - winSize;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, move, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id]){\n\t\t\tif(move)\n\t\t\t\tview.views.move(id, x, y);\n\t\t\telse\n\t\t\t\tview.views.update(id, data, config);\n\t\t}\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\n\t\tconst editor = view.$$(\"chartEditor\");\n\t\tif(editor && editor.viewId == id)\n\t\t\teditor.queryView(\"form\").setValues(config);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width / view._zoom;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height / view._zoom;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nfunction _prepareType(config){\n\tconst type = config.type;\n\tif(config.stacked && type.indexOf(\"stacked\") == -1)\n\t\tconfig.type = \"stacked\"+config.type.charAt(0).toUpperCase()+config.type.substr(1);\n\tif(config[\"3D\"] && type.indexOf(\"3D\") == -1)\n\t\tconfig.type += \"3D\";\n\tif(config.horizontal && type.indexOf(\"H\") == -1)\n\t\tconfig.type += \"H\";\n\n\treturn config.type;\n}\n\nfunction _genChartConfig(conf, data, dataRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tlet config = webix.copy(conf.config);\n\n\tconfig = _normalizeConfig(config);\n\n\tconst scale = config.scale.lines;\n\tconst scaleColor = config.scale.color || undefined;\n\tconst type = (config.type = _prepareType(config));\n\tconst pie = _isPie(type);\n\n\tconst lines = config.series;\n\tconfig.series = [];\n\tconst xAxis = config.xAxis;\n\n\tconst legendConfig = config.legend;\n\tlet pieLegend;\n\tlet legendRange;\n\n\tconst legend = {\n\t\theight:24,\n\t\talign: legendConfig.align || \"center\",\n\t\tvalign: legendConfig.valign || \"bottom\",\n\t};\n\tlegend.layout = legend.valign == \"middle\" ? \"y\" : \"x\";\n\n\tif(pie){\n\t\tif(legendConfig.fromData)\n\t\t\tpieLegend = \"data0\";\n\t\telse if(legendConfig.range)\n\t\t\tpieLegend = dataRange[legendConfig.range];\n\n\t\tlegend.template = `#${pieLegend}#`;\n\t}\n\telse{\n\t\tlegend.values = [];\n\n\t\tlegendRange = !legendConfig.fromData && legendConfig.range;\n\t\tif(legendRange){\n\t\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\t\tlegendRange = _getParts(legendConfig.range, switchDirection, dataRange);\n\t\t}\n\n\t\tconfig.yAxis = config.yAxis||{};\n\t\tfor(let property in config.yAxis)\n\t\t\tif(config.yAxis[property] === \"\")\n\t\t\t\tdelete config.yAxis[property];\n\n\t\tconfig.yAxis = webix.extend(config.yAxis, {\n\t\t\tlineColor: scaleColor,\n\t\t\tcolor: scaleColor,\n\t\t\tlines: scale,\n\t\t\tlineShape: config.scale.circle ? \"arc\" : \"default\"\n\t\t});\n\n\t\tif(xAxis.fromData)\n\t\t\txAxis.range = legendRange ? Object.keys(data[0]).filter(line => legendRange.indexOf(line) == -1)[0] : \"data0\";\n\t\telse if(xAxis.range)\n\t\t\txAxis.range = dataRange[xAxis.range];\n\t}\t\n\n\tfor(let i = 0; i < lines.length; i++){\n\t\tconst color = lines[i].color;\n\t\tconst item = dataRange[lines[i].range];\n\n\t\tif(item != xAxis.range && !(pie && item == pieLegend /*(item == pieLegend || legendConfig.range == lines[i].active)*/)){\n\t\t\tconst s = {\n\t\t\t\tvalue:`#${item}#`,\n\t\t\t\ttooltip:{\n\t\t\t\t\ttemplate: lines[i].tooltip ? `#${item}#` : \"\"\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ts[pie ? \"pieInnerText\" : \"label\"] = lines[i].label ? `#${item}#` : \"\";\n\n\t\t\tif(type == \"radar\" || type == \"line\" || type == \"spline\" || type == \"scatter\"){\n\t\t\t\ts.line = { color };\n\t\t\t\ts.item = { borderColor:color, type:lines[i].marker };\n\t\t\t}\n\t\t\telse if(!pie)\n\t\t\t\ts.color = color;\n\n\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\ts.alpha = 0.7;\n\n\t\t\tif(data[0] && !pie && (legendRange || legendConfig.fromData)){\n\t\t\t\tconst val = legendRange ? data[0][legendRange[i]] : data[0][item];\n\t\t\t\tconst text = (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\tlegend.values.push({text, color});\n\t\t\t}\n\n\t\t\tconfig.series.push(s);\n\t\t}\n\t}\n\n\tif(!pie){\n\t\tconfig.xAxis = {\n\t\t\ttitle: config.xAxis.title,\n\t\t\tlineColor: scaleColor,\n\t\t\tcolor: scaleColor,\n\t\t\tlines: scale\n\t\t};\n\n\t\tconfig[type == \"barH\" || type == \"stackedBarH\" ? \"yAxis\" : \"xAxis\"].template = obj => {\n\t\t\tconst val = obj[xAxis.range];\n\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t};\n\t}\n\n\tif(pieLegend || (legend.values && legend.values.length))\n\t\tconfig.legend = legend;\n\telse\n\t\tdelete config.legend;\n\n\tif(type == \"scatter\"){\n\t\tconfig.xValue = config.xAxis.template;\n\t\tconfig.origin = \"auto\";\n\t\tdelete config.xAxis.template;\n\t}\n\n\treturn webix.extend({\n\t\tview:\"chart\",\n\t\tpadding:{\n\t\t\tleft:80\n\t\t}\n\t}, config, true);\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn data;\n\n\tconst arr = [];\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\tfor(let i = 0; i < subdata[0].length; i++){\n\t\t\t\t\t\tif(!arr[i])\n\t\t\t\t\t\t\tarr[i] = {};\n\t\t\t\t\t\twebix.extend(arr[i], subdata[0][i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction _removeLegend(arr, conf, view){\n\tconst config = conf.config;\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconst legend = config.legend;\n\n\tif(legend.fromData)\n\t\tarr.shift();\n\telse if(legend.range){\n\t\tconst names = _getNames(view, conf);\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tconst legendRange = _getParts(legend.range, switchDirection, names);\n\t\tfor (let i = 0; i < legendRange.length; i++){\n\t\t\tconst item = legendRange[i];\n\t\t\tdelete arr[0][item];\n\t\t}\n\t}\n}\n\nfunction _getNames(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn;\n\n\tlet names = {};\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\twebix.extend(names, subdata[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function _getDataParts(data){\n\treturn data.replace(/\\s/g, \"\").split(\",\");\n}\n\nexport function _isPie(type){\n\treturn /pie|donut/.test(type);\n}\n\nexport function _getSeries(view, data, dataSeries, active, oldLeftColumn){\n\tconst dir = dataSeries == \"rows\";\n\tlet vals = [];\n\n\tif(data){\n\t\tlet xAxis = [];\n\t\tlet legend = [];\n\t\tlet activeVals = [];\n\n\t\tif(active){\n\t\t\tif(active.legend)\n\t\t\t\tlegend = _getParts(active.legend, dir);\n\t\t\tif(active.xAxis)\n\t\t\t\txAxis = _getParts(active.xAxis, dir);\n\t\t\tif(active.series)\n\t\t\t\tactiveVals = active.series.filter(val => legend.indexOf(val.range) == -1 && xAxis.indexOf(val.range) == -1);\n\t\t}\n\n\t\tdata = _getDataParts(data);\n\t\tlet colorIndex = 0;\n\t\tlet firstRange = 1;\n\t\tdata.forEach(subdata => {\n\t\t\tconst series = isRange(subdata) ? range(subdata, view) : null;\n\t\t\tif(series){\n\t\t\t\tconst start = dir ? series[0] : series[1];\n\t\t\t\tconst end = dir ? series[2] : series[3];\n\n\t\t\t\tlet inActiveSeries;\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tconst seria = arr.find(activeVals, val => val.range == range && (!val.active || val.active == subdata));\n\n\t\t\t\t\tif(seria){\n\t\t\t\t\t\tif(!seria.active)\n\t\t\t\t\t\t\tseria.active = subdata;\n\t\t\t\t\t\tinActiveSeries = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(legend.indexOf(range) != -1 || xAxis.indexOf(range) != -1)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tconst activeVal = activeVals.filter(val => val.range == range && val.active == subdata)[0];\n\n\t\t\t\t\tif(inActiveSeries && !activeVal && !(oldLeftColumn && firstRange && i == start))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvals.push(activeVal || {\n\t\t\t\t\t\tactive: subdata,\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tmarker: \"square\",\n\t\t\t\t\t\ttooltip: 1,\n\t\t\t\t\t\tcolor: _getColor(colorIndex)\n\t\t\t\t\t});\n\n\t\t\t\t\tcolorIndex++;\n\t\t\t\t}\n\t\t\t\tfirstRange = 0;\n\t\t\t}\n\t\t});\n\t}\n\treturn vals;\n}\n\nexport function _getParts(ranges, dir, dataRange){\n\tconst parts = [];\n\n\tranges = _getDataParts(ranges);\n\tranges.forEach(subRange => {\n\t\tsubRange = isRange(subRange) ? range(subRange) : null;\n\t\tif(subRange){\n\t\t\tconst start = dir ? subRange[0] : subRange[1];\n\t\t\tconst end = dir ? subRange[2] : subRange[3];\n\n\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\tconst range = dir ?\n\t\t\t\t\ttoRange(i, subRange[1], i, subRange[3], subRange[4]):\n\t\t\t\t\ttoRange(subRange[0], i, subRange[2], i, subRange[4]);\n\n\t\t\t\tparts.push(dataRange ? dataRange[range] : range);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn parts;\n}\n\nexport function _normalizeConfig(config){\n\tif(typeof(config.xAxis) != \"object\")\n\t\tconfig.xAxis = {fromData: !!config.xAxis};\n\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconfig.legend = webix.extend(config.legend, {\n\t\tlayout:\"x\",\n\t\talign:\"center\",\n\t\tvalign:\"bottom\"\n\t});\n\n\tif(!config.scale)\n\t\tconfig.scale = {\n\t\t\tlines:1\n\t\t};\n\n\treturn config;\n}\n\nfunction _getColor(index){\n\tconst colors = [\n\t\t\"#e06666\", \"#6aa84f\", \"#3c78d8\", \"#e69138\", \"#783f04\", \"#134f5c\", \"#674ea7\", \"#c27ba0\"\n\t];\n\treturn colors[index%colors.length];\n}\n\nfunction getRangeCols(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = r1, rind = 0; i <= r2; i++, rind++){\n\t\tdata[rind] = {};\n\t\tfor (let j = c1, cind = lastIndex; j <= c2; j++, cind++){\n\t\t\tif(i == r2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[j]}${r1}:${encode[j]}${r2}`] = `data${cind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[rind][`data${cind}`] = this.getValue(i-1,j-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}\n\nfunction getRangeRows(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = c1, cind = 0; i <= c2; i++, cind++){\n\t\tdata[cind] = {};\n\t\tfor (let j = r1, rind = lastIndex; j <= r2; j++, rind++){\n\t\t\tif(i == c2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[c1]}${j}:${encode[c2]}${j}`] = `data${rind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[cind][`data${rind}`] = this.getValue(j-1,i-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}","import {range, toRange} from \"./helpers/column_names\";\nimport {_getSeries, _isPie, _normalizeConfig, _getDataParts} from \"./operations/views\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tconst activeSkin = webix.skin.$active;\n\tconst padding = activeSkin.dataPadding-2;\n\tconst margin = activeSkin.layoutMargin.form;\n\n\treturn {\n\t\twidth:440,\n\t\thidden: true,\n\t\tid:\"chartEditor\",\n\t\tcss:\"ssheet_chart\",\n\t\trows:[\n\t\t\t{\n\t\t\t\theight: activeSkin.barHeight,\n\t\t\t\tcss: \"ssheet_chart_wizard_head\",\n\t\t\t\tpadding: { left:4 },\n\t\t\t\tcols: [\n\t\t\t\t\t{ view:\"icon\", inputHeight:activeSkin.inputHeight, hotkey:\"esc\", icon:\"webix_ssheet_icon ssi-arrow-left\", click: () => closeEditor(view)  },\n\t\t\t\t\t{ type:\"header\", borderless:true, template: labels[\"chart-edit\"] }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"form\",\n\t\t\t\tcomplexData:true,\n\t\t\t\tborderless: true,\n\t\t\t\tpadding:{\n\t\t\t\t\ttop: 0\n\t\t\t\t},\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:184\n\t\t\t\t},\n\t\t\t\telements:[{\n\t\t\t\t\tview:\"tabview\",\n\t\t\t\t\tid:\"chartTabs\",\n\t\t\t\t\tcells:[\n\t\t\t\t\t\t{ id:\"common\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-common\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\taddRichselect(\"type\", \"chart-type\", getTypes()),\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"horizontal-chart\"], name:\"horizontal\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-3d\"], name:\"3D\", batch:\"pie\"},\n\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-col-xAxis\"], name:\"xAxis.fromData\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-row-legend\"], name:\"legend.fromData\"},\n\t\t\t\t\t\t\t\t\t{ view:\"radio\", label:labels[\"chart-data-from\"], name:\"dataSeries\", vertical:true, options:[\n\t\t\t\t\t\t\t\t\t\t{id:\"columns\", value:labels[\"chart-columns\"]},\n\t\t\t\t\t\t\t\t\t\t{id:\"rows\", value:labels[\"chart-rows\"]}\n\t\t\t\t\t\t\t\t\t]},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"advanced\", borderless:true, type:\"form\", paddingX:0, padding:{bottom:0}, header:labels[\"chart-series\"], rows:[\n\t\t\t\t\t\t\t{ view: \"ssheet-series\", name:\"series\" },\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"extras\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-extras\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\t\t\t\tmulti: true,\n\t\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-legend\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view: \"text\", label:labels[\"chart-legend-range\"], name:\"legend.range\"},\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.align\", \"chart-legend-align\", getLegendAlign()),\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.valign\", \"chart-legend-valign\", getLegendValign())\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-scale\"], batch:\"axis\", id:\"scale\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-lines\"], name:\"scale.lines\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-radar-circle\"], name:\"scale.circle\", hidden:true},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-scale-color\"], name:\"scale.color\", batch:\"axis\"}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-x-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-range\"], name:\"xAxis.range\", range:true, batch:\"axis\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-title\"], name:\"xAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-y-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-title\"], name:\"yAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-origin\"], name:\"origin\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"label\", label:labels[\"chart-yAxis-note\"], css:\"ssheet_note\", height:20},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-start\"], name:\"yAxis.start\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-end\"], name:\"yAxis.end\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-step\"], name:\"yAxis.step\", batch:\"axis\", attributes:{ type:\"number\" } }\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tconst form = chartEditor.queryView(\"form\");\n\tconst elements = form.elements;\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id == \"add-chart\"){\n\t\t\tconst config = action.config;\n\t\t\tlet values = config && config.config || {};\n\n\t\t\tchartEditor.show();\n\n\t\t\tview.$handleSelection = function(st, end, a, b){\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\n\t\t\t\tif(chartEditor.queryView(view => view == focus)){\n\t\t\t\t\tif(focus == elements.range || focus == elements[\"legend.range\"]){\n\t\t\t\t\t\tlet val = focus.getValue();\n\t\t\t\t\t\tconst last = val.lastIndexOf(\",\");\n\n\t\t\t\t\t\tval = last == -1 ? \"\" : val.substring(0, last + 1);\n\t\t\t\t\t\tfocus.setValue(val + a+\":\"+b);\n\t\t\t\t\t}\n\t\t\t\t\telse if(focus.config.range)\n\t\t\t\t\t\tfocus.setValue(a+\":\"+b);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tform.clear();\n\t\t\tview.$$(\"chartTabs\").setValue(\"common\");\n\n\t\t\tvalues = _normalizeConfig(values);\n\n\t\t\tvalues.range = config ? config.data : view.getSelectedRange();\n\t\t\tchartEditor.viewId = action.viewid ? action.viewid : view.views.add(null, null, \"chart\", values.range, values);\n\n\t\t\tview.callEvent(\"onUIEditStart\", [chartEditor.viewId, \"chart\"]);\n\n\t\t\tupdateValign(values.legend.align);\n\t\t\tupdateAlign(values.legend.valign);\n\n\t\t\tconst formValues = inValues(values);\n\t\t\tform.setValues(formValues);\n\t\t\tupdateType(formValues.type);\n\n\t\t\tif(!_isPie(formValues.type) && values.legend.fromData)\n\t\t\t\tupdateLegendRange(values.legend.fromData);\n\t\t\tif(values.xAxis.fromData)\n\t\t\t\tupdateXaxisRange(values.xAxis.fromData);\n\n\t\t\tupdateSeries();\n\n\t\t\tform.queryView(\"accordionitem\", \"all\").forEach(view => view.expand());\n\n\t\t\telements.range.focus();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\tif(chartEditor.isVisible() && type != \"chart\")\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onCommand\", obj =>{\n\t\tif(obj.id == \"close-ui-editor\" && chartEditor.isVisible())\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (id, values) => {\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tif(chartEditor.isVisible() && chartEditor.viewId == values.row)\n\t\t\t\tcloseEditor(view);\n\t\t}\n\t});\n\n\tform.attachEvent(\"onChange\", function(val, oldVal){\n\t\tconst source = this.$eventSource;\n\n\t\t//upper case ranges\n\t\tif(source === elements.range || source === elements[\"xAxis.range\"] || source === elements[\"legend.range\"]){\n\t\t\tconst parts = val.split(\"!\");\n\t\t\tconst upper = parts.length == 2 ? parts[0]+\"!\"+parts[1].toUpperCase() : val.toUpperCase();\n\n\t\t\tif(val != upper){\n\t\t\t\tval = upper;\n\t\t\t\tsetSilentValue(source, upper);\n\t\t\t}\n\t\t}\n\n\t\tswitch (source){\n\t\t\tcase elements.type:\n\t\t\t\tupdateType(val);\n\t\t\t\tbreak;\n\t\t\tcase elements.horizontal:\n\t\t\t\tswitchRowsCols();\n\t\t\t\tbreak;\n\t\t\tcase elements.range:\n\t\t\tcase elements.dataSeries:\n\t\t\t\tif(this.$eventSource == elements.dataSeries)\n\t\t\t\t\tswitchRowsCols();\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\thandlePieLegend();\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.range\"], getLeftColumn());\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.fromData\"]:\n\t\t\t\tupdateXaxisRange(val);\n\n\t\t\t\tupdateSeries(oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.fromData\"]:\n\t\t\t\tupdateLegendRange(val);\n\n\t\t\t\tupdateSeries(_isPie(elements.type.getValue()) ? oldVal : 0);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.align\"]:\n\t\t\t\tupdateValign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.valign\"]:\n\t\t\t\tupdateAlign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.range\"]:\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.range\"]:\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"legend.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst config = form.getValues();\n\t\tview.views.update(chartEditor.viewId, config.range, config);\n\t});\n\n\telements.series.attachEvent(\"onRangeChange\", updateRange);\n\n\tfunction handlePieLegend(){\n\t\tif(elements[\"legend.fromData\"].getValue()){\n\t\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\t\tsetSilentValue(elements[\"legend.range\"], handler());\n\t\t}\n\t}\n\n\tfunction updateLegendRange(val){\n\t\tif(val){\n\t\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\t\tupdateRange(\"\", legendRange);\n\t\t}\n\n\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\tval = val ? handler() : \"\";\n\n\t\tsetSilentValue(elements[\"legend.range\"], val);\n\t}\n\n\tfunction updateXaxisRange(val){\n\t\tif(val){\n\t\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue();\n\t\t\tupdateRange(\"\", xAxisRange);\n\t\t}\n\n\t\tval = val ? getLeftColumn() : \"\";\n\n\t\tsetSilentValue(elements[\"xAxis.range\"], val);\n\t}\n\n\tfunction setSilentValue(element, val){\n\t\telement.blockEvent();\n\t\telement.setValue(val);\n\t\telement.unblockEvent();\n\t}\n\n\tfunction getLeftColumn(){\n\t\tconst data = elements.range.getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\tlet leftColumn = \"\";\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend: legendRange || \"\"});\n\n\t\tif(series.length)\n\t\t\tleftColumn = series[0].range;\n\n\t\treturn leftColumn;\n\t}\n\n\tfunction getTopRow(){\n\t\tconst data = _getDataParts(elements.range.getValue());\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst xAxisRange = _getDataParts(elements[\"xAxis.range\"].getValue());\n\t\tlet topRow = [];\n\n\t\tdata.forEach(subdata => {\n\t\t\tif(xAxisRange.indexOf(subdata) == -1){\n\t\t\t\tconst part = range(subdata, view);\n\t\t\t\tif(part){\n\t\t\t\t\tconst range = dir ?\n\t\t\t\t\t\ttoRange(part[0], part[1], part[2], part[1], part[4]) :\n\t\t\t\t\t\ttoRange(part[0], part[1], part[0], part[3], part[4]);\n\n\t\t\t\t\tif(data.indexOf(range) == -1)\n\t\t\t\t\t\ttopRow.push(range);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn topRow.join(\",\");\n\t}\n\n\tfunction updateRange(val, oldVal){\n\t\tlet data = elements.range.getValue();\n\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend, xAxis});\n\n\t\toldVal = _getDataParts(oldVal);\n\n\t\tdata = _getDataParts(data).filter(val => oldVal.indexOf(val) == -1);\n\n\t\tif(val){\n\t\t\tval = _getDataParts(val);\n\t\t\tval.forEach(range => {\n\t\t\t\tconst exist = series.filter(obj => obj.range == range);\n\t\t\t\tif(!exist.length)\n\t\t\t\t\tdata.push(range);\n\t\t\t});\n\t\t}\n\n\t\tsetSilentValue(elements.range, data.join(\",\"));\n\t}\n\n\tfunction updateAlign(val){\n\t\tconst align = elements[\"legend.align\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"middle\"){\n\t\t\tif(list.exists(\"center\"))\n\t\t\t\tlist.remove(\"center\");\n\t\t}\n\t\telse if(!list.exists(\"center\"))\n\t\t\tlist.add({id:\"center\", value:labels[\"chart-legend-center\"]}, 1);\n\t}\n\n\tfunction updateValign(val){\n\t\tconst align = elements[\"legend.valign\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"center\"){\n\t\t\tif(list.exists(\"middle\"))\n\t\t\t\tlist.remove(\"middle\");\n\t\t}\n\t\telse if(!list.exists(\"middle\"))\n\t\t\tlist.add({id:\"middle\", value:labels[\"chart-legend-middle\"]}, 1);\n\t}\n\n\tfunction updateType(val){\n\t\thandlePieLegend();\n\n\t\tconst isPie = _isPie(val);\n\t\tconst isBar = val == \"bar\";\n\t\tconst series = elements.series;\n\t\tconst markersVisible = val == \"radar\" || val == \"line\" || val == \"spline\" || val == \"scatter\";\n\n\t\tseries.hideSubviews(\"marker\", markersVisible);\n\t\tseries.hideSubviews(\"label\", markersVisible || isBar || isPie);\n\t\tseries.hideSubviews(\"color\", !isPie);\n\n\t\tif(val == \"area\" || isBar) elements.stacked.show();\n\t\telse hideField(elements.stacked);\n\n\t\tif(isBar) elements.horizontal.show();\n\t\telse hideField(elements.horizontal);\n\n\t\tif(val == \"radar\")\n\t\t\telements[\"scale.circle\"].show();\n\t\telse\n\t\t\thideField(elements[\"scale.circle\"]);\n\n\t\tif(isPie){\n\t\t\thideBatch(\"axis\");\n\t\t\thideBatch(\"pie\", true);\n\t\t}\n\t\telse{\n\t\t\thideBatch(\"axis\", true);\n\t\t\thideBatch(\"pie\");\n\t\t}\n\n\t\tif(isPie || val == \"radar\")\n\t\t\thideBatch(\"axisTitle\");\n\t\telse\n\t\t\thideBatch(\"axisTitle\", true);\n\n\t\tswitchRowsCols();\n\t}\n\n\tfunction updateSeries(oldXaxis){\n\t\tlet data = elements.range.getValue();\n\n\t\tlet series = elements.series.getValue();\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tseries = _getSeries(view, data, dataSeries, {series, legend, xAxis}, oldXaxis);\n\n\t\telements.series.setValue(series);\n\t}\n\n\tfunction switchRowsCols(){\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst horizontal = elements.horizontal.getValue();\n\t\tconst pie = _isPie(elements.type.getValue());\n\n\t\tif((!pie && dir) || (!dir && pie)){\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-col-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-row-\" + (horizontal ? \"yAxis\" : \"xAxis\")]);\n\t\t}\n\t\telse{\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-row-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-col-\" + (horizontal ? \"yAxis\" : \"xAxis\")]);\n\t\t}\n\t\telements[\"legend.fromData\"].refresh();\n\t\telements[\"xAxis.fromData\"].refresh();\n\t}\n\n\tfunction hideField(field){\n\t\tif(field.setValue)\n\t\t\tsetSilentValue(field);\n\t\tfield.hide();\n\t}\n\n\tfunction hideBatch(batch, visible){\n\t\tform.queryView({batch:batch}, \"all\").forEach(field => {\n\t\t\tif(visible)\n\t\t\t\tfield.show();\n\t\t\telse\n\t\t\t\thideField(field);\n\t\t});\n\t}\n\n\tfunction inValues(values){\n\t\t[\n\t\t\t{value:\"H\", name:\"horizontal\"},\n\t\t\t{value:\"stacked\"},\n\t\t\t{value:\"3D\"}\n\t\t].forEach(property => {\n\t\t\tif(values.type.indexOf(property.value) != -1){\n\t\t\t\tvalues[property.name || property.value] = 1;\n\t\t\t\tvalues.type = values.type.replace(property.value, \"\").toLowerCase();\n\t\t\t}\n\t\t});\n\n\t\treturn values;\n\t}\n}\n\nfunction closeEditor(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tview.callEvent(\"onUIEditStop\", [chartEditor.viewId, \"chart\"]);\n\tchartEditor.viewId = null;\n\tview.$handleSelection = null;\n\tchartEditor.hide();\n}\n\nfunction addRichselect(name, label, data){\n\treturn { view: \"richselect\", name:name, label:labels[label], suggest:{\n\t\tview: \"ssheet-form-suggest\",\n\t\tdata: data\n\t}};\n}\n\nexport function getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]},\n\t\t{id:\"scatter\", value:labels[\"scatter-chart\"]}\n\t];\n}\n\nfunction getLegendAlign(){\n\treturn [\n\t\t{id:\"left\", value:labels[\"chart-legend-left\"]},\n\t\t{id:\"center\", value:labels[\"chart-legend-center\"]},\n\t\t{id:\"right\", value:labels[\"chart-legend-right\"]}\n\t];\n}\n\nfunction getLegendValign(){\n\treturn [\n\t\t{id:\"top\", value:labels[\"chart-legend-top\"]},\n\t\t{id:\"middle\", value:labels[\"chart-legend-middle\"]},\n\t\t{id:\"bottom\", value:labels[\"chart-legend-bottom\"]}\n\t];\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../mathematics/writer\";\nimport {getTypes} from \"../chart\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tif (data.horizontal)\n\t\t\t\tels.horizontal.setValue(1);\n\n\t\t\tform.unblockEvent();\n\t\t\tthis.renderPreview();\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> this.renderPreview() },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\tonChange: function(type){\n\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\tswitch(type){\n\t\t\t\t\t\t\t\tcase \"pie\":\n\t\t\t\t\t\t\t\tcase \"donut\":\n\t\t\t\t\t\t\t\t\tform.showBatch(3);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"bar\":\n\t\t\t\t\t\t\t\t\tform.showBatch(2);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tform.showBatch(1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"horizontal-chart\"], name:\"horizontal\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n\tokClick(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst config = this.sparkConfig(data);\n\n\t\t\tthis.view.addSparkline(this.cell.row, this.cell.column, config);\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\trenderPreview(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst pos = range(data.range, this.view);\n\t\t\tconst values = this.view._mPage.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1);\n\t\t\tconst config = this.sparkConfig(data, true);\n\n\t\t\tfor(let i = 0; i < values.length; i++)\n\t\t\t\tvalues[i] = values[i]||0;\n\t\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t\t}\n\t\telse\n\t\t\tform.elements.preview.setValue(\"\");\n\t}\n\n\tsparkConfig(config, preview){\n\t\tconfig = webix.copy(config);\n\t\tconst form = this.$dialog.getBody();\n\n\t\tif (config.type === \"bar\"){\n\t\t\tconfig.color = config.color_pos;\n\t\t\tconfig.negativeColor = config.color_neg;\n\t\t}\n\t\telse if(form.elements.color_def.isVisible())\n\t\t\tconfig.color = config.color_def;\n\t\telse if(config.type == \"donut\" && preview)\n\t\t\twebix.extend(config, {type:\"pie\", donut:1}, true);\n\n\t\treturn config;\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange, escapeSheet} from \"../helpers/column_names\";\nimport {getLastCharIndex} from \"../mathematics/parser\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tconst form = box.$$(\"form\");\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\n\t\tconst elements = form.elements;\n\n\t\telements.name.focus();\n\n\t\tlet selectedCell = this.view.getSelectedRange();\n\t\tif(selectedCell)\n\t\t\tselectedCell = escapeSheet(this.view.getActiveSheet())+\"!\"+selectedCell;\n\n\t\tform.setValues({\n\t\t\trange: selectedCell,\n\t\t\tscope: \"$global\"\n\t\t});\n\n\t\tthis._updateData();\n\n\t\tthis.view._rangeDialog = true;\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,this.view.getActiveSheet()));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis.view._rangeDialog = null;\n\t}\n\tsaveClick(){\n\t\tconst view = this.view;\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tif(data.range){\n\t\t\tconst rangeParts = data.range.split(\"!\");\n\n\t\t\tif(rangeParts.length == 1)\n\t\t\t\trangeParts.unshift( escapeSheet(view.getActiveSheet()) );\n\n\t\t\tdata.range = rangeParts[0]+\"!\"+rangeParts[1].toUpperCase();\n\t\t}\n\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\t\tif(data.id){\n\t\t\t\tconst oldData = table.getItem(data.id);\n\n\t\t\t\tview.ranges.remove(oldData.name, this._getScope(oldData));\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\t}\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tview.ranges.add(\n\t\t\t\tdata.name,\n\t\t\t\tdata.range,\n\t\t\t\tthis._getScope(data)\n\t\t\t);\n\n\t\t\tview.refresh();\n\n\t\t\ttable.unselect();\n\t\t\tform.setValues({scope: \"$global\"});\n\t\t}\n\t}\n\t_getScope(data){\n\t\treturn data.scope == \"$global\" ? true : data.scope;\n\t}\n\tremoveRange(id){\n\t\tconst view = this.view;\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\t\t\tconst item = table.getItem(id);\n\n\t\t\tview.ranges.remove(item.name, this._getScope(item));\n\n\t\t\tview.refresh();\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\tform.clearValidation();\n\t\tconst item = webix.copy(table.getItem(id));\n\n\t\tform.setValues(item);\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onSheetRename\", (name, newName)=> this._updateData(name, newName));\n\t\tthis.view.attachEvent(\"onSheetRemove\", (name)=> this._updateData(name));\n\t\tthis.view.attachEvent(\"onSheetAdd\", ()=> this._updateData());\n\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst theform = {\n\t\t\tpadding:0,\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:locale[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:locale[\"range-cells\"], width: 150 },\n\t\t\t\t\t{ id:\"scope\", header:locale[\"range-scope\"], width: 95, template: obj => {\n\t\t\t\t\t\treturn obj.scope == \"$global\" ? locale[\"range-global\"] : obj.scope;\n\t\t\t\t\t}},\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-pencil'></span>\", width:44 },\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-trash'></span>\", width:44 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 200, select:\"row\",\n\t\t\t\ton:{\n\t\t\t\t\tonBeforeSelect: id =>{\n\t\t\t\t\t\treturn id == this.$dialog.$$(\"form\").getValues().id;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 270, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname: (_, obj)=> {\n\t\t\t\t\t\t\tconst notUnique = this.$dialog.$$(\"table\").find(item => {\n\t\t\t\t\t\t\t\treturn item.name == obj.name && item.scope == obj.scope && item.id != obj.id;\n\t\t\t\t\t\t\t}, true);\n\n\t\t\t\t\t\t\treturn !notUnique && !getLastCharIndex(obj.name);\n\t\t\t\t\t\t},\n\t\t\t\t\t\trange: isRange,\n\t\t\t\t\t\tscope: webix.rules.isNotEmpty\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 95\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", label: locale[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", id:\"range\", label: locale[\"range-cells\"], on:{\n\t\t\t\t\t\t\tonFocus:() => this.view.showCell(this.$dialog.$$(\"range\").getValue(), true)\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view: \"richselect\", name:\"scope\", id:\"sheets\", label: locale[\"range-scope\"], suggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: []\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tautoheight: true,\n\t\t\twidth: 800,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.saveClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\t_updateData(name, newName){\n\t\tif(!this.$dialog.isVisible())\n\t\t\treturn;\n\n\t\tconst ranges = this.view._mData.getRanges();\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst table = this.$dialog.$$(\"table\");\n\t\tconst form = this.$dialog.$$(\"form\");\n\n\t\tlet editRange = table.getItem( form.getValues().id );\n\t\tif(editRange){\n\t\t\tlet rangeName = editRange.name;\n\n\t\t\tif(name == editRange.scope)\n\t\t\t\trangeName = newName ? newName+\"!\"+rangeName : null;\n\t\t\telse\n\t\t\t\trangeName = editRange.scope+\"!\"+rangeName;\n\n\t\t\teditRange = rangeName ? ranges.get(rangeName) : null;\n\t\t}\n\n\t\ttable.clearAll();\n\n\t\tconst allRanges = ranges.serialize();\n\t\tconst data = [];\n\n\t\tlet selectedId;\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst id = i+1;\n\t\t\tlet [name, range] = allRanges[i];\n \n\t\t\tif(editRange && ranges.get(name) == editRange)\n\t\t\t\tselectedId = id;\n\n\t\t\tconst nameParts = name.split(\"!\");\n\n\t\t\tdata.push({\n\t\t\t\tscope: nameParts.length == 1 ? \"$global\" : nameParts[0],\n\t\t\t\tname: nameParts[1] || nameParts[0],\n\t\t\t\trange,\n\t\t\t\tid\n\t\t\t});\n\t\t}\n\n\t\ttable.parse(data);\n\n\t\tform.setValues({id:selectedId}, true);\n\t\tif(selectedId)\n\t\t\ttable.select(selectedId);\n\n\t\tconst select = this.$dialog.$$(\"sheets\");\n\t\tconst selectList = select.getList();\n\n\t\tselectList.clearAll();\n\n\t\tconst sheets = [{\n\t\t\tid: \"$global\", value: locale[\"range-global\"]\n\t\t}];\n\t\tthis.view._sheets.forEach(sheet => {\n\t\t\tsheets.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\tselectList.parse(sheets);\n\n\t\tif(name){\n\t\t\tconst range = this.$dialog.$$(\"range\");\n\t\t\tconst rangeVal = range.getValue();\n\n\t\t\t//remove sheet\n\t\t\tnewName = newName || this.view.getActiveSheet();\n\n\t\t\tif(rangeVal.indexOf(escapeSheet(name)+\"!\") == 0)\n\t\t\t\trange.setValue(escapeSheet(newName)+\"!\"+rangeVal.split(\"!\")[1]);\n\n\t\t\tif(select.getValue() == name)\n\t\t\t\tselect.setValue(newName);\n\t\t}\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tconst value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif(value)\n\t\t\tform.setValues({\n\t\t\t\trange: value.options,\n\t\t\t\tempty: value.empty\n\t\t\t});\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tview:\"form\",\n\t\t\t\tid:\"form\",\n\t\t\t\telementsConfig: {\n\t\t\t\t\tlabelWidth: 130\n\t\t\t\t},\n\t\t\t\trows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" },\n\t\t\t\t\t{ view:\"checkbox\", label:webix.i18n.spreadsheet.labels[\"dropdown-empty-option\"], name:\"empty\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.$$(\"form\").getValues();\n\n\t\tif(!range(values.range, this.view))\n\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"], type: \"alert-error\"});\n\t\telse{\n\t\t\tgroup.set(function(){\n\t\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values.range, empty:values.empty });\n\t\t\t}, this);\n\t\t\tthis.close();\n\t\t}\n\t}\n}","import {range as getRangePos} from \"../helpers/column_names\";\nimport {cell_template} from \"../table\";\nimport * as arr from \"../helpers/array\";\nimport {serialize as getSpans} from \"../operations/spans\";\n\nclass Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t}\n\tclear(scope){\n\t\tconst sheet = typeof scope == \"string\" ? scope : this._master.getActiveSheet();\n\t\tconst ranges = this.serialize(sheet);\n\t\tranges.forEach(range => {\n\t\t\tif(scope === true){\n\t\t\t\tif(range[2])\n\t\t\t\t\tthis.remove(range[0], scope);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.remove(range[0], scope);\n\t\t});\n\t}\n\t_normalizeName(name, scope){\n\t\tif(scope !== true)\n\t\t\tname = (scope || this._master.getActiveSheet())+\"!\"+name;\n\t\treturn name;\n\t}\n\t_normalizeRange(range, scope){\n\t\tconst rangeParts = range.split(\"!\");\n\t\tif(rangeParts.length == 1)\n\t\t\trange = (typeof scope == \"string\" ? scope : this._master.getActiveSheet()) + \"!\" + range;\n\t\treturn range;\n\t}\n\tadd(name, range, scope){\n\t\tconst view = this._master;\n\n\t\tview.callEvent(\"onAfterRangeSet\", [name, range, scope]);\n\n\t\tname = this._normalizeName(name, scope);\n\n\t\tview._mData.getRanges().add(name, this._normalizeRange(range, scope));\n\t\tview.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tconst range = this._master._mData.getRanges().get(name);\n\t\tif(range)\n\t\t\treturn range.source;\n\t}\n\tremove(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tthis._master._mData.getRanges().remove(name);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tparse(data, sheet){\n\t\tif(!data)\n\t\t\treturn;\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst ranges = this._master._mData.getRanges();\n\t\t\tlet [name, range, globalRange] = data[i];\n\t\t\tname = this._normalizeName(name, globalRange||sheet);\n\n\t\t\tif(!ranges.get(name))\n\t\t\t\tranges.add(name, this._normalizeRange(range, sheet));\n\t\t}\n\t}\n\tserialize(sheet){\n\t\tsheet = sheet || this._master.getActiveSheet();\n\t\tconst allRanges = this._master._mData.getRanges().serialize();\n\t\tconst out = [];\n\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst arr = allRanges[i];\n\t\t\tconst nameParts = arr[0].split(\"!\");\n\t\t\tconst globalRange = nameParts.length == 1;\n\n\t\t\tif(globalRange || nameParts[0] == sheet)\n\t\t\t\tout.push([\n\t\t\t\t\tnameParts[ globalRange ? 0 : 1 ],\n\t\t\t\t\tarr[1],\n\t\t\t\t\tglobalRange\n\t\t\t\t]);\n\t\t}\n\n\t\treturn out;\n\t}\n\tgetRanges(sheet){\n\t\tconst data = this.serialize(sheet);\n\t\treturn data.map(arr => {\n\t\t\treturn {\n\t\t\t\tname: arr[0],\n\t\t\t\trange: arr[1],\n\t\t\t\tglobal: arr[2]\n\t\t\t};\n\t\t});\n\t}\n}\n\nexport function init(view) {\n\tview.ranges = new Ranges(view);\n\n\tview.attachEvent(\"onDataSerialize\", data => {\n\t\tdata.ranges = view.ranges.serialize();\n\t});\n}\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1, c1, r2, c2, spans){\n\tconst out = [];\n\tconst activeSheet = view._mPage === this;\n\n\tfor (let i = r1-1; i <= r2-1; i++) {\n\t\tfor (let j = c1-1; j <= c2-1; j++){\n\t\t\tlet inSpan;\n\t\t\tfor(let s = 0; s < spans.length; s++){\n\t\t\t\tconst span = spans[s];\n\t\t\t\tconst row = i + 1;\n\t\t\t\tconst col = j + 1;\n\t\t\t\tif(!(row == span[0] && col == span[1]) && row >= span[0] && row < span[0] + span[3] && col >= span[1] && col < span[1] + span[2]){\n\t\t\t\t\tinSpan = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(inSpan)\n\t\t\t\tcontinue;\n\t\t\tlet obj = this.getCell(i, j);\n\t\t\tlet cell;\n\n\t\t\tif(!obj)\n\t\t\t\tcell = {\n\t\t\t\t\tvalue: \"\"\n\t\t\t\t};\n\t\t\telse\n\t\t\t\tcell = webix.copy(obj);\n\n\t\t\tif(activeSheet)\n\t\t\t\tcell.$value = cell_template(view, {id: i+1}, null, null, {id:j+1}, true);\n\t\t\telse\n\t\t\t\tdelete cell.format;\n\n\t\t\tcell.id = cell.value;\n\t\t\tout.push(cell);\n\t\t}\n\t}\n\n\treturn out;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = getRangePos(text, view);\n\t\tif (pos){\n\t\t\tlet page = view._mPage;\n\t\t\tif(pos[4])\n\t\t\t\tpage = view._mData.getPage(pos[4]);\n\t\n\t\t\tif(page){\n\t\t\t\tconst spans = (\n\t\t\t\t\tpage == view._mPage ?\n\t\t\t\t\t\tgetSpans(view, {}) :\n\t\t\t\t\t\tarr.find(view._sheets, sheet => sheet.name == pos[4]).content\n\t\t\t\t).spans;\n\t\t\t\tvalues = getRange.apply(page, [view, pos[0], pos[1], pos[2], pos[3], spans]);\n\t\t\t}\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tconst test = {};\n\tfor (let i=values.length-1; i>=0; i--){\n\t\tconst boolean = typeof values[i].value === \"boolean\";\n\t\tif(boolean)\n\t\t\tvalues[i].value *= 1;\n\t\tif(boolean || values[i].id === 0)\n\t\t\tvalues[i].id = String(values[i].value);\n\n\t\tif(extra && extra.unique){\n\t\t\tif (test[values[i].id])\n\t\t\t\tvalues.splice(i, 1);\n\t\t\telse\n\t\t\t\ttest[values[i].id] = true;\n\t\t}\n\t}\n\n\tif (extra){\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tlet value = values[i].value;\n\t\t\tif (!value && value !== 0){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvalues[i].value = String(value);\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\nimport {conditions} from \"../helpers/conditional\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value, lastRow} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode, lastRow}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range, lastRow){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow, lastRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow, lastRow){\n\tconst span = view._table.getSpan(row, column);\n\tif (row === endRow || (span && row == endRow - span[3] + 1)){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tconst r = endRow+1;\n\n\t\t\tconst span = view._table.getSpan(r, column);\n\t\t\tif(span && span[0] != r)\n\t\t\t\tcontinue;\n\n\t\t\tconst value = view.getCellValue(r, column);\n\t\t\tif(!value && value !== 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(lastRow)\n\t\treturn endRow;\n\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row+1; i<view.config.rowCount; i++){\n\t\tconst value = view.getCellValue(i, column);\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(()=> view.removeFilters());\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(()=>{\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i = range.start.column; i <= range.end.column; i++)\n\t\t\t\tview.setCellFilter(row, i, { options:range, lastRow: calibrateRange(view, row, i, range, true) });\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tconst filters = data.filters;\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t\tif(filter.lastRow)\n\t\t\t\t\t\tfilter.lastRow += inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tif(filter.lastRow)\n\t\tfilter.lastRow += translate.row;\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport {getFormat} from \"../operations/styles\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"richselect\",\n\t\t\t\tname:\"symbol\",\n\t\t\t\tlabel:labelsLocale[\"currency-symbol\"],\n\t\t\t\toptions:fmt.currencies,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\theight: 160,\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}, {id:4}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:{\n\t\t\t\t\t\t\t\t\t\tconst elements = this.form.elements;\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\n\t\t\t\t\t\t\t\t\t\telements.separator[ id[0] == \"percent\" ? \"hide\" : \"show\" ]();\n\t\t\t\t\t\t\t\t\t\telements.symbol[ id[0] == \"price\" ? \"show\" : \"hide\" ]();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\theight:340,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 140\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst format = getFormat(this.view, this.cell[0].row, this.cell[0].column);\n\t\tconst name = format || \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst format = getFormat(view, this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, symbol:fmt.currencies[0].value, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = format || \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {getType} from \"../operations/types\";\nimport {find} from \"../helpers/array\";\n\nexport const action = \"conditional-format\";\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_rulesToArr(){\n\t\tconst conditions = this.view.conditions.handlers;\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"conditional-common\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.date, //number rules equal to date\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"conditional-text\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.text\n\t\t].map(rule => {\n\t\t\tif(!rule.value)\n\t\t\t\trule.value = webix.i18n.filter[ rule.id ];\n\t\t\treturn rule;\n\t\t});\n\t}\n\n\t_getCondition() {\n\t\tconst view = this.view;\n\t\tconst values = this._getDatalayout().getValue();\n\n\t\tconst data = [];\n\t\tvalues.forEach(v => {\n\t\t\tconst item = [v.condition];\n\t\t\tif (v.condition != \"between\" && v.condition != \"notBetween\")\n\t\t\t\titem.push(this._normalizeValue(v.value, v.condition));\n\t\t\telse\n\t\t\t\titem.push([\n\t\t\t\t\tthis._normalizeValue(v.value, v.condition),\n\t\t\t\t\tthis._normalizeValue(v.value2, v.condition)\n\t\t\t\t]);\n\n\t\t\titem.push(v.style);\n\t\t\tfor (let i=0; i<item.length; i++){\n\t\t\t\tif (item[i] === \"\" || (webix.isArray(item[i]) && item[i].indexOf(\"\") != -1))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\n\t_safeInt(a){\n\t\tconst num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\n\t_setCondition() {\n\t\tconst view = this.view;\n\t\tconst collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tconst data = [];\n\t\tif (collection) {\n\t\t\tcollection.forEach(item => {\n\t\t\t\tconst values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif (webix.isArray(item[1])) {\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0], values.condition);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1], values.condition);\n\t\t\t\t} else\n\t\t\t\t\tvalues.value = this._formatValue(item[1], values.condition);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tdata.push(values);\n\t\t\t});\n\t\t}\n\n\t\twhile (data.length < 3)\n\t\t\tdata.push({ });\n\n\t\tthis._getDatalayout().setValue(data);\n\t}\n\n\t_getDatalayout(){\n\t\treturn this.$dialog.getBody().getChildViews()[0].getChildViews()[1].getBody();\n\t}\n\n\t_formatValue(value, condition){\n\t\tif(!(condition && this._isNotDateRule(condition))){\n\t\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\t\treturn this.editFormat(value);\n\t\t\t}\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value, condition){\n\t\tif(!this._isNotDateRule(condition)){\n\t\t\tif(this.editFormat){\n\t\t\t\tif(isNaN(value)){\n\t\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this._safeInt(value, 10);\n\t\t}\n\t\treturn value;\n\t}\n\n\t_isNotDateRule(condition){\n\t\tif(condition == \"equal\" || condition == \"notEqual\")\n\t\t\treturn false;\n\t\treturn find(this.view.conditions.handlers.text, obj => obj.id == condition);\n\t}\n\n\tokClick(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst type = getType(this.view, this.cell.row, this.cell.column);\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(this.view, this.cell.row, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._getDatalayout().clearAll();\n\t}\n\n\tgetRows(data){\n\t\tconst dialog = this;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tpadding: { right: 4 },\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tconst css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv) {\n\t\t\t\t\t\t\t\tconst elements = this.getFormView().elements;\n\n\t\t\t\t\t\t\t\tif (dialog.editFormat){\n\t\t\t\t\t\t\t\t\tif (dialog._isNotDateRule(newv))\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: \"\"});\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tconst value = dialog._normalizeValue(elements.value.getValue(), newv);\n\t\t\t\t\t\t\t\t\t\telements.value.setValue(dialog._formatValue(value, newv));\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: dialog._formatValue(45000)});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telements.value.refresh();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (newv == \"between\" || newv == \"notBetween\")\n\t\t\t\t\t\t\t\t\telements.value2.show();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\telements.value2.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: this._rulesToArr()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_icon\", icon:\"wxi-trash\", click: vid => {\n\t\t\t\t\t\tconst form = webix.$$(vid).getFormView();\n\t\t\t\t\t\tconst dlayout = this._getDatalayout();\n\t\t\t\t\t\tdlayout.getValue();\t\t\t// save local changes before rendering\n\n\t\t\t\t\t\tconst index = dlayout.getChildViews().indexOf(form);\n\t\t\t\t\t\tdlayout.remove(dlayout.getIdByIndex(index));\n\n\t\t\t\t\t\tif (dlayout.count() < 3) dlayout.add({ });\n\t\t\t\t\t}}\n\t\t\t\t]}\n\t\t\t]};\n\t}\n\n\t$init(){\n\t\tconst margin = webix.skin.$active.layoutMargin.form;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition: \"center\",\n\t\t\twidth: 770,\n\t\t\tmove: true,\n\t\t\tmargin,\n\t\t\tbody: { margin:0, rows:[\n\t\t\t\t{\n\t\t\t\t\theight: 36,\n\t\t\t\t\tpadding: { left: 12 },\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{ view:\"label\", width: 131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t\t\t{ view:\"label\", width: 161, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_icon\", icon:\"wxi-plus-circle\",\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tconst dlayout = this._getDatalayout();\n\t\t\t\t\t\t\t\tdlayout.getValue();\t\t\t// save local changes before rendering\n\t\t\t\t\t\t\t\tdlayout.add({ });\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ width: 4 + webix.env.scrollSize }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"scrollview\",\n\t\t\t\t\tmaxHeight: webix.skin.$active.inputHeight * 3 + 4,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tscroll: \"y\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datalayout\",\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [ this.getRows(getConditionStyle(this.view.config.conditionStyle)) ]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]},\n\t\t\ton: {\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"] },\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\", css:\"webix_ssheet_multicheckbox\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++){\n\t\t\tconst state = sheets[i].state;\n\t\t\tif(state == \"veryHidden\")\n\t\t\t\tcontinue;\n\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\thidden: state == \"hidden\",\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\t\t}\n\n\t\treturn value;\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.getBody().getValues();\n\t\twebix.toExcel(this.view, values);\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\n\t\tthis.view.$handleSelection = (st, end, a)=>{\n\t\t\tform.elements.url.setValue(\"#\"+a);\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\trestoreValue(form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tconst value = this.view.getCellValue(cell.row, cell.column);\n\t\t\tif (value && typeof value == \"string\" && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tconst parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.view.getSelectedId();\n\t\tconst data = this.$dialog.getBody().getValues();\n\n\t\tlet text = \"\";\n\t\tif (data.url){\n\t\t\tdata.name = data.name || data.url;\n\t\t\tif (!/^(#|(https?:\\/\\/))/i.test(data.url))\n\t\t\t\tdata.url = \"http://\" + data.url;\n\t\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t\t}\n\n\t\tthis.view.setCellValue(cell.row, cell.column, text);\n\t\tthis.view.refresh();\n\t\tthis.close();\n\t}\n}","import {isVisible} from \"../sheets\";\n\nexport function print(view, options, htmlOnly){\n\tconst views = [];\n\tconst order = {};\n\tconst active = view._activeSheet;\n\n\tconst html = _buildHtml(view, options, active, views, order);\n\tview.showSheet(active);\n\n\tconst promise = webix.promise.defer();\n\twebix.promise.all(views).then(res =>{\n\t\tconst keys = Object.keys(order).sort( view.$$(\"cells\").data.sorting.as.int );\n\t\tfor (let i = keys.length - 1; i >= 0; i--) {\n\t\t\tconst index = keys[i];\n\t\t\thtml.insertBefore(res[index], html.childNodes[ order[index] ]);\n\t\t}\n\n\t\tif(htmlOnly)\n\t\t\treturn promise.resolve(html);\n\n\t\twebix.html.insertBefore(html, options.docFooter, document.body);\n\t\twindow.print();\n\t\t_cleanHtml(view, html);\n\n\t\tpromise.resolve();\n\t});\n\treturn promise;\n}\n\nexport function init(view){\n\tview.$customPrint = function(options, htmlOnly){\n\t\treturn print(view, options, htmlOnly);\n\t};\n\n\tview._printBorders = {\n\t\tpaper: webix.env.printSizes.find(s => s.id == \"a4\") ? \"a4\" : webix.env.printSizes[0].id,\n\t\tfit: \"page\",\n\t\tmode: \"landscape\",\n\t\tmargin: 1,\n\t\tsheetnames: 1\n\t};\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"print-borders\")\n\t\t\tview.showPrintBorders(value);\n\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", ()=> showBorders(view, true));\n\tview.attachEvent(\"onChange\", ()=> showBorders(view, true));\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active, views, order){\n\tconst doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\tconst pageSize = getPageSize(options);\n\n\tlet sheets = options.sheets;\n\t\n\t// backward compatibility, options.data can be only \"selection\"\n\t// \"current\" and \"all\" are deprecated\n\tconst data = options.data;\n\n\tif(!sheets || data == \"current\" || data == \"selection\")\n\t\tsheets = [active];\n\telse if(typeof sheets == \"string\")\n\t\tsheets = [sheets];\n\telse if(sheets === true || data == \"all\")\n\t\tsheets = view._sheets.map(sheet => sheet.name);\n\n\tsheets = sheets.filter(sheet => isVisible(view, sheet));\n\n\tsheets.forEach((name, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tconst grid = view.$$(\"cells\");\n\n\t\tview.showSheet(name);\n\t\tconst oldZoom = view._zoom;\n\t\tview.ignoreUndo(() => view.zoom(1));\n\n\t\tconst prefix = \"wss_\"+view.$index;\n\n\t\tview._print = true;\n\t\tconst table = grid.$customPrint(options, true);\n\t\tdelete view._print;\n\n\t\tconst tbl = table.firstChild;\n\n\t\tif(tbl){\n\t\t\tconst [header, body] = tbl.children;\n\n\t\t\tconst topSplit = header.childElementCount;\n\t\t\tconst sheetName = options.sheetnames ? 20 : 0;\n\t\t\tlet splitHeight = sheetName;\n\n\t\t\tfor (let s = 1; s <= topSplit; s++)\n\t\t\t\tsplitHeight += grid.getItem(s).$height || grid.config.rowHeight;\n\n\t\t\tif(splitHeight > pageSize.height / 4)\n\t\t\t\tfor (let i = topSplit - 1; i >= 0; i--){\n\t\t\t\t\tif(body.firstChild)\n\t\t\t\t\t\twebix.html.insertBefore(header.children[i], body.firstChild);\n\t\t\t\t\telse\n\t\t\t\t\t\tbody.appendChild(header.children[i]);\n\t\t\t\t}\n\n\t\t\tif(sheetName){\n\t\t\t\tconst sheetNode = webix.html.create(\"tr\", {class:\"webix_ssheet_sheetname\"}, `<td>${name}:</td>`);\n\n\t\t\t\tif(header.firstChild)\n\t\t\t\t\twebix.html.insertBefore(sheetNode, header.firstChild);\n\t\t\t\telse\n\t\t\t\t\theader.appendChild(sheetNode);\n\t\t\t}\n\n\t\t\tconst node = table.firstChild;\n\t\t\tif (node){\n\t\t\t\tif(name != active)\n\t\t\t\t\twebix.html.removeCss(node, \"wss_\"+baseIndex);\n\t\t\t\twebix.html.addCss(node, prefix);\n\t\t\t}\n\n\t\t\tdoc.appendChild(table);\n\t\t}\n\n\t\tif(options.external)\n\t\t\tfor(let id in view.views._pull){\n\t\t\t\tconst innerView = view.views._pull[id];\n\t\t\t\tif(innerView.type == \"image\"){\n\t\t\t\t\tconst img = webix.html.create(\"IMG\", {\n\t\t\t\t\t\tsrc: innerView.data,\n\t\t\t\t\t\twidth: (innerView.config.width || 500)+\"px\",\n\t\t\t\t\t\theight: (innerView.config.height || 300)+\"px\"\n\t\t\t\t\t});\n\n\t\t\t\t\tconst promise = webix.promise.defer();\n\t\t\t\t\tviews.push(promise);\n\t\t\t\t\timg.onload = ()=> promise.resolve();\n\n\t\t\t\t\tdoc.appendChild(img);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tconst externalUI = webix.$$(id).getBody();\n\t\t\t\t\tif(externalUI.$customPrint){\n\t\t\t\t\t\tconst customPrint = externalUI.$customPrint({size: options.size}, true);\n\t\t\t\t\t\tif(customPrint.then){\n\t\t\t\t\t\t\torder[views.length] = doc.childElementCount;\n\t\t\t\t\t\t\tviews.push(customPrint);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdoc.appendChild( customPrint );\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tdoc.appendChild( printInnerView(webix.$$(id).getBody()) );\n\t\t\t\t}\n\t\t\t}\n\n\t\tif(i+1 < view._sheets.length && (tbl || (options.external && Object.keys(view.views._pull).length))){\n\t\t\tconst br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\tdoc.appendChild(br);\n\t\t}\n\n\t\tview.$index = baseIndex;\n\t\tview.ignoreUndo(() => view.zoom(oldZoom));\n\t});\n\n\treturn doc;\n}\n\nfunction printInnerView(view){\n\tconst body = view.$view.cloneNode(true);\n\n\t//copy data from all canvases\n\tconst canvases = view.$view.getElementsByTagName(\"canvas\");\n\tif(canvases.length)\n\t\tfor(let i = canvases.length-1; i >=0; i--){\n\t\t\tconst destCtx = body.getElementsByTagName(\"canvas\")[i].getContext(\"2d\");\n\t\t\tdestCtx.drawImage(canvases[i], 0, 0);\n\t\t}\n\n\tconst container = webix.html.create(\"div\", {class:\"webix_ssheet_ui\"});\n\tcontainer.appendChild(body);\n\n\treturn container;\n}\n\nfunction getPageSize(options){\n\tconst size = webix.env.printSizes.find(size => size.id == options.paper);\n\tconst landscape = options.mode == \"landscape\";\n\n\tconst margin = options.margin ? 2 * webix.env.printMargin : 0;\n\n\treturn {\n\t\twidth: size[landscape ? \"height\" : \"width\"] * webix.env.printPPI - margin,\n\t\theight: size[landscape ? \"width\" : \"height\"] * webix.env.printPPI - margin\n\t};\n}\n\nexport function showBorders(view, redraw){\n\tif(redraw && !view._printBorders.$render)\n\t\treturn;\n\n\tconst borders = {rows:{}, cols:{}};\n\tconst grid = view.$$(\"cells\");\n\tconst options = view._printBorders;\n\n\tconst pageSize = getPageSize(options);\n\n\tconst sheetName = options.sheetnames ? 20 : 0;\n\tlet topSplit = grid.config.topSplit;\n\tlet splitHeight = sheetName;\n\n\tfor (let s = 1; s <= topSplit; s++)\n\t\tsplitHeight += (grid.getItem(s).$height || grid.config.rowHeight) / view._zoom;\n\n\tif(splitHeight > pageSize.height / 4){\n\t\ttopSplit = 0;\n\t\tsplitHeight = sheetName;\n\t}\n\n\tlet rowsHeight = splitHeight;\n\tfor (let r = topSplit + 1; r <= view.config.rowCount; r++) {\n\t\tconst height = (grid.getItem(r).$height || grid.config.rowHeight) / view._zoom;\n\n\t\tif(rowsHeight + height > pageSize.height){\n\t\t\trowsHeight = splitHeight;\n\t\t\tborders.rows[r == 1 ? r : r-1] = 1;\n\t\t}\n\n\t\trowsHeight += height;\n\t}\n\n\tif(options.fit != \"page\"){\n\t\tlet colsWidth = 0;\n\t\tfor (let c = 1; c <= view.config.columnCount; c++) {\n\t\t\tconst width = (grid.getColumnConfig(c).width || grid.config.columnWidth) / view._zoom;\n\n\t\t\tif(colsWidth + width > pageSize.width){\n\t\t\t\tcolsWidth = 0;\n\t\t\t\tborders.cols[c == 1 ? c : c-1] = 1;\n\t\t\t}\n\n\t\t\tcolsWidth += width;\n\t\t}\n\t}\n\n\tview._printBorders.$render = borders;\n\tview.refresh();\n}","import {Dialog} from \"./common\";\nimport {isVisible} from \"../sheets\";\nimport {showBorders} from \"../operations/print\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst list = form.elements.sheets.getList();\n\t\tlist.clearAll();\n\t\tlist.parse( this.getSheets(this.view) );\n\n\t\tform.setValues({\n\t\t\tdata:\"full\",\n\t\t\tsheets: this.view.getActiveSheet(),\n\t\t}, true);\n\t}\n\t$init(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\n\t\tlet paperSize;\n\n\t\tconst printSizes = webix.env.printSizes.map(size => {\n\t\t\tif(size.id == \"a4\")\n\t\t\t\tpaperSize = \"a4\";\n\t\t\tsize.value = labels[\"page-\"+size.id] || size.id;\n\t\t\treturn size;\n\t\t});\n\n\t\tif(!paperSize) paperSize = printSizes[0].id;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:580,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\ton:{\n\t\t\t\tonHide: ()=> {\n\t\t\t\t\twebix.extend(this.view._printBorders, this.getValues(), true);\n\t\t\t\t\tshowBorders(this.view, true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth: 0\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\", vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"full\", value: labels[\"sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value: labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tconst elements = this.getFormView().elements;\n\t\t\t\t\t\t\t\tconst sheets = elements.sheets;\n\n\t\t\t\t\t\t\t\tif(newv == \"full\"){\n\t\t\t\t\t\t\t\t\telements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t\tsheets.enable();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tsheets.disable();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpadding:{\n\t\t\t\t\t\t\t\tright:30\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tname: \"sheets\",\n\t\t\t\t\t\t\t\t\tview: \"multiselect\",\n\t\t\t\t\t\t\t\t\twidth: 160,\n\t\t\t\t\t\t\t\t\tstringResult:false,\n\t\t\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\t\t\tselectAll: true,\n\t\t\t\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\t\t\t\tdata:[]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", value:1, labelRight:labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:labels[\"margin\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"external\", labelRight:labels[\"external-ui\"]},\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", value:paperSize, options:printSizes},\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-layout\"]},\n\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", value:\"page\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ view:\"radio\", name:\"mode\", value:\"landscape\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", hotkey:\"esc\",\n\t\t\t\t\t\t\t\tvalue: labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: labels[\"print-borders\"], autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.printPreview()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: labels.print, hotkey:\"enter\", autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.okClick()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tgetValues(){\n\t\tconst data = this.$dialog.getBody().getValues({disabled:false});\n\t\tdata.margin = data.margin?0:{};\n\t\treturn data;\n\t}\n\tprintPreview(){\n\t\tthis.close();\n\t\tthis.view.showPrintBorders(true);\n\t}\n\tgetSheets(view){\n\t\treturn view._sheets\n\t\t\t.map(sheet => ({value: sheet.name, id: sheet.name}))\n\t\t\t.filter(sheet => isVisible(view, sheet.id));\n\t}\n\tokClick(){\n\t\tconst data = this.$dialog.getBody().getValues({disabled:false});\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(this.view, data);\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\n\t\tconst span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tconst item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t\tif(this.textarea.isVisible())\n\t\t\t\t\t\tthis.textarea.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\twebix.delay(()=>{\n\t\t\tthis.changeTextarea(text);\n\t\t\tthis.textarea.show();\n\t\t\tthis.textarea.focus();\n\t\t});\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tvalue = value / this.view._zoom;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(Math.ceil(value));\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst type = this.type.getValue();\n\n\t\tlet size = \"auto\";\n\t\tif(type == 1)\n\t\t\tsize = this.size.getValue()*1;\n\t\telse if(type == 3)\n\t\t\tsize = this.view.$$(\"cells\").config[this.group == \"row\" ? \"rowHeight\" : \"columnWidth\"];\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 1)\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.disable();\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]},\n\t\t\t\t\t\t\t{id:3, value: locale[\"default-size\"]},\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt, exp, pnt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst box = dialogs[\"add-image-top\"];\n\t\t\tif(box && box.viewid == values.row){\n\t\t\t\tbox.close();\n\t\t\t}\n\t\t}\n\t});\n}","import {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\nimport {updateMaxColumn} from \"../helpers/column_names\";\nimport {find} from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tif(action.group == \"column\" && action.id == \"add\")\n\t\t\t\t\tupdateMaxColumn(view.config.columnCount + (end.column - start.column) + 1);\n\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, dir, extra) => {\n\t\tif (action == \"grid-change\"){\n\t\t\tconst state = view._table.getScrollState();\n\n\t\t\t//if we added rows/cols - regine can update cell references on other pages on undo\n\t\t\tif(extra){\n\t\t\t\tif(!dir)\n\t\t\t\t\tview._mPage[row ? \"removeRow\" : \"removeColumn\"]((row || column)-1, extra.count);\n\t\t\t\telse\n\t\t\t\t\tview._mPage[row ? \"addRow\" : \"addColumn\"]((row || column)-1, extra.count);\n\t\t\t}\n\t\t\t//if removed - can't, so parse full data and show sheet\n\t\t\telse\n\t\t\t\tstate.sheet = view.getActiveSheet();\n\n\t\t\tloadChangedData(view, value, state);\n\t\t}\n\t});\n}\n\nfunction process(action, start, end, view) {\n\tlet select = view._table.getSelectArea();\n\tconst state = view._table.getScrollState();\n\n\tconst del = action.id == \"del\";\n\tconst oldData = view.serialize({sheets: del, viewIds:true});\n\tconst newData = webix.copy(oldData);\n\tconst data = {value:oldData, newValue:newData};\n\n\tif(!del)\n\t\twebix.extend(data, {\n\t\t\t[action.group]: start[action.group],\n\t\t\textra: {\n\t\t\t\tcount: end.row - start.row + 1\n\t\t\t}\n\t\t});\n\n\tconst obj = del ? find(newData, sheet => sheet.name == view.getActiveSheet()).content : newData;\n\n\tconst spanData = [];\n\tconst spans = obj.spans;\n\tfor (let i in spans){\n\t\tconst span = adjustSpan(spans[i], action, start, end, view, obj.data, spanData);\n\t\tif (span[2] <= 0 || span[3] <= 0)\n\t\t\tspans.splice(i, 1);\n\t}\n\n\tconst values = getUpdateValues(action, start, end);\n\tignoreUndo(function(){\n\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\tname: values.name,\n\t\t\tinc: values.inc,\n\t\t\tdata: obj,\n\t\t\tstart: start\n\t\t}]);\n\t},view);\n\n\tif (action.group == \"column\"){\n\t\tif (del)\n\t\t\t_delColumn(action, start, end, view);\n\t\telse\n\t\t\t_addColumn(action, start, end, view);\n\t}\n\telse if (action.group == \"row\") {\n\t\tif (del)\n\t\t\t_delRow(action, start, end, view);\n\t\telse\n\t\t\t_addRow(action, start, end, view);\n\t}\n\n\t// muon updates data and ranges\n\tconst updatedData = view.serialize();\n\tobj.data = updatedData.data;\n\tobj.ranges = updatedData.ranges;\n\n\tspanData.forEach(item => {\n\t\tobj.data.push(item);\n\t});\n\n\tview.callEvent(\"onAction\", [\"grid-change\", data]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, obj, state);\n\t},view);\n\n\tif (select){\n\t\tselect = fixSelectArea(select, view);\n\t\tif (select)\n\t\t\tview.$$(\"cells\").addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, view){\n\tconst config = view.config;\n\n\tconst rows = config.rowCount;\n\tconst cols = config.columnCount;\n\n\tif (select.start.row*1 > rows) select.start.row = rows;\n\tif (select.end.row*1 > rows) select.end.row = rows;\n\tif (select.start.column*1 > cols) select.start.column = cols;\n\tif (select.end.column*1 > cols) select.end.column = cols;\n\n\tif (\n\t\tview.isRowVisible(select.start.row) &&\n\t\tview.isRowVisible(select.end.row) &&\n\t\tview.isColumnVisible(select.start.column) &&\n\t\tview.isColumnVisible(select.end.column)\n\t)\n\t\treturn select;\n}\n\nfunction loadChangedData(view, data, state){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\n\t\tif(state){\n\t\t\tif(state.sheet)\n\t\t\t\tview.showSheet(state.sheet);\n\t\t\tview._table.scrollTo(state.x, state.y);\n\t\t}\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tview._mPage.addColumn(start.column-1, count);\n\tview.config.columnCount += count;\n\n\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _delColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeColumn(start.column-1, count);\n\tview.config.columnCount -= count;\n\n\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _addRow(action, start, end, view) {\n\tconst count = end.row - start.row + 1;\n\n\tview._mPage.addRow(start.row-1, count);\n\tview.config.rowCount += count;\n\n\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}\n\nfunction _delRow(action, start, end, view) {\n\tlet count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeRow(start.row-1, count);\n\tview.config.rowCount -= count;\n\n\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:ed.empty });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:ed.empty });\n\n\t\t\t\t\tif(col.collection){\n\t\t\t\t\t\tcol.collection.clearAll();\n\t\t\t\t\t\tcol.collection.parse(col.options);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(view, name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import {ignoreReset, ignoreUndo} from \"./undo\";\nimport {pasteCondition} from \"./conditional_formats\";\nimport {pasteDropdown} from \"./dropdown\";\nimport {pasteFilter} from \"./filter\";\nimport {pasteSpan} from \"./spans\";\n\nlet styledata, clipdata, origin, cutted, updateFilters, specialPaste;\n\nexport function init(view){\n\tconst clipboard = view.config.clipboard;\n\tconst browserClipboard = navigator.clipboard;\n\n\tif(clipboard === false)\n\t\treturn;\n\n\twebix.clipbuffer.init();\n\tconst buffer = document.querySelector(\".webix_clipbuffer\");\n\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tconst grid = view.$$(\"cells\");\n\n\tgrid.attachEvent(\"onAfterAreaAdd\", () => _sel_to_clip(view, buffer));\n\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tsetClipboard(view, buffer);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id.indexOf(\"paste\") != -1){\n\t\t\tspecialPaste = action.id.split(\"-\")[1];\n\n\t\t\tif(browserClipboard && browserClipboard.readText){\n\t\t\t\tbrowserClipboard.readText()\n\t\t\t\t\t.then(text => {\n\t\t\t\t\t\twebix.clipbuffer.set(text);\n\t\t\t\t\t\t_clip_to_sel(view, grid, buffer.value);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(()=> {\n\t\t\t\t\t\t_clip_to_sel(view, grid, clipdata);\n\t\t\t\t\t})\n\t\t\t\t\t.finally(()=> {\n\t\t\t\t\t\tspecialPaste = null;\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_clip_to_sel(view, grid, clipdata);\n\t\t\t\tspecialPaste = null;\n\t\t\t}\n\t\t}\n\t\telse if(action.id == \"copy\" || action.id == \"cut\"){\n\t\t\tcutted = (action.id == \"cut\")*1;\n\t\t\tsetClipboard(view, buffer, browserClipboard, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, data) => {\n\t\tif (action == \"paste\"){\n\t\t\tconst state = grid.getScrollState();\n\t\t\tconst sel = grid.getSelectArea();\n\t\t\t// data loading resets undo history, and\n\t\t\t// we need to preserve it\n\t\t\tignoreReset(()=>{\n\t\t\t\tview.$handleSelection = null;\n\t\t\t\tview.parse(data);\n\n\t\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t\t\t\tgrid.scrollTo(state.x, state.y);\n\t\t\t});\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", text => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction setClipboard(view, buffer, browserClipboard, menu){\n\tconst grid = view.$$(\"cells\");\n\torigin = grid.getSelectArea();\n\t\n\tstyledata = _get_sel_style(view);\n\n\tif(menu && browserClipboard && browserClipboard.writeText)\n\t\tbrowserClipboard.writeText(buffer.value);\n\n\tclipdata = buffer.value;\n\n\tif(cutted && Object.keys(grid._ssFilters).length !== 0)\n\t\tupdateFilters = allFiltersInZone(grid._ssFilters, view.config.columnCount);\n}\n\nfunction _sel_to_clip(view, buffer){\n\tconst grid = view.$$(\"cells\");\n\tif(grid.getSelectedId())\n\t\twebix.delay(()=>{\n\t\t\tconst data = [];\n\n\t\t\tconst origin = grid.getSelectArea();\n\t\t\tfor(let r = origin.start.row; r <= origin.end.row; r++){\n\t\t\t\tconst row = [];\n\t\t\t\tfor(let c = origin.start.column; c <= origin.end.column; c++)\n\t\t\t\t\trow.push(_updateDelimiter(view.getCellValue(r, c, false), view.config));\n\t\t\t\tdata.push(row);\n\t\t\t}\n\n\t\t\tconst clipdata = webix.csv.stringify(data, grid.config.delimiter);\n\n\t\t\tif (grid.getEditor()){\n\t\t\t\tbuffer.value = clipdata;\n\t\t\t} else {\n\t\t\t\tbuffer.focus();\n\t\t\t\twebix.clipbuffer.set(clipdata);\n\t\t\t}\n\t\t\twebix.UIManager.setFocus(grid);\n\t\t});\n}\n\nfunction _updateDelimiter(value, config) {\n\tconst format = getClipboardNumberFormat(config);\n\n\tif(webix.rules.isNumber(value) && format)\n\t\tvalue = webix.Number.numToStr(format)(value);\n\n\treturn value;\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tif(!text)\n\t\ttext = \"\";\n\n\tconst leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tconst start = leftTop.start;\n\tconst end = leftTop.end;\n\tconst fromSheet = text === clipdata;\n\n\tlet data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet)\n\t\tdata = _changeDelimiter(data, view.config);\n\n\tconst translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\n\tif(specialPaste || !fromSheet){\n\t\tcutted = 0;\n\t\tupdateFilters = 0;\n\t}\n\n\tconst oldData = view.serialize();\n\n\tignoreUndo(()=>{\n\t\t_add_row_col(view, start, data);\n\n\t\tconst dataRowCount = data.length;\n\t\tconst dataColCount = data[0].length;\n\n\t\tconst colCount = end.column - start.column + 1;\n\t\tconst rowCount = end.row - start.row + 1;\n\n\t\tif(fromSheet){\n\t\t\tconst cm = view._mData.getCopyManager();\n\n\t\t\tif (updateFilters){\n\t\t\t\tconst sel = grid.getSelectArea();\n\t\t\t\tview.removeFilters();\n\t\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t\t\t}\n\n\t\t\tconst mode = (!updateFilters && (rowCount > dataRowCount || colCount > dataColCount)) ? 2 : 0;\n\n\t\t\tif(specialPaste != \"conditions\"){\n\t\t\t\tconst selStart = view._mPage.cellID(start.row-1, start.column-1);\n\t\t\t\tconst chunk = view._mData.getStore().getMeta().$chunk;\n\n\t\t\t\tif (cutted == 1){\n\t\t\t\t\tconst sId = view._mPage.cellID(origin.start.row-1, origin.start.column-1);\n\t\t\t\t\tconst eId = view._mPage.cellID(origin.end.row-1, origin.end.column-1);\n\t\t\t\t\tcm.clean(sId,eId,255);\n\t\t\t\t\tcm.move(selStart, chunk);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlet handler;\n\t\t\t\t\tif(specialPaste)\n\t\t\t\t\t\thandler = (a, b) => {\n\t\t\t\t\t\t\tswitch(specialPaste){\n\t\t\t\t\t\t\t\tcase \"formulas\":\n\t\t\t\t\t\t\t\t\treturn webix.extend(a, { value: b.formula || b.value }, true);\n\t\t\t\t\t\t\t\tcase \"styles\":\n\t\t\t\t\t\t\t\t\treturn webix.extend(a, {style: b.style, format: b.format }, true);\n\t\t\t\t\t\t\t\tcase \"values\":\n\t\t\t\t\t\t\t\t\treturn webix.extend(a, {value: b.value }, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\tcm.paste(\n\t\t\t\t\t\tselStart,\n\t\t\t\t\t\tview._mPage.cellID(end.row-1, end.column-1),\n\t\t\t\t\t\tchunk,\n\t\t\t\t\t\tmode,\n\t\t\t\t\t\thandler\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mode == 2) {\n\t\t\t\tfor(let r = 0, ri = 0; r < Math.max(rowCount, dataRowCount); r++, ri++){\n\t\t\t\t\tif(ri == data.length) ri = 0;\n\t\t\t\t\tfor (let c = 0, ci = 0; c < Math.max(colCount, dataColCount); c++, ci++){\n\t\t\t\t\t\tif(ci == data[0].length) ci = 0;\n\n\t\t\t\t\t\tconst subtrans = {\n\t\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\t\tcolumn: translate.column + Math.floor(c/dataColCount) * dataColCount,\n\t\t\t\t\t\t\trow: translate.row + Math.floor(r/dataRowCount) * dataRowCount,\n\t\t\t\t\t\t\tcut: cutted\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t_clipboardToTable(view, start.row + r, start.column + c, data[ri][ci], subtrans);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tgrid.mapCells(\n\t\t\t\t\tstart.row,\n\t\t\t\t\tstart.column,\n\t\t\t\t\tdataRowCount,\n\t\t\t\t\tnull,\n\t\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\t\tconst cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, translate);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(cutted == 1){\n\t\t\t\t//cut and cleared\n\t\t\t\tcutted = 2;\n\t\t\t\tupdateFilters = false;\n\t\t\t}\n\t\t}\n\t\telse \n\t\t\tfor (let r = 0, ri = 0; r < Math.max(rowCount, dataRowCount); r++, ri++) {\n\t\t\t\tif (ri == data.length) ri = 0;\n\t\t\t\tfor (var c = 0, ci = 0; c < Math.max(colCount, dataColCount); c++, ci++) {\n\t\t\t\t\tif (ci == data[0].length) ci = 0;\n\t\t\t\t\tview.setCellValue(start.row + r, start.column + c, data[ri][ci]);\n\t\t\t\t}\n\t\t\t}\n\t}, view);\n\n\tview.callEvent(\"onAction\", [\"paste\", {\n\t\tvalue: oldData,\n\t\tnewValue: view.serialize()\n\t}]);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\"}]);\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, translate){\n\tif (typeof cdata === \"object\"){\n\t\tconst extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition && (!specialPaste || specialPaste == \"conditions\"))\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown && !specialPaste)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\n\t\tif(!specialPaste)\n\t\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\n\t\tview.saveCell(row, col, view.getActiveSheet());\n\t}\n}\n\nfunction _get_sel_style(view){\n\tconst data = [];\n\n\tconst cm = view._mData.getCopyManager();\n\tcm.copy(\n\t\tview._mPage.cellID(origin.start.row-1, origin.start.column-1),\n\t\tview._mPage.cellID(origin.end.row-1, origin.end.column-1)\n\t);\n\n\tfor(let r = origin.start.row; r <= origin.end.row; r++){\n\t\tconst row = [];\n\t\tfor(let c = origin.start.column; c <= origin.end.column; c++){\n\t\t\tconst obj = { text: view.getCellValue(r, c, false) };\n\n\t\t\tconst condition = view.conditions.get(r, c);\n\t\t\tconst editor = view.getCellEditor(r, c);\n\t\t\tconst filter = view.getCellFilter(r, c);\n\t\t\tconst span = view._table.getSpan(r, c);\n\n\t\t\tif (editor || filter || condition || span){\n\t\t\t\tconst extra = { row:r, col:c };\n\t\t\t\tif (condition) extra.condition = condition;\n\t\t\t\tif (editor) extra.dropdown = editor;\n\t\t\t\tif (filter) extra.filter = filter;\n\t\t\t\tif (span) extra.span = span;\n\t\t\t\tobj.extra = extra;\n\t\t\t}\n\n\t\t\trow.push(obj);\n\t\t}\n\t\tdata.push(row);\n\t}\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, config){\n\tconst format = getClipboardNumberFormat(config);\n\n\tif(format)\n\t\tfor(let i = 0; i < data.length; i++)\n\t\t\tfor(let k = 0; k < data[i].length; k++){\n\t\t\t\tconst record = webix.Number.parse(data[i][k], format);\n\t\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\t\tdata[i][k] = record;\n\t\t\t}\n\n\treturn data;\n}\n\nfunction getClipboardNumberFormat(config){\n\tlet format = config.clipboardNumberFormat;\n\n\tif(!format && config.clipboardDecimalDelimiter) // backward compatibility\n\t\tformat = {\n\t\t\tdecimalDelimiter: config.clipboardDecimalDelimiter,\n\t\t\tdecimalOptional: true\n\t\t};\n\n\tif(format)\n\t\twebix.extend(format, {\n\t\t\tminusSign: webix.i18n.minusSign,\n\t\t\tminusPosition: webix.i18n.minusPosition,\n\t\t});\n\n\treturn format;\n}","import group from \"./undo_group\";\n\nexport function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, webix.copy(sel.start), webix.copy(sel.end), view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group, neighbors: action.neighbors }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tconst sel = grid.getSelectArea();\n\n\tconst hash = view._hidden_cols_hash;\n\n\tif(action.neighbors){\n\t\tif(hash[ start.column-1 ])\n\t\t\twhile(hash[ start.column-1 ])\n\t\t\t\tstart.column--;\n\t\telse\n\t\t\twhile(hash[ end.column+1 ])\n\t\t\t\tend.column++;\n\t}\n\n\tgroup.set(()=>{\n\t\tfor (let i = start.column; i <= end.column; i++) {\n\t\t\tif(hash[i]){\n\t\t\t\tdelete hash[i];\n\t\t\t\tconst cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\t\tgrid.showColumn(i);\n\t\t\t\tif (!silent)\n\t\t\t\t\tview.callEvent(\"onColumnOperation\", [action.id, i, i]);\n\t\t\t}\n\t\t}\n\n\t\tconst split = view._frozenColumns;\n\t\tif(split && split >= start.column){\n\t\t\tview.freezeColumns(0); // remove freeze (split is equal with current frozen col)\n\t\t\tview.freezeColumns(split); // if col was freezed on hidden column - move it\n\t\t}\n\n\t\tif (sel)\n\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t}, view);\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tconst sel = grid.getSelectArea();\n\n\tconst hash = view._hidden_rows_hash;\n\n\tif(action.neighbors){\n\t\tif(hash[ start.row-1 ])\n\t\t\twhile(hash[ start.row-1 ])\n\t\t\t\tstart.row--;\n\t\telse\n\t\t\twhile(hash[ end.row+1 ])\n\t\t\t\tend.row++;\n\t}\n\n\tgroup.set(()=>{\n\t\tconst split = view._frozenRows;\n\t\tif(split){\n\t\t\t//Frozen rows ignore filtering applied to the datatable\n\t\t\tview.freezeRows(0);\n\t\t}\t\t\n\n\t\tfor (let i = start.row; i <= end.row; i++) {\n\t\t\tif(hash[i]){\n\t\t\t\tdelete hash[i];\n\n\t\t\t\tif (i - 1 === 0) {\n\t\t\t\t\tconst cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\t\tgrid.refreshColumns();\n\t\t\t\t} else\n\t\t\t\t\tgrid.removeCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\t\t\tif (!silent)\n\t\t\t\t\tview.callEvent(\"onRowOperation\", [action.id, i, i]);\n\t\t\t}\n\t\t}\n\n\t\tview.filterSpreadSheet();\n\n\t\tif(split)\n\t\t\tview.freezeRows(split);\n\n\t\tif (sel)\n\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t}, view);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tif(grid.getColumnIndex(i) != -1){\n\t\t\tview._hidden_cols_hash[i] = i;\n\n\t\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\t\tgrid.hideColumn(i);\n\t\t}\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\treset(view, name == \"column\" ? \"cols\" : \"rows\");\n\n\t\tconst s = start[name];\n\t\tconst hidden = data.table.hidden[name];\n\n\t\tfor (let i = hidden.length - 1; i >= 0; i--) {\n\t\t\tconst hiddenIndex = hidden[i]*1;\n\t\t\tif(inc > 0 && hiddenIndex >= s)\n\t\t\t\thidden[i] = inc + hiddenIndex;\n\t\t\telse if(inc < 0 && hiddenIndex >= s) {\n\t\t\t\tif(hiddenIndex < s - inc)\n\t\t\t\t\thidden.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\thidden[i] = inc + hiddenIndex;\n\t\t\t}\n\t\t}\n\t}\n}","import {encode} from \"../helpers/column_names\";\nimport {pasteCondition} from \"./conditional_formats\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\ttable.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif(!view.config.readonly && finalStep && table.$handleStart){\n\t\t\tconst oldSel = table.getSelectArea();\n\t\t\tconst oldStart = oldSel.start;\n\t\t\tconst oldEnd = oldSel.end;\n\n\t\t\tconst sr = start.row;\n\t\t\tconst er = end.row;\n\t\t\tconst sc = start.column;\n\t\t\tconst ec = end.column;\n\n\t\t\tif(oldStart.row == sr && oldEnd.row > er)\n\t\t\t\tview.clearRange({start:{row:er+1,column:sc}, end:{row:oldEnd.row,column:ec}}, {values:true});\n\t\t\telse if(oldStart.column == sc && oldEnd.column > ec){\n\t\t\t\tview.clearRange({start:{row:sr,column:ec+1}, end:{row:er,column:oldEnd.column}}, {values:true});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet type;\n\t\t\t\tif(sr != oldStart.row || er != oldEnd.row)\n\t\t\t\t\ttype = \"row\";\n\t\t\t\telse if(sc != oldStart.column || ec != oldEnd.column)\n\t\t\t\t\ttype = \"column\";\n\n\t\t\t\tif(type){\n\t\t\t\t\tgroup.start();\n\t\t\t\t\tconst isRow = type == \"row\";\n\t\t\t\t\tfor (\n\t\t\t\t\t\tlet i = (isRow ? sc : sr);\n\t\t\t\t\t\ti <= (isRow ? ec : er);\n\t\t\t\t\t\ti++\n\t\t\t\t\t){\n\t\t\t\t\t\tconst nums = [];\n\t\t\t\t\t\tlet border = [];\n\t\t\t\t\t\tfor (let j = oldStart[type]; j <= oldEnd[type]; j++) {\n\t\t\t\t\t\t\tconst [row, col] = type == \"row\" ? [j, i] : [i, j];\n\t\t\t\t\t\t\tconst value = view.getCellValue(row, col);\n\t\t\t\t\t\t\tif(webix.rules.isNumber(value)){\n\t\t\t\t\t\t\t\tif(!border[0]){\n\t\t\t\t\t\t\t\t\tborder.firstValue = value;\n\t\t\t\t\t\t\t\t\tborder[0] = border[1] = j;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tborder[1] = j;\n\t\t\t\t\t\t\t\t\tif(webix.isUndefined(border.inc))\n\t\t\t\t\t\t\t\t\t\tborder.inc = value - border.firstValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnums[j] = border;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tborder = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst afterSel = oldStart[type] == (isRow ? sr : sc);\n\t\t\t\t\t\tconst start = afterSel ? oldStart[type] : oldEnd[type];\n\t\t\t\t\t\tconst dir = afterSel ? 1 : -1;\n\n\t\t\t\t\t\tfor(\n\t\t\t\t\t\t\tlet j = (afterSel ? oldEnd[type] + 1 : oldStart[type] - 1), index = 0, iteration = 1;\n\t\t\t\t\t\t\tafterSel ? j <= (isRow ? er : ec) : j >= (isRow ? sr : sc);\n\t\t\t\t\t\t\tafterSel ? j++ : j--, index++\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tif(index == oldEnd[type] - oldStart[type] + 1){\n\t\t\t\t\t\t\t\titeration++;\n\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst linkPos = start+index*dir;\n\t\t\t\t\t\t\tconst [linkRow, linkCol] = isRow ? [linkPos, i] : [i, linkPos];\n\n\t\t\t\t\t\t\tlet value = view.getCellValue(linkRow, linkCol);\n\n\t\t\t\t\t\t\tconst num = nums[linkPos];\n\t\t\t\t\t\t\tif(num)\n\t\t\t\t\t\t\t\tvalue += (num.inc || 1) * (num[1] - num[0] + 1) * iteration * dir;\n\n\t\t\t\t\t\t\telse if(typeof value == \"string\" && value[0] == \"=\" && value.length > 0){\n\t\t\t\t\t\t\t\tif(isRow)\n\t\t\t\t\t\t\t\t\tvalue = view._mData.getStore().transposeMath(value, j - start - index * dir, 0);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tvalue = view._mData.getStore().transposeMath(value, 0, j - start - index * dir);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst [row, col] = isRow ? [j, i] : [i, j];\n\t\t\t\t\t\t\tview.setCellValue(row, col, value);\n\t\t\t\t\t\t\tview.setStyle(row, col, view.getStyle(linkRow, linkCol));\n\n\t\t\t\t\t\t\tconst condition = view.conditions.get(linkRow, linkCol);\n\t\t\t\t\t\t\tif(condition)\n\t\t\t\t\t\t\t\tpasteCondition(view, {condition}, row, col);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tview.conditions.clear(row, col);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgroup.end();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = parseFloat(a[key]) || dir*Infinity;\n\t\t\tlet d = parseFloat(b[key]) || dir*Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = a[key].toString().toLowerCase();\n\t\t\tlet d = b[key].toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tconst key = view.getCellValue(range.start.row, range.start.column, false);\n\t\tconst type = isNaN(parseFloat(key)) ? \"str\" : \"int\";\n\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst value = view.getCellValue(row, column, false);\n\t\t\t\tconst style = view.getStyle(row, column);\n\n\t\t\t\tlet math = view.getCellValue(row, column);\n\t\t\t\tmath = math && math[0] == \"=\" ? math : null;\n\n\t\t\t\tconst conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue,\n\t\t\t\t\tstyle,\n\t\t\t\t\tmath,\n\t\t\t\t\trow,\n\t\t\t\t\tconditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst newMath = view._mData.getStore().transposeMath(element.math, row - element.row, 0);\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","import {split} from \"./parser\";\n\nfunction updateSheetNames(view, formula, oldName, newName){\n\tif(formula.indexOf(\"!\") == -1)\n\t\treturn formula;\n\n\tconst stack = split(formula, view, true);\n\tfor(let i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst thisSheet = stack[i][0] === oldName;\n\t\t\tlet sheet = thisSheet ? newName : stack[i][0];\n\t\t\tif(sheet.indexOf(\" \") != -1)\n\t\t\t\tsheet = `'${sheet}'`;\n\t\t\tstack[i] = `${sheet}!${stack[i][1]}`;\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}\n\nfunction isFormula(val){\n\treturn typeof val == \"string\" && val[0] == \"=\";\n}\n\nexport function init(view){\n\tview.attachEvent(\"onSheetRename\", (name, newName) => {\n\t\tview._sheets.forEach(sheet => {\n\t\t\tconst activeSheet = sheet.name == view.getActiveSheet();\n\t\t\tif(activeSheet)\n\t\t\t\tsheet.content = view.serialize(); //actual data\n\n\t\t\tif(sheet.content.editors){\n\t\t\t\tsheet.content.editors.forEach(value => {\n\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\tif(options){\n\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(view, options, name, newName);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\tconst option = options[i];\n\t\t\t\t\t\t\t\tif(typeof option == \"string\"){\n\t\t\t\t\t\t\t\t\tif(isFormula(option))\n\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(view, option, name, newName);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(isFormula(option.id))\n\t\t\t\t\t\t\t\t\toption.id = updateSheetNames(view, option.id, name, newName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(sheet.content.conditions){\n\t\t\t\tsheet.content.conditions.forEach(value => {\n\t\t\t\t\tif(isFormula(value[3]))\n\t\t\t\t\t\tvalue[3] = updateSheetNames(view, value[3], name, newName);\n\t\t\t\t});\n\t\t\t\tif(activeSheet){\n\t\t\t\t\tview.conditions.clear();\n\t\t\t\t\tview.conditions.parse( sheet.content.conditions );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state){\n\tconst grid = view.$$(\"cells\");\n\tconst old = !grid.config.header;\n\n\tif (state == \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(state != old){\n\t\tgrid.config.header = !state;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:state}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:state, value:old}]);\n\t}\n\n\tconst firstVisible = grid.isColumnVisible(\"rowId\");\n\tif((firstVisible && state) || (!firstVisible && !state))\n\t\tgrid.hideColumn(\"rowId\", {}, true, state);\n\n\tgrid.refreshColumns();\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header ? 1 : 0;\n}\n\nexport function load(view, data){\n\tlet mode;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"show-formulas\"){\n\t\t\tshowFormulas(view, value);\n\t\t}\n\t});\n}\n\nexport function showFormulas(view, value){\n\tconst grid = view.$$(\"cells\");\n\tconst old = grid.config.showFormulas;\n\n\tif(value == \"toggle\")\n\t\tvalue = !old;\n\n\tif(value != old){\n\t\tgrid.config.showFormulas = value;\n\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"show-formulas\", value}]);\n\t\tview.callEvent(\"onAction\", [\"show-formulas\", {newValue: value, value: old}]);\n\n\t\tgrid.refresh();\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.showFormulas = view.$$(\"cells\").config.showFormulas ? 1 : 0;\n}\n\nexport function load(view, data){\n\tlet mode = false;\n\tif(data.table && data.table.showFormulas)\n\t\tmode = data.table.showFormulas;\n\tshowFormulas(view, mode);\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\nimport * as m8  from \"./show_formulas\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7,m8];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\n\t\t\t\tif(!upload.file.options)\n\t\t\t\t\tupload.file.options = {};\n\t\t\t\twebix.extend(upload.file.options, {cellDates: false, sheetStubs: view.config.sheetStubs});\n\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\nimport { getDimension } from \"../helpers/array\";\nimport { getConditionCss } from \"../operations/conditional_formats\";\nimport { getRenderedValue } from \"../table\";\nimport {getSheet, isVisible} from \"../sheets\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\tview.$exportView = function(options){\n\t\tconst pdf = options.export_mode == \"pdf\";\n\t\tconst excel = options.export_mode == \"excel\";\n\t\tconst defaultOptions = {\n\t\t\tstubCells: true,\n\t\t\theader: false,\n\t\t\tfooter:false,\n\t\t\theights:true,\n\t\t\trawValues: !pdf,\n\t\t\tfilterHTML:true,\n\t\t\tspans: true,\n\t\t\tstyles:true,\n\t\t\tmath: !pdf,\n\t\t\thidden: excel,\n\t\t\txCorrection: table.config.header || options.hidden ? 1 : 0,\n\t\t\tignore:{rowId:true},\n\t\t\tconditions:true\n\t\t};\n\n\t\twebix.extend(options, defaultOptions);\n\n\t\tif(excel || pdf)\n\t\t\treturn _exportView(view, options);\n\t\telse\n\t\t\treturn table;\n\t};\n\n\ttable.$getExportValue = function(row, column, options){\n\t\tlet value = view.getCellValue(row, column, options.math);\n\t\tconst mode = options.export_mode;\n\t\tconst math = options.math && value[0] == \"=\" && value.length > 1;\n\n\t\tif((mode == \"pdf\" || mode == \"csv\") && !math && !options.rawValues)\n\t\t\tvalue = getRenderedValue(view, row, column);\n\t\telse if(mode == \"excel\" && math){\n\t\t\tif(/^=(image|sparkline)\\(/i.test(value))\n\t\t\t\tvalue = \"\";\n\t\t\telse{\n\t\t\t\tconst id = view._mPage.cellID(row - 1, column - 1);\n\n\t\t\t\tlet arrayRowEnd, arrayColEnd, ref;\n\n\t\t\t\tfor(let r = row+1; r <= view.config.rowCount; r++){\n\t\t\t\t\tconst cell = view._mPage.getCell(r - 1, column - 1);\n\t\t\t\t\tif(cell && cell.source === id)\n\t\t\t\t\t\tarrayRowEnd = r;\n\t\t\t\t\telse break;\n\t\t\t\t}\n\n\t\t\t\tfor(let c = column+1; c <= view.config.columnCount; c++){\n\t\t\t\t\tconst cell = view._mPage.getCell(row - 1, c - 1);\n\t\t\t\t\tif(cell && cell.source === id)\n\t\t\t\t\t\tarrayColEnd = c;\n\t\t\t\t\telse break;\n\t\t\t\t}\n\n\t\t\t\tif(arrayColEnd || arrayRowEnd)\n\t\t\t\t\tref = toRange(row, column, arrayRowEnd || row, arrayColEnd || column);\n\n\t\t\t\tvalue = {\n\t\t\t\t\tvalue: /^=hyperlink\\(/i.test(value) ? value.split(\"\\\"\")[3] : view.getCellValue(row, column, false),\n\t\t\t\t\tformula: value,\n\t\t\t\t\tref\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t};\n}\n\nfunction _exportView(view, options){\n\tconst excel = options.export_mode == \"excel\";\n\n\tif(options.sheets === true) \n\t\toptions.sheets = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\tif(!excel)\n\t\toptions.sheets = options.sheets.filter(sheet => isVisible(view, sheet));\n\telse if(view._sheets.length != options.sheets.length){\n\t\tfor(let i = 0; i < view._sheets.length; i++){\n\t\t\t//add veryHidden sheets in any case\n\t\t\tconst sheet = view._sheets[i];\n\t\t\tif(sheet.state == \"veryHidden\" && options.sheets.indexOf(sheet.name) == -1)\n\t\t\t\toptions.sheets.push(sheet.name);\n\t\t}\n\t}\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\n\t\tconst oldZoom = view._zoom;\n\t\tview.ignoreUndo(() => view.zoom(1));\n\n\t\tif(options.hidden)\n\t\t\toptions.xCorrection = 1;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(id != active)\n\t\t\tsheetOptions._hidden = true;\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tconst pdfTable = !excel && sheetOptions.display != \"image\";\n\n\t\tconst serialized = view.serialize();\n\t\tconst [rows, cols] = getDimension(serialized.data, serialized.spans, 0, 0);\n\n\t\tif(!excel){\n\t\t\tif(webix.isUndefined(sheetOptions.textBefore))\n\t\t\t\tsheetOptions.textBefore = sheetOptions.name;\n\t\t\tif(pdfTable){\n\t\t\t\tsheetOptions.ignore = sheetOptions.ignore || {};\n\t\t\t\tfor(let i = cols+1; i <= view.config.columnCount; i++){\n\t\t\t\t\tsheetOptions.ignore[i] = true;\n\t\t\t\t}\n\n\t\t\t\tconst filter = sheetOptions.filter || (()=>true);\n\t\t\t\tsheetOptions.filter = obj =>{\n\t\t\t\t\treturn obj.id <= rows && filter.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst sheetData = webix[excel ? \"toExcel\" : \"toPDF\"](view._table, sheetOptions);\n\n\t\tif(excel)\n\t\t\tsheetData[0].state = getSheet(view, id).state || \"visible\";\n\n\t\tif(pdfTable && sheetData[0].scheme.length == 0)\n\t\t\tcontinue;\n\n\t\tif((excel || pdfTable) && sheetOptions.styles){\n\t\t\tconst styles = sheetData[0].styles = _getStyles(view, sheetOptions, excel, rows, cols);\n\n\t\t\tif(pdfTable)\n\t\t\t\t_updatePdfData(styles, sheetData, sheetOptions, view, serialized);\n\t\t}\n\n\t\tdata = data.concat(sheetData);\n\n\t\tif(excel){\n\t\t\tdata[i].ranges = [];\n\n\t\t\tview.ranges.serialize(id).forEach(range => {\n\t\t\t\tconst ref = range[1].split(\"!\");\n\t\t\t\tdata[i].ranges.push({\n\t\t\t\t\tSheet: range[2] ? null : i,\n\t\t\t\t\tName: range[0],\n\t\t\t\t\tRef: ref[0]+\"!\"+ref[1].replace(/[0-9]+|[A-Z]+/gi, (match)=>`$${match}`)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tif(options.autowidth)\n\t\t\t\tgetAutowidth(sheetOptions, options);\n\t\t}\n\n\t\tview.ignoreUndo(() => view.zoom(oldZoom));\n\t}\n\n\tview.showSheet(active);\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _updatePdfData(styles, sheetData, sheetOptions, view, serialized){\n\tconst header = sheetOptions.header ? 1 : 0;\n\n\tif (sheetOptions.spans) {\n\t\tconst spans = serialized.spans.sort((a,b) => a[1]<b[1]?1:(a[1]>b[1]?-1:0));\n\t\tfor (let i = 0; i < spans.length; i++) {\n\t\t\tif (spans[i][2] > 1) {\n\t\t\t\tlet row = spans[i][0] - 1 + header, // zero-based row position\n\t\t\t\t\tcol = spans[i][1] - 1, // zero-based col position\n\t\t\t\t\tcols = spans[i][2];\n\t\t\t\tif (styles[row] && styles[row][col]) {\n\t\t\t\t\tstyles[row][col].colspan = cols;\n\t\t\t\t\t// if colspan, then remove merged cells (else PDFJS will shift columns)\n\t\t\t\t\tconst rowData = sheetData[0].exportData[row - header];\n\t\t\t\t\tif (rowData){\n\t\t\t\t\t\t// remove merged cell values\n\t\t\t\t\t\trowData.splice(col + 1, cols - 1);\n\t\t\t\t\t}\n\t\t\t\t\tlet style = Object.values(styles[row]);\n\t\t\t\t\tstyle.splice(col + 1, cols - 1); // remove merged cell styles\n\t\t\t\t\tstyles[row] = style;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst data = sheetData[0].exportData;\n\tfor(let r = 0; r < data.length; r++){\n\t\tfor (let c = 0; c < data[r].length; c++) {\n\t\t\tlet height = view.$$(\"cells\").config.rowHeight;\n\n\t\t\tif(sheetOptions.heights && serialized.sizes.length){\n\t\t\t\tfor(let s = 0; s < serialized.sizes.length; s++){\n\t\t\t\t\tconst rowSize = serialized.sizes[s][0];\n\t\t\t\t\tif(rowSize && rowSize == r+1){\n\t\t\t\t\t\theight = serialized.sizes[s][2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cellStyle = styles[r + header][c];\n\t\t\tconst align = cellStyle.vertAlign;\n\t\t\tconst pad = height*0.75 - cellStyle.fontSize; // available px for padding in top & bottom\n\t\t\tcellStyle.paddingTop = (align == \"top\" ? 0 : (align == \"bottom\" ? pad : pad / 2));\n\t\t\tcellStyle.paddingBottom = (align == \"bottom\" ? 0 : (align == \"top\" ? pad : pad / 2));\n\t\t}\n\t}\n}\n\nfunction getAutowidth(view, options){\n\tconst prop = options.orientation && options.orientation == \"landscape\" ? \"height\" : \"width\";\n\tlet width;\n\n\tif(view.$width)\n\t\twidth = view.$width;\n\telse //'view' can be local settings and we need to compare them with common ones\n\t\twidth = view[prop];\n\n\toptions[prop] = Math.max(options[prop] || 0, width || 0);\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(options){\n\tlet d = defaultStyles;\n\tif(options.export_mode == \"excel\")\n\t\treturn {\n\t\t\tfont:{\n\t\t\t\tsz:d[\"font-size\"]*0.75,\n\t\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\t},\n\t\t\talignment:{\n\t\t\t\thorizontal:d[\"text-align\"],\n\t\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t\t}\n\t\t};\n\telse\n\t\treturn {\n\t\t\tfontSize: d[\"font-size\"]*0.75,\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\ttextAlign: d[\"text-align\"],\n\t\t\twhiteSpace: (d[\"white-space\"]!=\"nowrap\")\n\t\t};\n}\n\nfunction _getStyles(view, options, excel, rows, cols){\n\tview.compactStyles();\n\n\tlet result = [];\n\tconst cached = {};\n\tconst cachedConditions = {};\n\tconst defaults = _getDefaults(options);\n\n\tif(excel && options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\n\tlet rIndex = delta;\n\tgrid.eachRow(row =>{\n\t\tif(row > rows)\n\t\t\treturn;\n\n\t\tlet cIndex = 0;\n\t\tgrid.eachColumn(col => {\n\t\t\tif(cIndex > cols)\n\t\t\t\treturn;\n\n\t\t\tif(cIndex >= options.xCorrection){\n\t\t\t\tconst css = view.getStyle(row, col);\n\t\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\t\tlet styles;\n\t\t\t\tif(css){\n\t\t\t\t\tif(cached[css.id])\n\t\t\t\t\t\tstyles = webix.copy(cached[css.id]);\n\t\t\t\t\telse{\n\t\t\t\t\t\tstyles = _getCellStyle(css.text, excel, options);\n\n\t\t\t\t\t\tfor(let name in defaults){\n\t\t\t\t\t\t\tif(excel)\n\t\t\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\t\t\telse if (!styles[name])\n\t\t\t\t\t\t\t\tstyles[name] = defaults[name];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcached[css.id] = webix.copy(styles);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tstyles = webix.copy(defaults);\n\n\t\t\t\tif(options.conditions){\n\t\t\t\t\t//not real excel condition, save only bg and color (sheetJS doesn't support)\n\t\t\t\t\tconst condition = _getCellConditions(view, row, col, cachedConditions);\n\t\t\t\t\tif(condition)\n\t\t\t\t\t\t_updateStyleCondition(styles, condition, excel);\n\t\t\t\t}\n\n\t\t\t\tresult[rIndex][index] = styles;\n\n\t\t\t\tlet type;\n\t\t\t\tif(options.math){\n\t\t\t\t\tconst math = view.getCellValue(row, col);\n\t\t\t\t\tif(typeof math == \"string\" && math[0] == \"=\" && math.length > 1){\n\t\t\t\t\t\tconst value = view.getCellValue(row, col, false);\n\t\t\t\t\t\tif(isNaN(value))\n\t\t\t\t\t\t\ttype = \"string\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresult[rIndex][index].type = type || getType(view, row, col);\n\t\t\t}\n\t\t\tcIndex++;\n\t\t}, options.hidden);\n\t\trIndex++;\n\t}, options.hidden);\n\n\tif(excel && options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles, excel, options){\n\tlet str = styles.split(\";\");\n\tlet stl = {};\n\tif(excel)\n\t\tstl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tif(excel)\n\t\t\t\t_getExcelCellStyle(stl, str, s);\n\t\t\telse\n\t\t\t\t_getPdfCellStyle(stl, str, s, options.table);\n\t\t}\n\t}\n\n\treturn stl;\n}\n\nfunction _getCellConditions(view, r, c, cached){\n\tconst rendered = getRenderedValue(view, r, c);\n\tconst css = getConditionCss(view, r, c, rendered);\n\tif(css){\n\t\tif(cached[css])\n\t\t\treturn cached[css];\n\t\tconst el = webix.html.create(\"div\", {\"class\":css});\n\t\tdocument.body.appendChild(el);\n\n\t\tconst computed = window.getComputedStyle(el);\n\t\tconst bg = computed.backgroundColor;\n\t\tconst color = computed.color;\n\n\t\tdocument.body.removeChild(el);\n\n\t\tcached[css] = [bg, color];\n\t\treturn cached[css];\n\t}\n}\n\nfunction _updateStyleCondition(stl, condition, excel){\n\tlet [bg, color] = condition.map(val => webix.color.rgbToHex(val));\n\tif(excel){\n\t\tstl.fill = {fgColor:{rgb:bg}};\n\t\tstl.font.color = {rgb:color};\n\t}\n\telse{\n\t\tstl.backgroundColor = bg;\n\t\tstl.color = color;\n\t}\n}\n\nfunction _getExcelCellStyle(stl, str, s){\n\tswitch (style_names[s]){\n\t\tcase \"color\":\n\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\tbreak;\n\t\tcase \"background\":{\n\t\t\tconst fill = _safeColor(str[s]);\n\t\t\tif(fill && fill.toLowerCase() !== \"ffffff\")\n\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\tbreak;\n\t\t}\t\n\t\tcase \"text-align\":\n\t\t\tstl.alignment.horizontal = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"underline\":\n\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"strike\":\n\t\t\tstl.font.strike = str[s] == \"strike\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":\n\t\t\tstl.border[ style_names[s].split(\"-\")[1] ] = getBorderStyles(str[s], true);\n\t\t\tbreak;\n\t\tcase \"indent\":\n\t\t\tstl.alignment.indent = str[s];\n\t\t\tbreak;\n\t}\n}\n\nfunction _getPdfCellStyle(stl, str, s, table){\n\tswitch (style_names[s]) {\n\t\tcase \"color\":\n\t\t\tstl.color = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"background\":\n\t\t\tstl.backgroundColor = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"text-align\":\n\t\t\tstl.textAlign = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.fontSize = str[s].replace(\"px\", \"\")*0.75;\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"underline\":\n\t\t\tstl.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"strike\":\n\t\t\tstl.strikethrough = str[s] == \"strike\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.vertAlign = str[s]; // not supported in PDFJS, so simulate with lineHeight and paddingTop\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.whiteSpace = (str[s] != \"nowrap\");\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":{\n\t\t\tconst pos = style_names[s].split(\"-\")[1];\n\t\t\tstl[`border${pos[0].toUpperCase() + pos.substring(1)}Color`] = getBorderStyles(str[s]);\n\t\t\tbreak;\n\t\t}\n\t\tcase \"indent\":\n\t\t\tif(str[s]){\n\t\t\t\tconst name = `padding${ str[2] == \"right\" ? \"Right\" : \"Left\" }`;\n\t\t\t\tconst padding = table && table[name] ? table[name] : 10; // 10 - default padding value\n\t\t\t\tstl[name] = padding + str[s] * 6;\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n\nfunction getBorderStyles(val, excel){\n\tconst [color, type] = val.split(\",\");\n\n\tif(excel)\n\t\treturn { color:{ rgb:_safeColor(color)}, style:type};\n\telse\n\t\treturn _safeColor(color);\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tconst str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"), true);\n}","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { formatCache, formatsCount } from \"../operations/formats\";\nimport { find } from \"../helpers/array\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tconst options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tconst full = { sheets:[]};\n\t\tconst fmt = {count: formatsCount, cache:{}};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tstate:obj.states[i],\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i, fmt)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tconst dataObj = webix.copy(obj);\n\t\tconst data = [];\n\n\t\tfor(let i = 0; i < dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tconst row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data };\n\t};\n}\n\nfunction _excel_to_data(obj, ranges, index, fmt){\n\tconst dataObj = webix.copy(obj.data);\n\tconst data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tconst row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r < ranges.length; r++){\n\t\t\tconst sheetIndex = ranges[r].Sheet;\n\t\t\tconst book = webix.isUndefined(sheetIndex);\n\t\t\tif(book || sheetIndex === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\"), book]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj, fmt);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\tif(obj.hidden){\n\t\t_getHidden(obj);\n\t}\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getHidden(obj){\n\tconst hidden = {\n\t\trow:[],\n\t\tcolumn:[]\n\t};\n\n\tfor(let i = 0; i < obj.hidden.length; i++){\n\t\tconst item = obj.hidden[i];\n\t\tif(item[0] == \"column\")\n\t\t\thidden.column.push(item[1]+1);\n\t\telse\n\t\t\thidden.row.push(item[1]+1);\n\t}\n\n\tobj.table = {hidden};\n}\n\nfunction _getBorderStyles(pos, stl){\n\tpos = pos.replace(\"border-\", \"\");\n\tif(stl.border && stl.border[pos]){\n\t\tconst border = stl.border[pos];\n\t\tif(border.color){\n\t\t\tconst color = _safeColor(border.color.rgb) || \"\";\n\t\t\tconst type = border.style || \"\";\n\t\t\treturn `${color},${type}`;\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction _getStyles(obj, fmt){\n\tlet stylescount = 1;\n\tconst styleshash = {}, styles = [], formats = [];\n\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color ? (_safeColor(stl.font.color.rgb) || \"\") : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor ? (_safeColor(stl.fill.fgColor.rgb) || \"\") : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ? stl.alignment.horizontal : \"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name ? _safeFont(stl.font.name) : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz ? ((stl.font.sz/0.75)+\"px\" || \"\") : \"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic ? \"italic\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"underline\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline ? \"underline\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"strike\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.strike ? \"strike\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold ? \"bold\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":{\n\t\t\t\t\tconst va = stl.alignment ? (stl.alignment.vertical || \"\") : \"\";\n\t\t\t\t\tstr[s] = (va == \"center\" ? \"middle\" : va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText ? \"wrap\" : \"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":{\n\t\t\t\t\tlet format = stl.numFmt;\n\t\t\t\t\tlet name = \"\";\n\t\t\t\t\tif(format && format != \"General\"){\n\t\t\t\t\t\tformat = format.replaceAll(\"\\\\\", \"\");\n\t\t\t\t\t\tif(formatCache[format])\n\t\t\t\t\t\t\tname = formatCache[format];\n\t\t\t\t\t\telse if(fmt.cache[format])\n\t\t\t\t\t\t\tname = fmt.cache[format];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tname = fmt.cache[format] = \"fmt\"+(fmt.count++);\n\n\t\t\t\t\t\tif(!find(formats, arr => arr[0] == name))\n\t\t\t\t\t\t\tformats.push([name, format]);\n\t\t\t\t\t}\n\t\t\t\t\tstr[s] = name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"border-right\":\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\tcase \"border-left\":\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = _getBorderStyles(style_names[s], stl);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"indent\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.indent ? stl.alignment.indent : \"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\n\tobj.formats = formats;\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\"){\n\t\t\t\tsize *= view._zoom;\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\t}\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state, page){\n\tlock.lockCell(this, row, column, state, false, page);\n}\n\nexport function isCellLocked(row, column, page){\n\treturn lock.isCellLocked(this, row, column, page);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(column) ){\n\t\tconst sel = grid.getSelectArea();\n\t\tcolumn = sel ? sel.end.column : 0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tlet removeFreeze = false;\n\tif (column && column != this._frozenColumns){\n\t\tfor (let i = column; i > 0; i--) {\n\t\t\tindex = grid.getColumnIndex(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!index) index = base;\n\t}\n\telse removeFreeze = true;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = (removeFreeze || !column) ? 0 : column;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tconst sel = grid.getSelectArea();\n\t\trow = sel ? sel.end.row : 0;\n\t}\n\n\tlet index = 0;\n\tlet removeFreeze = false;\n\tif (row && row != this._frozenRows){\n\t\tfor (let i = row; i > 0; i--) {\n\t\t\tindex = grid.getIndexById(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\telse removeFreeze = true;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = (removeFreeze || !row) ? 0 : row;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\tconst spans = grid.getSpan();\n\tlet changed;\n\n\tfor(let row in spans){\n\t\tif(type == \"row\" && row > num)\n\t\t\tcontinue;\n\n\t\tfor (let col in spans[row]){\n\t\t\tif(type == \"column\" && col > num)\n\t\t\t\tcontinue;\n\n\t\t\tconst span = spans[row][col];\n\t\t\tconst spanSize = type == \"row\" ? (row*1) + span[1] - 1 : (col*1) + span[0] - 1;\n\n\t\t\tif(spanSize > num){\n\t\t\t\tchanged = true;\n\t\t\t\tchangeSpan(\n\t\t\t\t\tview,\n\t\t\t\t\t[row, col],\n\t\t\t\t\ttype == \"row\" ? span[0] : span[0] - (spanSize - num),\n\t\t\t\t\ttype == \"row\" ? span[1] - (spanSize - num) : span[1]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tif(changed)\n\t\tview.refresh();\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1], true);\n\tview.combineCells(\n\t\t{\n\t\t\tcell:{\n\t\t\t\trow:span[0],\n\t\t\t\tcolumn:span[1]\n\t\t\t},\n\t\t\tx,\n\t\t\ty,\n\t\t},\n\t\ttrue\n\t);\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {image, chart} from \"../mathematics/writer\";\nimport {addMath} from \"../mathematics/methods\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\n// getSheetData is deprecated, use ss.getCellValue(row, col, math, page), ss.getRangeValue(range, page) instead\nexport function getSheetData(name){\n\tif(this._mData.getPage(name))\n\t\treturn {\n\t\t\tgetValue: (r, c, math)=> this.getCellValue(r, c, math, name),\n\t\t\tgetRangeValue: (range)=> this.getRangeValue(range, name)\n\t\t};\n}\n\nexport function registerMathMethod(name, handler){\n\taddMath(this, name, handler, true);\n}\n\nexport function recalculate(){\n\tthis._mData.getStore().recalculate();\n\tthis.callEvent(\"onMathRefresh\",[]);\n\tthis.refresh();\n}\n\nexport function setPlaceholder(name, value){\n\tif(typeof name == \"object\"){\n\t\tvalue = name;\n\t\tname = \"*\";\n\t}\n\n\tthis._mData.getStore().setPlaceholder(name, value);\n\n\tthis.refresh();\n\tthis.callEvent(\"onMathRefresh\",[]);\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\nimport {showCells} from \"../operations/show_cells\";\n\n//spans\nexport function combineCells(range, silent){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\n\tif(!silent)\n\t\tthis.refresh();\n}\n\nexport function splitCell(row, column, silent){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tif(!silent)\n\t\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n//serialize\nexport function serialize(config){\n\tconst obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif(config){\n\t\tif(config.compactStyles)\n\t\t\tobj.styles = stl.removeUnusedStyles(obj);\n\t\tif(config.sheets)\n\t\t\treturn sheets.serialize(this, obj, config);\n\t}\n\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function setSheetState(name,state){\n\tsheets.setState(this,name,state);\n}\nexport function getSheetState(name){\n\treturn sheets.getSheet(this,name).state || \"visible\";\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content, name, show){\n\treturn sheets.add(this, content, name, show);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n//sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}\n\n//cells\nexport function showCell(ref, silent){\n\tshowCells(this, ref, silent);\n}","import {toRange,rangeObj,range as getRange} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet, prepareCell} from \"../sheets\";\nimport {getType, loadCell} from \"../operations/types\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\nimport {checkFormat, getFormatFromData} from \"../operations/formats\";\nimport * as arr from \"../helpers/array\";\nimport {fillEditor} from \"../editor\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column, math, page){\n\tpage = page ? this._mData.getPage(page) : this._mPage;\n\n\tif(!page)\n\t\treturn;\n\n\tconst value = page.getValue(row-1, column-1, math !== false);\n\n\treturn correctVal(value);\n}\nexport function setCellValue(row, column, value, page){\n\tif(!page)\n\t\tpage = this.getActiveSheet();\n\n\tconst muonPage = this._mData.getPage(page);\n\tif(!muonPage)\n\t\treturn;\n\n\tvalue = correctVal(value);\n\tconst old = this.getCellValue(row, column, true, page);\n\tconst oldType = getType(this, row, column, page);\n\n\tlet sameValue;\n\tif(oldType == \"date\"){\n\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\tconst dateValue = isNaN(value) ? getExcelDateFromJs(parser(value)) : value;\n\t\tsameValue = old == dateValue;\n\t}\n\telse if(oldType != \"string\" && value !== \"\" && !isNaN(value) && old == value && value !== 0){\n\t\tsameValue = true;\n\t\tvalue = value*1;\n\t}\n\n\tif (!sameValue && old !== value){\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old, page])){\n\t\t\t\tif(page != this.getActiveSheet()){\n\t\t\t\t\tconst sheet = arr.find(this._sheets, sheet => sheet.name == page).content;\n\t\t\t\t\tlet cell = arr.find(sheet.data, cell => cell[0] == row && cell[1] == column);\n\n\t\t\t\t\tif(!cell){\n\t\t\t\t\t\tcell = [row, column];\n\t\t\t\t\t\tsheet.data.push(cell);\n\t\t\t\t\t}\n\t\t\t\t\tcell[2] = value;\n\n\t\t\t\t\tthis._page_value_set = true;\n\t\t\t\t\tcell[4] = null;\n\t\t\t\t\tconst item = loadCell(this, sheet, cell);\n\t\t\t\t\tdelete this._page_value_set;\n\n\t\t\t\t\tconst muonItem = muonPage.getCell(row-1, column-1, true);\n\t\t\t\t\tmuonItem.$format = checkFormat({ fmt: getFormatFromData(sheet, cell) }, \"string\") ? 1 : 0;\n\t\t\t\t\tmuonPage.setValue(row-1, column-1, item.value);\n\n\t\t\t\t\tcell[2] = item.value;\n\t\t\t\t\tcell[4] = muonItem.type = item.type;\n\n\t\t\t\t\t//prepareCell can change style (1/1/2001 --loadCell--> 36892 + date type --prepareCell--> date format)\n\t\t\t\t\tprepareCell(cell, sheet, true);\n\t\t\t\t\tmuonItem.style = cell[3];\n\n\t\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, item.value, page]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconst sel = this.getSelectedId();\n\t\t\t\t\tfillEditor(this, sel, true);\n\n\t\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\t\t//onCellChange can change item (via types module)\n\t\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value, page]);\n\t\t\t\t\tconst updatedType = getType(this, row, column);\n\n\t\t\t\t\t//recalculate if we refer to a cell, where type is string and value is something like 005 or 5e5\n\t\t\t\t\tif(oldType != updatedType && updatedType == \"string\" && value[0] == \"=\" && value.length > 1)\n\t\t\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\t\tfillEditor(this, sel);\n\n\t\t\t\t\tif(/^=hyperlink\\(/i.test(value)){\n\t\t\t\t\t\tconst baseStyle = this.getStyle(row, column);\n\t\t\t\t\t\tconst urlStyle = this.addStyle({ color: \"#0000ff\", underline: \"underline\" }, baseStyle);\n\t\t\t\t\t\tthis.setStyle(row, column, urlStyle);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.saveCell(row, column, page);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction correctVal(val){\n\tif(typeof val === \"boolean\")\n\t\tval *= 1;\n\treturn val || val === 0 ? val : \"\";\n}\n\nexport function setRangeValue(range, value, page){\n\tgroup.set(function(){\n\t\tconst pos = rangeObj(range, this);\n\t\tlet i = 0;\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++, i++) {\n\t\t\t\tthis.setCellValue(row, column, webix.isArray(value) ? value[i] : value, page);\n\t\t\t}\n\t\t}\n\t},this);\n}\n\nexport function getRangeValue(range, page){\n\tif(!page)\n\t\tpage = this.getActiveSheet();\n\n\tconst pos = getRange(range, this, page);\n\tconst muonPage = this._mData.getPage(pos[4]);\n\n\tif (!pos || !muonPage) return [];\n\n\treturn muonPage.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1).map(correctVal);\n}\n\nexport function getRow(id){\n\tconst row = webix.copy(this._table.getItem(id));\n\n\tfor(let i = 1; i <= this.config.columnCount; i++){\n\t\tconst cell = this._mPage.getCell(id-1, i-1);\n\n\t\tif(cell){\n\t\t\trow[i] = cell.value;\n\n\t\t\t[[\"style\", \"$cellCss\"], [\"type\", \"$cellType\"], [\"format\", \"$cellFormat\"]].forEach(param => {\n\t\t\t\tconst val = cell[param[0]];\n\t\t\t\tif(val){\n\t\t\t\t\tif(!row[param[1]])\n\t\t\t\t\t\trow[param[1]] = {};\n\t\t\t\t\trow[param[1]][i] = val;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst math =  this.getCellValue(id, i, true);\n\t\t\tif(math && math[0] == \"=\")\n\t\t\t\trow[\"$\"+i] = math;\n\t\t}\n\t}\n\n\treturn row;\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column, page){\n\tconst cell = (page ? this._mData.getPage(page) : this._mPage).getCell(row-1, column-1);\n\n\tsave(this, \"data\", {\n\t\trow,\n\t\tcolumn,\n\t\tvalue: this.getCellValue(row, column, null, page),\n\t\tpage: page || this.getActiveSheet(),\n\t\tstyle: (cell ? cell.style : \"\") || \"\"\n\t});\n}","export function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || null;\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || null;\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tconst grid = this._table;\n\tgrid.data.silent(()=>{\n\t\t// hidden rows\n\t\tgrid.data.filter(obj => this.isRowVisible(obj.id));\n\n\t\tconst filters = flt.getFilters(grid);\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tconst {row, column, handler, lastRow} = filters[i];\n\n\t\t\tlet finished = false;\n\t\t\tgrid.data.filter(obj => {\n\t\t\t\tlet r = obj.id;\n\t\t\t\tif(r <= row || typeof handler != \"function\")\n\t\t\t\t\treturn true;\n\n\t\t\t\tconst span = grid.getSpan(r, column);\n\t\t\t\tif(span){\n\t\t\t\t\tif(span[0] == row && span[1] == column)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\telse\n\t\t\t\t\t\tr = span[0];\n\t\t\t\t}\n\n\t\t\t\tconst value = String(this.getCellValue(r, column, false));\n\n\t\t\t\tif(lastRow){\n\t\t\t\t\tif(r > lastRow)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if(finished || !value)\n\t\t\t\t\treturn finished = true;\n\n\t\t\t\treturn handler(value);\n\t\t\t}, 1, true);\n\t\t}\n\t});\n\n\tgrid.callEvent(\"onAfterFilter\", []);\n\tgrid.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcontainer: this.$view,\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcontainer: this.$view,\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\ttype:config.type,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","import * as formulas from \"../operations/show_formulas\";\n\nexport function showFormulas(state){\n\tformulas.showFormulas(this, state);\n}","import {showBorders} from \"../operations/print\";\n\nexport function showPrintBorders(value){\n\tconst old = !!this._printBorders.$render;\n\n\tif(value == \"toggle\")\n\t\tvalue = !old;\n\n\tif(value != old){\n\t\tif(value)\n\t\t\tshowBorders(this);\n\t\telse{\n\t\t\tdelete this._printBorders.$render;\n\t\t\tthis.refresh();\n\t\t}\n\n\t\tthis.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"print-borders\", value}]);\n\t\tthis.callEvent(\"onAction\", [\"print-borders\", {newValue: value, value: old}]);\n\t}\n}","import {zoom as zoomView} from \"../operations/zoom\";\n\nexport function zoom(value){\n\tzoomView(this, value);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"},\n\t\t\t{id: \"hide-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"},\n\t\t{id: \"print\"},\n\t\t{id: \"print-borders\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"},\n\t\t{id: \"show-formulas\"}\n\t]}\n];\n\nconst readonlyMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"excel-export\"},\n\t\t{id: \"print\"},\n\t\t{id: \"print-borders\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tconst config = view.config;\n\tconst menu = {\n\t\tview: \"menu\",\n\t\tborderless: true,\n\t\tcss: \"webix_ssheet_menu\",\n\t\tid: \"menu\",\n\t\tautowidth: true,\n\t\ttype:{\n\t\t\theight: 40\n\t\t},\n\t\tdata: ui.getMenuData(\n\t\t\twebix.isArray(config.menu) ? config.menu : webix.copy(config.readonly ? readonlyMenu : defaultMenu),\n\t\t\tconfig\n\t\t)\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": view => view.undo(),\n\t\"redo\": view => view.redo(),\n\t\"insert-column\": view => view.insertColumn(),\n\t\"delete-column\": view => view.deleteColumn(),\n\t\"show-column\": view => view.callEvent(\"onCommand\",[{id: \"show\", group: \"column\", neighbors:true}]),\n\t\"hide-column\": view => view.hideColumn(null,true),\n\t\"resize-column\": view => view.callEvent(\"onCommand\",[{\n\t\tid: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]\n\t}]),\n\t\"insert-row\": view => view.insertRow(),\n\t\"delete-row\": view => view.deleteRow(),\n\t\"show-row\": view => view.callEvent(\"onCommand\",[{id: \"show\", group: \"row\", neighbors:true}]),\n\t\"hide-row\": view => view.hideRow(null,true),\n\t\"resize-row\": view => view.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]),\n\t\"freeze-columns\": view => view.freezeColumns(),\n\t\"freeze-rows\": view => view.freezeRows(),\n\t\"hide-gridlines\": view => view.hideGridlines(\"toggle\"),\n\t\"hide-headers\": view => view.hideHeaders(\"toggle\"),\n\t\"show-formulas\": view => view.showFormulas(\"toggle\"),\n\t\"print-borders\": view => view.showPrintBorders(\"toggle\")\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\nimport * as chart from \"./chart\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\tliveEditor: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst readonly = obj.readonly;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif((readonly && (obj.toolbar || obj.buttons)) || (!readonly && obj.toolbar !== false))\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !readonly,\n\t\t\tliveEditor: obj.liveEditor\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\tif(readonly)\n\t\t\trows.push(tbl.init(this, tblObj));\n\t\telse\n\t\t\trows.push({cols:[tbl.init(this, tblObj), chart.init(this)]});\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tconst excel = obj.excel;\n\n\t\tif (excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj, excel);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tconst locale = webix.i18n.spreadsheet.menus;\n\n\tlet clipboard = [];\n\tif(view.config.clipboard !== false)\n\t\tclipboard = [\n\t\t\t{ id:\"cut\", value: locale.cut},\n\t\t\t{ id:\"copy\", value: locale.copy},\n\t\t\t{ id:\"paste\", value: locale.paste},\n\t\t\t{ id:\"special-paste\", value: locale[\"special-paste\"], submenu:[\n\t\t\t\t{id: \"paste-values\", value: locale[\"paste-values\"]},\n\t\t\t\t{id: \"paste-formulas\", value: locale[\"paste-formulas\"]},\n\t\t\t\t{id: \"paste-styles\", value: locale[\"paste-styles\"]},\n\t\t\t\t{id: \"paste-conditions\", value: locale[\"paste-conditions\"]},\n\t\t\t]}\n\t\t];\n\n\tconst lists = {\n\t\tdata: clipboard.concat([\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t]),\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m16a from \"../mathematics/methods\";\nimport * as m16b from \"../mathematics/ranges\";\nimport * as m16c from \"../mathematics/sheets\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\nimport * as m31 from \"./show_formulas\";\nimport * as m32 from \"./zoom\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m32,m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m16b,m16c,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\nimport * as fml from \"./show_formulas\";\nimport * as prt from \"./print\";\nimport * as zoom from \"./zoom\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt, fml, prt, zoom];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","skin","$name","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","title","onChange","suggest","fitMaster","hide","getValue","$$","master","setValue","getList","getColorView","getTypeView","getSelectedId","getBody","getChildViews","getItemText","$ready","push","bind","getPopup","isArray","old","callEvent","join","height","palette","attachEvent","setMasterValue","colorboard","icon","borderless","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","Object","defineProperty","exports","r","e","setPrototypeOf","__proto__","Array","hasOwnProperty","assign","n","length","o","t","constructor","create","1","3","4","i","a","u","f","s","h","c","l","code","g","source","d","y","_","M","pageName","p","substr","toUpperCase","b","w","E","C","m","String","charCodeAt","v","I","T","D","Y","A","S","x","L","page","R","B","N","F","k","P","U","X","H","broken","G","_store","move","_pageGetter","getContext","_r","forEach","setMath","_getTriggersOutsideCutRange","_updateCurrentCell","split","Set","from","yr","strict","_pageNames","_pageName2ID","Map","_pCounter","toId","z","pr","spill","$format","parseFloat","_pages","getPage","addPage","_parseContext","delete","find","firstOnly","eachCell","T_PAGE","fromId","methodGroups","methods","row","str2id","addMath","handler","sort","addMethod","popup","list","exists","add","getJsDateFromExcel","excelDate","date","Date","Math","round","getTime","getTimezoneOffset","getExcelDateFromJs","jsDate","toString","init","math","IMAGE","url","escape","HYPERLINK","attrs","SPARKLINE","arr","type","color1","color2","negativeColor","paddingX","paddingY","extend","donut","horizontal","tableConfig","isCircle","columnWidth","rowHeight","Sparklines","getTemplate","keys","key","getJsDate","isNaN","getExcelDate","datepicker","$prepareValue","copy","start","end","daterangepicker","buttons","close","getBodyConfig","content","elements","getFormElements","padding","$active","layoutPadding","form","label","cancel","autowidth","click","getTopParentView","save","hotkey","body_setter","_typeof","isUndefined","window","head","autofocus","IdSpace","headerRowHeight","datatable","getItem","setHTML","dataview","contextmenu","group","set","method","uid","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","thread","events","newName","_loading_data","params","activeSheet","getActiveSheet","clearTimeout","delay","decode","encode","alpha","indexToHeader","index","chars","quotient","floor","updateMaxColumn","maxColumn","str","adress","size","col","range","nind","indexOf","sheet","parts","ranges","getCode","rangeParts","d1","d2","escapeSheet","toRange","x2","y2","rangeObj","column","eachRange","callback","isRange","cells","isCell","pop","cellTest","test","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","fonts","material","mini","flat","compact","contrast","willow","dark","style_names","_style_map","format","left","center","right","top","middle","bottom","wrap","zoom","getBorderCss","underline","strike","indent","count","pos","innerCss","fontSize","border","sizeEl","border_checks","cell","area","mode","_style_handlers","getSelectArea","lineStyle","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","html","removeStyle","zoomStyles","_serialize","_parse","getStyle","_mPage","getCell","span","getSpan","spanStyles","spanStyle","getFormat","styles","addStyle","props","origin","styleFromText","map","styleToText","cache","_addStyle","styleObj","update_style_data","nstyle","setStyle","_setStyle","setRangeStyle","getTextSize","baseWidth","innerHTML","_table","appendChild","max","offsetWidth","offsetHeight","removeChild","toolbar","oldFormat","formatChanged","saveCell","sel","silent","_buildCssString","outCss","_zoom","clearRangeStyle","compactStyles","serialized","removeUnusedStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","oldVal","refresh","_undoStyle","func","findIndex","result","getDimension","spans","line","spanEndRow","spanEndCol","formatsCount","formatCache","formatSources","formatHelpers","currencies","defaultFormats","common","setDefaultFormats","formatsLocale","price","concat","getCurrencySymbol","trim","extra","minusSign","abs","priceFormat","values","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","formatToForm","dates","timeFormat","fullDateFormat","longDateFormat","red","first","second","substring","priceBrackets","currency","isPrice","delimiters","integer","decimal","addFormat","nev","removeFormat","splitFormat","conditional","errorMessage","separated","separateFmt","genCode","condition","toLowerCase","fmt","Function","err","check","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","symbolPos","multiply","lastDateType","val","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","timeOrder","typesOrder","order","types","j","changeAreaDecimals","getCells","rules","isNumber","changeCellDecimals","getFormatName","isCustom","updateDecimals","parsed","decimals","placeholders","slice","withoutText","withoutPlaceholders","formValues","symbolId","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","Infinity","checkFormat","checkTime","quot","item","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","getFormatFromData","array","styleName","fmtName","load","isChar","char","getLastCharIndex","includeNumbers","lastChar","getWord","formula","quotes","operand","position","word","sum","flags","crosssheet","fromSheet","lines","ph","escaped","next","pushLine","loadCell","setType","dateToExcel","_page_value_set","setCellValue","getFormatType","formatType","getType","_mData","parseToStore","_setType","mathFormat","isFormula","parseDate","getMathFormat","blockLevel","level","part","expectType","getExpectType","strToDate","parseDateTime","parser","ignoreUndo","checkType","updateCell","isString","cellEditor","getCellEditor","setFormat","setCellEditor","editor","filter","cursor","getInputNode","selectionStart","charAt","search","nextSymbol","node","tagName","_this","sizes","offset","textWidth","show","setValueHere","$enterKey","isVisible","getCellValue","action","newValue","getPopupConfig","onItemClick","button","getSheetData","suggestData","onBeforeShow","oldRanges","remove","allRanges","global","suggestRanges","sRange","highlight","_highlightedCells","_update_range","_last_value_set","activeCell","showActiveSheet","updateCellValue","blur","preventEvent","$handleSelection","UIManager","setFocus","eventRemove","keydownEv","event","_this2","endEdit","escapeText","changeCellCss","_activeMath","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","enter","grid","define","showSheet","moveSelection","which","keyCode","shiftKey","getItemNode","newv","$setValueHere","str1","str2","setSelectionRange","expectOperator","ignoreSel","setRange","len","lastPos","prepareArea","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","toggle","offValue","onValue","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrowCss","arrow","iconCss","inputSpacing","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","$hiddenSheet","$all","_count","base","hidden","labelRight","active","baseHeight","inputHeight","checkboxes","output","cfg","scrollview","queryView","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","addHotKey","_removeView","getMenu","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","parseInt","submenu","readonly","submenuConfig","externalUI","onMenuItemClick","_menuActions","_toggleExcel","dots","toPDF","display","toPNG","header","pull","showMenuItem","hideMenuItem","layoutMargin","multi","getSectionConfig","onAfterScroll","addSection","trashIcon","dataPadding","upper","marker","onClick","removeView","childs","getLayout","lastIndex","layoutId","addView","setValues","setSubValue","sub","hideSubviews","child","getValues","$getSize","bodySize","env","scrollSize","$setSize","oldScroll","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","freezeColumns","freezeRows","getState","columns","ids","splice","_undoValue","actionMap","_remove","confirm","then","_activeSheet","edit","setState","ready","prepare","selectSheet","showItem","command","changePagerVisability","changePagerStatus","once","context","dataOrder","num","_sheets","rename","numbers","defaultBottom","tabWidth","sheetTabWidth","minTabWidth","getSheetsPopup","maxHeight","autoheight","onShow","clearAll","parse","maxWidth","editable","editaction","editValue","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","oneSheet","disabled","batch","scrollSheets","gravity","oldV","direction","step","scrollTo","scrollPos","disable","enable","scrollWidth","$width","showBatch","tab","getSheet","visibleSheets","getVisible","showPrevious","_filterTabs","tabs","newIndex","getNewTitle","prepareData","prevIndex","removePage","changeId","renamePage","editors","invalidValue","linkRegex","prepareCell","update","isDate","link","styleProperties","newSheet","DataStore","sheetName","rowCount","columnCount","_resetTable","bottombar","oldZoom","defWidth","defHeight","ceil","getColumnConfig","$height","rowId","getColumn","zoomSizes","_adjustRowHeight","eachColumn","spanHeight","getText","getSpanNode","getCellFilter","textHeight","resizeCell","headerOnly","refreshSelectArea","_undoResize","setColumnWidth","updatePosition","nsizes","readyZoom","getNext","minColumnWidth","nextValue","readOnly","shift","counter","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","popupInit","$value","actions","isMerged","c0","splitCell","combineCells","undo","redo","hideGridlines","hideHeaders","showFormulas","showPrintBorders","fontFamily","getColumnOperation","colOperations","neighbors","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getCellFormats","example","number","getAllElements","calcButtons","groups","$button","insert","selected","updateValue","element","allElements","elm","toolbarButtons","structure","checkButtons","getButtons","block","blockColumns","bar","$customScroll","maxSize","limited","viewId","innerId","barStyles","getBarStyles","dropdowns","getCellStyles","cellStyle","property","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","eachRow","adjustRow","setRowHeight","highlightColRow","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","lockCss","lockCell","innerCall","_mapCellsCalls","_locks","locked","isCellLocked","cm","lock","rid","cid","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","getRange","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","spanData","checkSpan","selection","isFirstCell","pasteSpan","cutted","translate","mapCells","isUndo","undoSpan","checkSpanBorders","conditions","lastIndexOf","getStore","exec","getConditionCss","rendered","_empty","collection","get","currentValue","rule","handlers","checkOrder","compare","addEmptyCollection","oldConditions","_pull","clear","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","_normalizeValue","createRules","rId","cId","cond","newData","_setCondition","type_action","_undoCondition","error","alert","showCells","ref","cellRef","rangePos","replaceAll","showCell","dragStartColumn","dragEndColumn","showCommentHandler","pointerType","comments","_activeComment","editStatus","locate","visible","commentsView","viewonly","contains","editMath","highlightHeaders","cop","st","ed","$anyKey","ev","getEditor","finalStep","resizeColumn","cind","dx","posRelative","selectColumnHandler","lastHeaderClick","headerClick","dblClick","lastClickedRow","editStop","getFocus","need_focus","saveFocus","details","ctrl","setDefaultCss","leftSplit","areaselect","minRowHeight","navigation","cell_template","_v","valueOnly","formulasMode","invalidDate","helper","_print","el","nms","cssFormat","getRenderedValue","_printBorders","$render","refreshColumns","isMac","dialog","f2","del","styleHotKey","ctrlU","attr","elementOn","methodsName","nav","updateEditor","fillEditor","startEdit","symbols","clearEditor","isEnabled","_rangeDialog","en","pasteRange","isActiveCell","disableEditor","unselect","getFilter","filterByAll","onHide","fillspace","insertFormula","onKeyPress","updateRange","Dialog","$dialog","$hide","$show","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","onBeforeFileAdd","file","reader","FileReader","onload","getFormView","readAsDataURL","onFileUpload","response","imageURL","onSaveClick","okClick","onCancelClick","fillUrl","addImage","viewid","open","views","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","prevData","undoHandlers","nvalue","ovalue","_trackAll","conf","viewMethods","_types","track","_trackOne","_fromRange","_isPie","_removeLegend","legend","fromData","names","_getNames","switchDirection","dataSeries","legendRange","_getParts","_showAll","win","_correctPos","_showOne","winSize","_getWidth","_getHeight","each","_isRange","_getDataParts","subdata","getRangeRows","getRangeCols","_getSeries","oldLeftColumn","dir","vals","xAxis","activeVals","series","firstRange","inActiveSeries","seria","activeVal","_getColor","colors","dataRange","subRange","_normalizeConfig","valign","scale","rangeToData","rind","editUIType","querySelector","register","container","_commands","getConfig","inner","renderConfig","_processTables","query","tables","dt","oldWin","_activeWin","$destructed","_reset","_undoUI","_updateData","one","viewIds","_genChartConfig","htmlFilter","scaleColor","_prepareType","stacked","pie","pieLegend","legendConfig","yAxis","lineColor","lineShape","circle","borderColor","xValue","chartEditor","handlePieLegend","getLeftColumn","getTopRow","setSilentValue","updateLegendRange","updateXaxisRange","xAxisRange","leftColumn","topRow","exist","updateAlign","updateValign","updateType","isPie","isBar","markersVisible","hideField","hideBatch","switchRowsCols","updateSeries","oldXaxis","field","getSelectedRange","inValues","expand","closeEditor","activeSkin","barHeight","complexData","addRichselect","getTypes","vertical","getLegendAlign","getLegendValign","attributes","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","checkRange","sparkConfig","addSparkline","clearValidation","selectedCell","scope","toSheetRange","unshift","validate","oldData","_getScope","updateItem","_this3","theform","onBeforeSelect","removeRange","editRange","isNotEmpty","onFocus","saveClick","getRanges","selectedId","nameParts","selectList","rangeVal","empty","Ranges","_master","_normalizeName","_normalizeRange","globalRange","out","rangeOptions","getRangePos","getSpans","inSpan","boolean","unique","objA","objB","sorters","sorting","as","int","nullFilter","$empty","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","lastRow","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","getConditions","getFilterFunction","opt","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","flt","importData","relative","inputs","applyFilter","oldValue","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","getFormats","updateForm","closeWin","isText","$css","_getDatalayout","value2","_formatValue","_isNotDateRule","editFormat","_safeInt","_getCondition","activeValue","_rulesToArr","current_view","_this4","onBlur","vid","dlayout","getIdByIndex","_this5","getRows","getConditionStyle","conditionStyle","getSheets","filename","restoreValue","print","htmlOnly","_buildHtml","doc","xCorrection","sheetnames","baseIndex","pageSize","getPageSize","$customPrint","tbl","children","topSplit","childElementCount","splitHeight","insertBefore","sheetNode","class","external","innerView","img","src","promise","defer","resolve","customPrint","printInnerView","br","res","docFooter","_cleanHtml","cloneNode","canvases","getElementsByTagName","drawImage","printSizes","paper","landscape","printMargin","printPPI","showBorders","redraw","rowsHeight","fit","colsWidth","paperSize","modal","stringResult","printPreview","_setComment","textarea","onViewResize","animate","showInput","addComment","comment","showTemplate","changeTextarea","getHead","getOption","optionHeight","bases","imt","imc","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","loadChangedData","process","getUpdateValues","_delColumn","removeColumn","_addColumn","addColumn","_delRow","removeRow","_addRow","addRow","updatedData","fixSelectArea","isRowVisible","isColumnVisible","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","specialPaste","getRow","ignore","$popup","tblEditors","isEditor","setClipboard","buffer","browserClipboard","_get_sel_style","getCopyManager","cellID","writeText","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","getClipboardNumberFormat","record","Number","cut","_add_row_col","maxRow","maxCol","dataRowCount","dataColCount","colCount","selStart","chunk","getMeta","$chunk","sId","eId","clean","paste","ri","ci","subtrans","_clipboardToTable","row_ind","col_ind","cdata","clipboardNumberFormat","clipboardDecimalDelimiter","decimalOptional","minusPosition","clipboard","navigator","clipbuffer","_sel_to_clip","numToStr","stringify","ctrlKey","metaKey","readText","catch","finally","_hidden_cols_hash","_hidden_rows_hash","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","hash","showColumn","getColumnIndex","hideColumn","_updatePosition","hiddenIndex","hrows","hcols","bs","blockStart","blockEnd","removeSelectArea","$handleStart","oldSel","oldStart","oldEnd","clearRange","isRow","nums","firstValue","afterSel","iteration","linkPos","linkRow","linkCol","transposeMath","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","newMath","updateSheetNames","oldName","stack","option","gridlines","firstVisible","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","m8","uploader","XMLHttpRequest","apiOnly","accept","cellDates","sheetStubs","startImport","fileDialog","_safeColor","_getCellStyle","excel","stl","font","alignment","_getExcelCellStyle","_getPdfCellStyle","rgb","fill","fgColor","sz","italic","bold","wrapText","getBorderStyles","textAlign","strikethrough","vertAlign","whiteSpace","_getDocStyle","$exportView","pdf","export_mode","defaultOptions","stubCells","footer","heights","rawValues","filterHTML","_exportView","dataOnly","sheetOptions","_hidden","pdfTable","textBefore","sheetData","scheme","_getStyles","cached","cachedConditions","_getDefaults","docHeader","delta","rIndex","cIndex","_getCellConditions","computed","getComputedStyle","bg","_updateStyleCondition","rgbToHex","_updatePdfData","colspan","rowData","exportData","rowSize","pad","paddingTop","paddingBottom","Sheet","Name","Ref","getAutowidth","prop","orientation","$getExportValue","arrayRowEnd","arrayColEnd","_excel_to_data","dataObj","sheetIndex","book","stylescount","styleshash","_safeFont","va","numFmt","_getBorderStyles","_getTypes","_getHidden","safe","_parseExcel","driver","full","states","_parseCsv","getRecords","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changed","spanSize","changeSpan","removeFreeze","getIndexById","hideRow","chart","getRangeValue","registerMathMethod","recalculate","setPlaceholder","spn","rangeStr","setRangeValue","setSheetState","getSheetState","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","correctVal","cb","muonPage","sameValue","oldType","dateValue","muonItem","updatedType","baseStyle","urlStyle","param","finished","ok","resetUndo","groupUndo","changeDecimals","formulas","zoomView","defaultMenu","readonlyMenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","background","subbar","tblObj","attachTo","lists","sizeToContent","getMenuItem","contextMenu","dialogs","viewBases","rows_setter","operations","m32","m9","m10","m11","m12","m13","m14","m16","m17","m16a","m16b","m16c","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","$onLoad","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","fml","prt","AtomDataLoader"],"mappings":";;;;;;;;uJACAA,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,oCACO,yBACJ,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,0CACA,4BACF,iBACP,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,sBACA,uBACC,kBAEJ,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,sCACO,gCACP,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,uCACD,+BAEN,sBACM,sCACG,iCACH,4BACC,gBACN,oBACG,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,0BACH,8BACG,6BAEP,gBAEF,eACC,uBACM,gCACA,+BAEH,qBACE,sBACD,4BAEE,wBACA,wBACA,uBAED,6BACI,iCACA,gCACE,0BAEP,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,8BACH,wBAEF,uBACC,wBACA,uBACD,4BACM,kCACA,4BACA,0BACF,6CACA,6CACA,yCACA,2CACE,6BACC,6BACD,0BACF,yBACC,0BACA,sEAEJ,4BACI;mBACA,iDACE,oCACA,4BACD,4BACC,8BACC,+BACA,oCACH,4BACG,+BACA,sBAET,uBACG,6BACG,2BACL,6BACO,mBACV,wBACE,uBACG,yBACF,2BAEI,mCACF,uBACH,uBAEG,iCACO,kCACE,mCACD,gCACF,uBAEP,0BAEM,iBAEtBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,mBACD,mBACH,0BACQ,qCACF,oCACC,qCACA,0CACA,yCACE,sCACN,8CACE,qCACF,wBACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,4BACK,oCACD,wBACV,qBACK,cAEfC,MAAM,gBACW,8BACA,4BACF,kBACN,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,4BACZ,cACF,aACC,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,YACH,yBACQ,8BACD,wBACP,wBACO,0BACJ,uBACJ,kBACI,uBACC,oBACL,kBACI,0BACC,mBACL,wBACU,wCACH,wCACG,qCACF,oCACC,qCACA,uCACD,2BACH,yBACJ,wBACQ,wCACH,cACP,WACC,aACC,wBACQ,+BACD,0BACE,0BACF;mBACI,uBAErBC,MAAM,cACQ,2BACI,uBACF,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,uCACD,8BACJ,sBACC,CACb,UACA,SACA,WACA,gBC9VHR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElBC,KAAMR,EAAOQ,QAGdrB,MAAMsB,GAAGC,YChBXvB,MAAMS,QAAQ,CACbC,KAAM,yBACNc,SAAS,CACRC,MAAO,KAERb,MAAO,SAASC,OACTa,EAAO1B,MAAM0B,KAAKC,MACxBd,EAAOG,KAAO,CACbY,OAAQ,EACRC,KAAK,CACJ,CAAEd,KAAM,eAAgBe,QAAQ,EAAOC,QAAQ,EAC9CZ,OAAQ,EACRC,OAAQ,EACRH,QAAS,CACRC,SAAU,SAASc,UACXhC,MAAMC,KAAKC,YAAYE,SAAS,WAAW4B,EAAIC,MAGxDC,GAAG,CACFC,cAAe,WA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"}